{"version":3,"file":"static/js/main.7e5c0f82.js","mappings":"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","sources":["components/LazyComponents.js","components/CaseModal.js","components/TopicModal.js","components/TaskModal.js","utils/floatingEdgeUtils.js","components/FloatingEdge.js","components/EnhancedEdge.js","components/ConnectionLine.js","components/OptimizedLoadingScreen.js","utils/performanceUtils.js","data/sampleLiteratureData.js","utils/sampleDataUtils.js","App.js","index.js","../webpack/bootstrap","../webpack/runtime/chunk loaded","../webpack/runtime/create fake namespace object","../webpack/runtime/define property getters","../webpack/runtime/ensure chunk","../webpack/runtime/get javascript chunk filename","../webpack/runtime/get mini-css chunk filename","../webpack/runtime/global","../webpack/runtime/hasOwnProperty shorthand","../webpack/runtime/load script","../webpack/runtime/make namespace object","../webpack/runtime/node module decorator","../webpack/runtime/publicPath","../webpack/runtime/jsonp chunk loading","../webpack/startup"],"sourcesContent":["// Lazy loading component wrapper for performance optimization\nimport React, { Suspense, lazy } from 'react';\nimport { Loader2 } from 'lucide-react';\n\n// Loading fallback component\nconst LoadingSpinner = ({ message = \"Loading...\" }) => (\n  <div className=\"flex items-center justify-center p-8\">\n    <div className=\"flex flex-col items-center gap-2\">\n      <Loader2 className=\"w-6 h-6 animate-spin text-blue-600\" />\n      <span className=\"text-sm text-gray-600\">{message}</span>\n    </div>\n  </div>\n);\n\n// Lazy load components that aren't needed immediately\nexport const LazyRichTextEditor = lazy(() => import('./RichTextEditor'));\nexport const LazyTemplateManager = lazy(() => import('./TemplateManager'));\nexport const LazyLiteratureModal = lazy(() => import('./LiteratureModal'));\n\n// HOC for wrapping lazy components with suspense\nexport const withLazyLoading = (LazyComponent, fallbackMessage) => (props) => (\n  <Suspense fallback={<LoadingSpinner message={fallbackMessage} />}>\n    <LazyComponent {...props} />\n  </Suspense>\n);\n\n// Pre-wrapped components ready to use\nexport const RichTextEditor = withLazyLoading(LazyRichTextEditor, \"Loading editor...\");\nexport const TemplateManager = withLazyLoading(LazyTemplateManager, \"Loading templates...\");\nexport const LiteratureModal = withLazyLoading(LazyLiteratureModal, \"Loading literature viewer...\");\n","// Enhanced Case Modal with tabbed interface and advanced animations\nimport React, { useState, useEffect, useMemo, useCallback, useRef } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { \n  X, \n  Users, \n  FileText, \n  Clipboard, \n  Heart, \n  Clock, \n  Sparkles, \n  Target,\n  Edit3,\n  Trash2,\n  Save,\n  Loader2,\n  AlertCircle,\n  StickyNote,\n  Eye,\n  BookOpen,\n  ChevronDown,\n  ArrowDown,\n  Calendar,\n  Brain,\n  Plus,\n  Send\n} from 'lucide-react';\n\n// Animation variants for Framer Motion\nconst modalVariants = {\n  hidden: {\n    opacity: 0,\n    scale: 0.3,\n    y: 50,\n    rotate: -5,\n  },\n  visible: {\n    opacity: 1,\n    scale: 1,\n    y: 0,\n    rotate: 0,\n    transition: {\n      type: \"spring\",\n      damping: 25,\n      stiffness: 300,\n      duration: 0.6,\n    }\n  },\n  exit: {\n    opacity: 0,\n    scale: 0.7,\n    y: 30,\n    rotate: -3,\n    transition: {\n      type: \"easeInOut\",\n      duration: 0.4,\n    }\n  }\n};\n\nconst backdropVariants = {\n  hidden: { \n    opacity: 0,\n    backdropFilter: 'blur(0px)'\n  },\n  visible: { \n    opacity: 1,\n    backdropFilter: 'blur(8px)',\n    transition: {\n      duration: 0.4,\n      ease: \"easeOut\"\n    }\n  },\n  exit: { \n    opacity: 0,\n    backdropFilter: 'blur(0px)',\n    transition: {\n      duration: 0.3,\n      ease: \"easeIn\"\n    }\n  }\n};\n\nconst contentVariants = {\n  hidden: {\n    opacity: 0,\n    y: 20,\n    scale: 0.95,\n  },\n  visible: {\n    opacity: 1,\n    y: 0,\n    scale: 1,\n    transition: {\n      type: \"easeOut\",\n      duration: 0.3,\n      delay: 0.1,\n    }\n  },\n  exit: {\n    opacity: 0,\n    y: -10,\n    scale: 1.02,\n    transition: {\n      type: \"easeIn\",\n      duration: 0.2,\n    }\n  }\n};\n\nconst CaseModal = ({ \n  isOpen, \n  data, \n  onClose,\n  onAnimationStart,\n  onAnimationEnd,\n  setMindMapData,\n  autoSaveMindMapData,\n  addToast\n}) => {\n  const [isAnimating, setIsAnimating] = useState(false);\n  const [isVisible, setIsVisible] = useState(false);\n  const [isClosing, setIsClosing] = useState(false);\n  const [isEditing, setIsEditing] = useState(false);\n  const [editData, setEditData] = useState({});\n  const [isLoading, setIsLoading] = useState(false);\n  const [hasInitialized, setHasInitialized] = useState(false);\n  const [activeTab, setActiveTab] = useState('overview');\n  const [isTabTransitioning, setIsTabTransitioning] = useState(false);\n  const [expandedTimelineEntry, setExpandedTimelineEntry] = useState(null);\n  const [editingEntryId, setEditingEntryId] = useState(null);\n  const [editingEntryData, setEditingEntryData] = useState({});\n  const [isCreatingEntry, setIsCreatingEntry] = useState(false);\n  const timelineScrollRef = useRef(null);\n\n  useEffect(() => {\n    if (isOpen && data && !hasInitialized) {\n      setIsVisible(true);\n      setEditData({ ...data });\n      setHasInitialized(true);\n      setIsAnimating(true);\n      if (onAnimationStart) onAnimationStart();\n      \n      setTimeout(() => {\n        setIsAnimating(false);\n        if (onAnimationEnd) onAnimationEnd();\n      }, 600);\n    } else if (!isOpen && hasInitialized) {\n      setHasInitialized(false);\n    }\n  }, [isOpen, hasInitialized, onAnimationStart, onAnimationEnd]);\n\n  // Separate effect for data updates when modal is already open\n  useEffect(() => {\n    if (isOpen && data && hasInitialized && !isEditing && !isLoading && !isTabTransitioning && !isAnimating) {\n      setEditData({ ...data });\n    }\n  }, [data?.id, isOpen, hasInitialized, isEditing, isLoading, isTabTransitioning, isAnimating]);\n\n  // Timeline data from case or default mock data\n  const timelineEntries = useMemo(() => {\n    // If case has timeline data, use it, otherwise use mock data for demonstration\n    if (editData?.timeline && Array.isArray(editData.timeline) && editData.timeline.length > 0) {\n      return editData.timeline.sort((a, b) => new Date(a.timestamp) - new Date(b.timestamp));\n    }\n    \n    // Default mock data for cases without timeline\n    return [\n      {\n        id: 1,\n        timestamp: '2024-01-15T09:30:00.000Z',\n        date: '2024-01-15',\n        time: '09:30 AM',\n        type: 'assessment',\n        title: 'Initial Assessment',\n        content: 'Patient presented with symptoms of anxiety and depression.',\n        details: 'Comprehensive psychiatric evaluation completed. Patient reports increased anxiety over the past 3 months, difficulty sleeping, and decreased appetite. MSE reveals anxious mood, intact cognition, no psychotic features. PHQ-9 score: 14 (moderate depression). GAD-7 score: 12 (moderate anxiety).',\n        author: 'Dr. Smith',\n        isNew: false\n      },\n      {\n        id: 2,\n        timestamp: '2024-01-22T14:15:00.000Z',\n        date: '2024-01-22',\n        time: '02:15 PM',\n        type: 'medication',\n        title: 'Medication Adjustment',\n        content: 'Started on Sertraline 50mg daily.',\n        details: 'After discussion of treatment options, patient agreed to trial of SSRI. Started Sertraline 50mg daily. Reviewed potential side effects including initial activation, GI upset. Plan to follow up in 2 weeks. Provided crisis resources and encouraged to call if any concerns.',\n        author: 'Dr. Smith',\n        isNew: false\n      },\n      {\n        id: 3,\n        timestamp: '2024-02-05T11:00:00.000Z',\n        date: '2024-02-05',\n        time: '11:00 AM',\n        type: 'followup',\n        title: 'Follow-up Visit',\n        content: 'Patient reports mild improvement in mood.',\n        details: 'Patient tolerated medication well with minimal side effects. Reports improved energy and slightly better sleep. Still experiencing some anxiety symptoms. PHQ-9 score decreased to 10. Continue current medication, discussed therapy referral.',\n        author: 'Dr. Smith',\n        isNew: false\n      },\n      {\n        id: 4,\n        timestamp: '2024-02-19T15:45:00.000Z',\n        date: '2024-02-19',\n        time: '03:45 PM',\n        type: 'therapy',\n        title: 'Therapy Session',\n        content: 'First CBT session completed.',\n        details: 'Initial therapy session with focus on psychoeducation about anxiety and depression. Introduced basic CBT concepts and breathing exercises. Patient engaged well and expressed motivation for therapy. Homework assigned: daily mood tracking and breathing practice.',\n        author: 'Sarah Johnson, LCSW',\n        isNew: true\n      }\n    ];\n  }, [editData?.timeline]);\n\n  const scrollToLatest = useCallback(() => {\n    if (timelineScrollRef.current) {\n      timelineScrollRef.current.scrollTop = timelineScrollRef.current.scrollHeight;\n    }\n  }, []);\n\n  // Enhanced scroll function for new entries in editing mode\n  const scrollToShowEditingEntry = useCallback(() => {\n    if (timelineScrollRef.current && editingEntryId) {\n      // Wait for DOM to update and form to fully expand\n      setTimeout(() => {\n        const container = timelineScrollRef.current;\n        const containerHeight = container.clientHeight;\n        const scrollHeight = container.scrollHeight;\n        \n        // Estimate the height of an expanded editing form (approximately 300-350px)\n        const estimatedFormHeight = 350;\n        \n        // Calculate how much space we need from the bottom\n        const requiredBottomSpace = estimatedFormHeight + 50; // Extra 50px padding\n        \n        // Calculate target scroll to ensure full form visibility\n        const targetScroll = scrollHeight - containerHeight + requiredBottomSpace;\n        \n        container.scrollTo({\n          top: Math.max(0, targetScroll),\n          behavior: 'smooth'\n        });\n      }, 100); // Reduced delay for immediate scroll\n      \n      // Additional scroll check after form fully expands\n      setTimeout(() => {\n        const container = timelineScrollRef.current;\n        if (container) {\n          const containerRect = container.getBoundingClientRect();\n          const editingElement = container.querySelector(`[data-entry-id=\"${editingEntryId}\"]`);\n          \n          if (editingElement) {\n            const elementRect = editingElement.getBoundingClientRect();\n            const elementBottom = elementRect.bottom;\n            const containerBottom = containerRect.bottom;\n            \n            // If element extends beyond container, scroll more\n            if (elementBottom > containerBottom - 20) { // 20px safety margin\n              const additionalScroll = elementBottom - containerBottom + 80; // Extra space\n              container.scrollTo({\n                top: container.scrollTop + additionalScroll,\n                behavior: 'smooth'\n              });\n            }\n          }\n        }\n      }, 400); // After animation completes\n    }\n  }, [editingEntryId]);\n\n  const toggleTimelineEntry = useCallback((entryId) => {\n    setExpandedTimelineEntry(prev => prev === entryId ? null : entryId);\n  }, []);\n\n  // Auto-save timeline changes with debounce\n  const saveTimelineChange = useCallback((newTimeline) => {\n    const timeoutId = setTimeout(() => {\n      setMindMapData(prevData => {\n        const updatedCases = prevData.cases.map(caseItem =>\n          String(caseItem.id) === String(data?.id) \n            ? { ...caseItem, timeline: newTimeline, updated_at: new Date().toISOString() }\n            : caseItem\n        );\n        const newData = { ...prevData, cases: updatedCases };\n        autoSaveMindMapData(newData);\n        return newData;\n      });\n      \n      // Update local edit data as well\n      setEditData(prev => ({ ...prev, timeline: newTimeline }));\n    }, 800); // 800ms debounce\n\n    return timeoutId;\n  }, [data?.id, setMindMapData, autoSaveMindMapData]);\n\n  const getEntryTitle = useCallback((type) => {\n    const titles = {\n      assessment: 'Clinical Assessment',\n      medication: 'Medication Update',\n      therapy: 'Therapy Session',\n      followup: 'Follow-up Visit',\n      note: 'Clinical Note'\n    };\n    return titles[type] || 'Clinical Entry';\n  }, []);\n\n  // Create a new blank timeline entry for inline editing\n  const createNewTimelineEntry = useCallback(() => {\n    if (isCreatingEntry || editingEntryId) return; // Prevent multiple new entries\n    \n    const newEntry = {\n      id: `new-${Date.now()}`, // Temporary ID for new entries\n      timestamp: new Date().toISOString(),\n      date: new Date().toISOString().split('T')[0],\n      time: new Date().toLocaleTimeString('en-US', { \n        hour: '2-digit', \n        minute: '2-digit', \n        hour12: true \n      }),\n      type: 'followup',\n      title: 'Follow-up Visit',\n      content: '',\n      details: '',\n      author: 'Current User',\n      isNew: true,\n      isEditing: true\n    };\n\n    // Add to timeline and set as editing\n    const currentTimeline = editData?.timeline || [];\n    const updatedTimeline = [...currentTimeline, newEntry];\n    \n    setEditData(prev => ({ ...prev, timeline: updatedTimeline }));\n    setEditingEntryId(newEntry.id);\n    setEditingEntryData({ ...newEntry });\n    setIsCreatingEntry(true);\n    \n    // Scroll to show the full editing form after it expands\n    scrollToShowEditingEntry();\n  }, [editData?.timeline, isCreatingEntry, editingEntryId, scrollToShowEditingEntry]);\n\n  // Start editing an existing entry\n  const startEditingEntry = useCallback((entry) => {\n    if (editingEntryId === entry.id) return; // Already editing this entry\n    \n    setEditingEntryId(entry.id);\n    setEditingEntryData({ ...entry });\n    setExpandedTimelineEntry(entry.id);\n    \n    // For existing entries, ensure the full editing form is visible\n    setTimeout(() => {\n      if (timelineScrollRef.current) {\n        const container = timelineScrollRef.current;\n        const entryElement = container.querySelector(`[data-entry-id=\"${entry.id}\"]`);\n        \n        if (entryElement) {\n          const containerRect = container.getBoundingClientRect();\n          const entryRect = entryElement.getBoundingClientRect();\n          \n          // Calculate if the expanded form would be cut off\n          const estimatedExpandedHeight = 300; // Approximate height of editing form\n          const entryTop = entryRect.top - containerRect.top;\n          const entryCurrentHeight = entryRect.height;\n          const entryBottomAfterExpansion = entryTop + entryCurrentHeight + estimatedExpandedHeight;\n          \n          // If the expanded form would extend beyond the container, scroll it into view\n          if (entryBottomAfterExpansion > container.clientHeight - 20) { // 20px safety margin\n            const scrollAmount = entryBottomAfterExpansion - container.clientHeight + 80; // Extra 80px padding\n            container.scrollTo({\n              top: container.scrollTop + scrollAmount,\n              behavior: 'smooth'\n            });\n          }\n        }\n      }\n    }, 100); // Initial scroll calculation\n    \n    // Double-check after form fully expands\n    setTimeout(() => {\n      if (timelineScrollRef.current) {\n        const container = timelineScrollRef.current;\n        const entryElement = container.querySelector(`[data-entry-id=\"${entry.id}\"]`);\n        \n        if (entryElement) {\n          const containerRect = container.getBoundingClientRect();\n          const entryRect = entryElement.getBoundingClientRect();\n          const entryBottom = entryRect.bottom;\n          const containerBottom = containerRect.bottom;\n          \n          // Final check - if still cut off, scroll more\n          if (entryBottom > containerBottom - 20) {\n            const additionalScroll = entryBottom - containerBottom + 60; // Additional padding\n            container.scrollTo({\n              top: container.scrollTop + additionalScroll,\n              behavior: 'smooth'\n            });\n          }\n        }\n      }\n    }, 400); // After animation completes\n  }, [editingEntryId]);\n\n  // Save the currently editing entry\n  const saveEditingEntry = useCallback(() => {\n    if (!editingEntryId || !editingEntryData) return;\n    \n    const currentTimeline = editData?.timeline || [];\n    let updatedTimeline;\n    \n    // Generate final ID for new entries\n    const finalEntry = {\n      ...editingEntryData,\n      id: editingEntryData.id.toString().startsWith('new-') \n        ? Date.now() \n        : editingEntryData.id,\n      isNew: editingEntryData.id.toString().startsWith('new-'),\n      isEditing: false,\n      updated_at: new Date().toISOString()\n    };\n    \n    // Update title based on type\n    finalEntry.title = getEntryTitle(finalEntry.type);\n    \n    // Update timestamp-derived fields\n    const dateObj = new Date(finalEntry.timestamp);\n    finalEntry.date = dateObj.toISOString().split('T')[0];\n    finalEntry.time = dateObj.toLocaleTimeString('en-US', { \n      hour: '2-digit', \n      minute: '2-digit', \n      hour12: true \n    });\n    \n    if (editingEntryData.id.toString().startsWith('new-')) {\n      // Adding new entry\n      updatedTimeline = [...currentTimeline.filter(e => e.id !== editingEntryId), finalEntry]\n        .sort((a, b) => new Date(a.timestamp) - new Date(b.timestamp));\n    } else {\n      // Updating existing entry\n      updatedTimeline = currentTimeline.map(entry =>\n        entry.id === editingEntryId ? finalEntry : entry\n      ).sort((a, b) => new Date(a.timestamp) - new Date(b.timestamp));\n    }\n    \n    // Save changes\n    saveTimelineChange(updatedTimeline);\n    \n    // Clear editing state\n    setEditingEntryId(null);\n    setEditingEntryData({});\n    setIsCreatingEntry(false);\n    \n    addToast(\n      editingEntryData.id.toString().startsWith('new-') \n        ? 'Timeline entry added successfully' \n        : 'Timeline entry updated successfully', \n      'success'\n    );\n    \n    // Only scroll to latest for new entries\n    if (editingEntryData.id.toString().startsWith('new-')) {\n      setTimeout(() => scrollToLatest(), 300);\n    }\n  }, [\n    editingEntryId, \n    editingEntryData, \n    editData?.timeline, \n    saveTimelineChange, \n    addToast, \n    scrollToLatest,\n    getEntryTitle\n  ]);\n\n  // Cancel editing\n  const cancelEditingEntry = useCallback(() => {\n    if (!editingEntryId) return;\n    \n    // If it's a new entry, remove it from timeline\n    if (editingEntryData.id && editingEntryData.id.toString().startsWith('new-')) {\n      const currentTimeline = editData?.timeline || [];\n      const updatedTimeline = currentTimeline.filter(e => e.id !== editingEntryId);\n      setEditData(prev => ({ ...prev, timeline: updatedTimeline }));\n    }\n    \n    // Clear editing state\n    setEditingEntryId(null);\n    setEditingEntryData({});\n    setIsCreatingEntry(false);\n    setExpandedTimelineEntry(null);\n  }, [editingEntryId, editingEntryData, editData?.timeline]);\n\n  // Handle keyboard shortcuts for editing\n  const handleEditingKeyPress = useCallback((e) => {\n    if (e.key === 'Enter' && e.shiftKey) {\n      e.preventDefault();\n      saveEditingEntry();\n    } else if (e.key === 'Escape') {\n      e.preventDefault();\n      cancelEditingEntry();\n    }\n  }, [saveEditingEntry, cancelEditingEntry]);\n\n  // Update editing entry data\n  const updateEditingEntry = useCallback((field, value) => {\n    setEditingEntryData(prev => ({\n      ...prev,\n      [field]: value,\n      // Auto-update details to match content for consistency\n      ...(field === 'content' && { details: value })\n    }));\n  }, []);\n\n  // Clear isNew flag after a delay for entries that were just added\n  useEffect(() => {\n    const newEntries = timelineEntries.filter(entry => entry.isNew && !entry.isEditing);\n    if (newEntries.length > 0) {\n      const timeout = setTimeout(() => {\n        const updatedTimeline = timelineEntries.map(entry => \n          entry.isNew && !entry.isEditing ? { ...entry, isNew: false } : entry\n        );\n        if (editData?.timeline) {\n          saveTimelineChange(updatedTimeline);\n        }\n      }, 5000); // Remove isNew flag after 5 seconds\n\n      return () => clearTimeout(timeout);\n    }\n  }, [timelineEntries, editData?.timeline, saveTimelineChange]);\n\n  const handleClose = useCallback(() => {\n    if (isAnimating || isClosing) return;\n    \n    setIsAnimating(true);\n    setIsClosing(true);\n    if (onAnimationStart) onAnimationStart();\n    \n    // Set visibility to false to trigger exit animation\n    setIsVisible(false);\n  }, [onAnimationStart, isAnimating, isClosing]);\n\n  const handleSave = useCallback(async () => {\n    if (isLoading) return;\n    \n    setIsLoading(true);\n    try {\n      setMindMapData(prevData => {\n        const updatedCases = prevData.cases.map(caseItem =>\n          String(caseItem.id) === String(data?.id) ? { ...caseItem, ...editData } : caseItem\n        );\n        const newData = { ...prevData, cases: updatedCases };\n        autoSaveMindMapData(newData);\n        return newData;\n      });\n      \n      setIsEditing(false);\n      addToast('Case updated successfully', 'success');\n    } catch (error) {\n      console.error('Error saving case:', error);\n      addToast('Failed to save case', 'error');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [data?.id, editData, setMindMapData, autoSaveMindMapData, addToast, isLoading]);\n\n  const handleDelete = useCallback(async () => {\n    if (isLoading) return;\n    \n    if (!window.confirm('Are you sure you want to delete this case?')) return;\n    \n    setIsLoading(true);\n    try {\n      setMindMapData(prevData => {\n        const updatedCases = prevData.cases.filter(caseItem => String(caseItem.id) !== String(data?.id));\n        const newData = { ...prevData, cases: updatedCases };\n        autoSaveMindMapData(newData);\n        return newData;\n      });\n      \n      addToast('Case deleted successfully', 'success');\n      handleClose();\n    } catch (error) {\n      console.error('Error deleting case:', error);\n      addToast('Failed to delete case', 'error');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [data?.id, setMindMapData, autoSaveMindMapData, addToast, handleClose, isLoading]);\n\n  const updateField = useCallback((field, value) => {\n    setEditData(prev => ({ ...prev, [field]: value }));\n  }, []);\n\n  const renderField = (label, field, type = 'text', options = {}) => {\n    const value = editData[field] || '';\n    \n    if (!isEditing) {\n      if (type === 'textarea') {\n        return (\n          <div className=\"space-y-2\">\n            <label className=\"block text-sm font-medium text-gray-700\">{label}</label>\n            <div className=\"p-3 bg-gray-50 rounded-lg border min-h-[2.5rem] text-gray-800\">\n              {value || <span className=\"text-gray-400 italic\">Not specified</span>}\n            </div>\n          </div>\n        );\n      }\n      \n      if (type === 'select') {\n        return (\n          <div className=\"space-y-2\">\n            <label className=\"block text-sm font-medium text-gray-700\">{label}</label>\n            <div className=\"p-3 bg-gray-50 rounded-lg border text-gray-800\">\n              {value || <span className=\"text-gray-400 italic\">Not specified</span>}\n            </div>\n          </div>\n        );\n      }\n      \n      return (\n        <div className=\"space-y-2\">\n          <label className=\"block text-sm font-medium text-gray-700\">{label}</label>\n          <div className=\"p-3 bg-gray-50 rounded-lg border text-gray-800\">\n            {value || <span className=\"text-gray-400 italic\">Not specified</span>}\n          </div>\n        </div>\n      );\n    }\n\n    // Editing mode\n    if (type === 'textarea') {\n      return (\n        <div className=\"space-y-2\">\n          <label className=\"block text-sm font-medium text-gray-700\">{label}</label>\n          <textarea\n            value={value}\n            onChange={(e) => updateField(field, e.target.value)}\n            className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors\"\n            rows={options.rows || 3}\n            placeholder={`Enter ${label.toLowerCase()}...`}\n          />\n        </div>\n      );\n    }\n\n    if (type === 'select' && options.choices) {\n      return (\n        <div className=\"space-y-2\">\n          <label className=\"block text-sm font-medium text-gray-700\">{label}</label>\n          <select\n            value={value}\n            onChange={(e) => updateField(field, e.target.value)}\n            className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors\"\n          >\n            <option value=\"\">Select {label.toLowerCase()}...</option>\n            {options.choices.map(choice => (\n              <option key={choice} value={choice}>{choice}</option>\n            ))}\n          </select>\n        </div>\n      );\n    }\n\n    return (\n      <div className=\"space-y-2\">\n        <label className=\"block text-sm font-medium text-gray-700\">{label}</label>\n        <input\n          type={type}\n          value={value}\n          onChange={(e) => updateField(field, type === 'number' ? Number(e.target.value) : e.target.value)}\n          className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors\"\n          placeholder={`Enter ${label.toLowerCase()}...`}\n        />\n      </div>\n    );\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <AnimatePresence mode=\"wait\" onExitComplete={() => {\n      setIsAnimating(false);\n      setIsClosing(false);\n      setHasInitialized(false);\n      onClose();\n      if (onAnimationEnd) onAnimationEnd();\n    }}>\n      {isVisible && (\n        <motion.div\n          key={`case-modal-${data?.id || 'default'}`}\n          initial=\"hidden\"\n          animate=\"visible\"\n          exit=\"exit\"\n          variants={backdropVariants}\n          className=\"fixed inset-0 bg-black flex items-center justify-center z-50\"\n          style={{ \n            willChange: 'backdrop-filter, opacity',\n            backfaceVisibility: 'hidden',\n            transform: 'translate3d(0, 0, 0)'\n          }}\n          onClick={(e) => e.target === e.currentTarget && handleClose()}\n        >\n          <motion.div\n            initial=\"hidden\"\n            animate=\"visible\"\n            exit=\"exit\"\n            variants={modalVariants}\n            className=\"bg-white rounded-2xl shadow-2xl max-w-4xl w-full mx-4 max-h-[85vh] overflow-hidden\"\n            style={{ \n              willChange: 'transform, opacity, scale',\n              backfaceVisibility: 'hidden'\n            }}\n            onClick={(e) => e.stopPropagation()}\n            onAnimationStart={() => {\n              setIsAnimating(true);\n              if (onAnimationStart) onAnimationStart();\n            }}\n            onAnimationComplete={() => {\n              setIsAnimating(false);\n              if (onAnimationEnd) onAnimationEnd();\n            }}\n          >\n            <motion.div \n              initial=\"hidden\"\n              animate=\"visible\"\n              exit=\"exit\"\n              variants={contentVariants}\n              className=\"bg-gradient-to-r from-indigo-600 to-blue-600 text-white px-6 py-4 flex items-center justify-between\"\n            >\n              <div className=\"flex items-center gap-3\">\n                <Users size={24} />\n                <h2 className=\"text-xl font-semibold\">Case Details</h2>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                {!isEditing && !isLoading && (\n                  <>\n                    <button\n                      onClick={() => setIsEditing(true)}\n                      className=\"text-white hover:text-gray-200 p-2 rounded-full hover:bg-white hover:bg-opacity-20 transition-all\"\n                      title=\"Edit\"\n                    >\n                      <Edit3 size={20} />\n                    </button>\n                    <button\n                      onClick={handleDelete}\n                      className=\"text-white hover:text-red-200 p-2 rounded-full hover:bg-red-500 hover:bg-opacity-30 transition-all\"\n                      title=\"Delete\"\n                    >\n                      <Trash2 size={20} />\n                    </button>\n                  </>\n                )}\n                <button onClick={handleClose} className=\"text-white hover:text-gray-200 p-2 rounded-full hover:bg-white hover:bg-opacity-20 transition-all\">\n                  <X size={20} />\n                </button>\n              </div>\n            </motion.div>\n\n            {/* Tab Navigation */}\n            <div className=\"bg-gradient-to-r from-slate-900 via-slate-800 to-slate-900 border-b border-slate-600\">\n              <nav className=\"flex flex-wrap gap-2 px-6 py-4\">\n                {[\n                  { key: 'overview', label: 'Overview', icon: Users },\n                  { key: 'narrative', label: 'Narrative', icon: FileText },\n                  { key: 'medications', label: 'Medications', icon: Clipboard },\n                  { key: 'therapy', label: 'Therapy', icon: Heart },\n                  { key: 'timeline', label: 'Timeline', icon: Clock },\n                  { key: 'insights', label: 'Insights', icon: Sparkles },\n                  { key: 'related', label: 'Related', icon: Target }\n                ].map(({ key, label, icon: Icon }) => (\n                  <motion.button\n                    key={key}\n                    onClick={() => {\n                      if (isTabTransitioning) return;\n                      setIsTabTransitioning(true);\n                      setActiveTab(key);\n                      setTimeout(() => setIsTabTransitioning(false), 300);\n                    }}\n                    className={`relative flex items-center gap-2 px-4 py-3 rounded-xl font-medium text-sm transition-all duration-300 ${\n                      activeTab === key\n                        ? 'bg-gradient-to-r from-blue-500 to-indigo-600 text-white shadow-lg shadow-blue-500/25'\n                        : 'text-slate-300 hover:text-white hover:bg-slate-700/50 hover:shadow-md'\n                    }`}\n                    whileHover={{ scale: activeTab === key ? 1 : 1.02 }}\n                    whileTap={{ scale: 0.98 }}\n                    initial={false}\n                    animate={{\n                      scale: activeTab === key ? 1.05 : 1,\n                      boxShadow: activeTab === key \n                        ? '0 8px 25px rgba(59, 130, 246, 0.3), 0 0 20px rgba(99, 102, 241, 0.2)' \n                        : '0 2px 8px rgba(0, 0, 0, 0.1)'\n                    }}\n                    transition={{ duration: 0.3, ease: \"easeOut\" }}\n                  >\n                    <Icon size={16} className={activeTab === key ? 'drop-shadow-sm' : ''} />\n                    {label}\n                    {/* Timeline notification badge */}\n                    {key === 'timeline' && timelineEntries.some(entry => entry.isNew) && (\n                      <span className=\"absolute -top-1 -right-1 inline-flex items-center justify-center w-4 h-4 text-xs font-bold text-white bg-red-500 rounded-full animate-pulse\">\n                        !\n                      </span>\n                    )}\n                    \n                    {activeTab === key && (\n                      <motion.div\n                        layoutId=\"tabGlow\"\n                        className=\"absolute inset-0 bg-gradient-to-r from-blue-400/20 to-indigo-500/20 rounded-xl blur-sm\"\n                        initial={false}\n                        transition={{ type: \"spring\", bounce: 0.2, duration: 0.6 }}\n                      />\n                    )}\n                  </motion.button>\n                ))}\n              </nav>\n            </div>\n            \n            {/* Tab Content */}\n            <motion.div \n              className=\"relative overflow-hidden bg-gradient-to-br from-slate-50 to-slate-100\"\n              layout=\"position\"\n              layoutRoot\n              transition={{ \n                layout: { duration: 0.4, ease: \"easeInOut\" },\n                height: { duration: 0.4, ease: \"easeInOut\" }\n              }}\n            >\n              <AnimatePresence mode=\"wait\" initial={false} onExitComplete={() => setIsTabTransitioning(false)}>\n                {/* Overview Tab */}\n                {activeTab === 'overview' && (\n                  <motion.div\n                    key=\"overview\"\n                    initial={{ opacity: 0, x: -30 }}\n                    animate={{ opacity: 1, x: 0 }}\n                    exit={{ opacity: 0, x: 30 }}\n                    transition={{ duration: 0.4, ease: \"easeOut\" }}\n                    layout=\"position\"\n                    layoutId=\"tabContent\"\n                    className=\"p-6 overflow-y-auto max-h-[calc(85vh-200px)] scrollbar-thin scrollbar-thumb-slate-400 scrollbar-track-slate-200\"\n                  >\n                    <div className=\"space-y-6\">\n                      <div className=\"bg-white rounded-xl p-6 shadow-lg border border-slate-200\">\n                        <h3 className=\"text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2\">\n                          <Users size={20} className=\"text-blue-600\" />\n                          Demographics & Basic Info\n                        </h3>\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                          {renderField('Case ID', 'case_id')}\n                          {renderField('Primary Diagnosis', 'primary_diagnosis')}\n                          {renderField('Age', 'age', 'number')}\n                          {renderField('Gender', 'gender', 'select', {\n                            choices: ['Male', 'Female', 'Non-binary', 'Other']\n                          })}\n                        </div>\n                      </div>\n                      \n                      <div className=\"bg-white rounded-xl p-6 shadow-lg border border-slate-200\">\n                        <h3 className=\"text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2\">\n                          <AlertCircle size={20} className=\"text-amber-600\" />\n                          Initial Impressions\n                        </h3>\n                        <div className=\"space-y-4\">\n                          {renderField('Chief Complaint', 'chiefComplaint', 'textarea', { rows: 3 })}\n                          {renderField('Initial Presentation', 'initialPresentation', 'textarea', { rows: 4 })}\n                        </div>\n                      </div>\n                    </div>\n                  </motion.div>\n                )}\n\n                {/* Narrative Tab */}\n                {activeTab === 'narrative' && (\n                  <motion.div\n                    key=\"narrative\"\n                    initial={{ opacity: 0, x: -30 }}\n                    animate={{ opacity: 1, x: 0 }}\n                    exit={{ opacity: 0, x: 30 }}\n                    transition={{ duration: 0.4, ease: \"easeOut\" }}\n                    layout=\"position\"\n                    layoutId=\"tabContent\"\n                    className=\"p-6 overflow-y-auto max-h-[calc(85vh-200px)] scrollbar-thin scrollbar-thumb-slate-400 scrollbar-track-slate-200\"\n                  >\n                    <div className=\"bg-white rounded-xl p-6 shadow-lg border border-slate-200\">\n                      <h3 className=\"text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2\">\n                        <FileText size={20} className=\"text-green-600\" />\n                        Patient Story & Narrative\n                      </h3>\n                      <div className=\"space-y-6\">\n                        {renderField('Current Presentation', 'currentPresentation', 'textarea', { rows: 8 })}\n                        <div className=\"text-sm text-slate-600 bg-slate-50 p-4 rounded-lg\">\n                          <p className=\"italic\">Use this space to tell the patient's story in your own words. Include context, progression, and your narrative understanding of their journey.</p>\n                        </div>\n                      </div>\n                    </div>\n                  </motion.div>\n                )}\n\n                {/* Other tabs would continue here following the same pattern... */}\n                {/* For brevity, I'll include key tabs. The full implementation would include all tabs */}\n                \n                {/* Timeline Tab */}\n                {activeTab === 'timeline' && (\n                  <motion.div\n                    key=\"timeline\"\n                    initial={{ opacity: 0, x: -30 }}\n                    animate={{ opacity: 1, x: 0 }}\n                    exit={{ opacity: 0, x: 30 }}\n                    transition={{ duration: 0.4, ease: \"easeOut\" }}\n                    layout=\"position\"\n                    layoutId=\"tabContent\"\n                    className=\"p-6 h-[calc(85vh-200px)] flex flex-col\"\n                  >\n                    <div className=\"flex justify-between items-center mb-4\">\n                      <h3 className=\"text-lg font-semibold text-gray-800\">Case Timeline</h3>\n                      <div className=\"flex items-center gap-2\">\n                        <motion.button\n                          whileHover={{ scale: 1.05 }}\n                          whileTap={{ scale: 0.95 }}\n                          onClick={createNewTimelineEntry}\n                          disabled={isCreatingEntry || editingEntryId}\n                          className=\"flex items-center gap-2 px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors text-sm\"\n                        >\n                          <Plus size={16} />\n                          Add Entry\n                        </motion.button>\n                        <motion.button\n                          whileHover={{ scale: 1.05 }}\n                          whileTap={{ scale: 0.95 }}\n                          onClick={scrollToLatest}\n                          className=\"flex items-center gap-2 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm\"\n                        >\n                          <ArrowDown size={16} />\n                          Scroll to Latest\n                        </motion.button>\n                      </div>\n                    </div>\n                    \n                    {/* Timeline implementation with inline editing */}\n                    <div className=\"relative flex-1\">\n                      <div className=\"absolute top-0 left-0 right-0 h-4 bg-gradient-to-b from-white to-transparent z-10 pointer-events-none\" />\n                      \n                      <div\n                        ref={timelineScrollRef}\n                        className=\"h-full overflow-y-auto bg-gradient-to-br from-slate-900 to-slate-800 rounded-xl p-4 space-y-3 scrollbar-thin scrollbar-thumb-slate-600 scrollbar-track-slate-800\"\n                        style={{\n                          scrollbarWidth: 'thin',\n                          scrollbarColor: '#475569 #1e293b'\n                        }}\n                      >\n                        {/* Vertical timeline bar */}\n                        <div className=\"absolute left-7 top-4 bottom-4 w-0.5 bg-gradient-to-b from-blue-400 via-purple-500 to-blue-400 opacity-30\" />\n                        \n                        <AnimatePresence mode=\"popLayout\">\n                          {timelineEntries.map((entry, index) => {\n                            const isEditing = editingEntryId === entry.id;\n                            const isExpanded = expandedTimelineEntry === entry.id || isEditing;\n                            \n                            return (\n                              <motion.div\n                                key={entry.id}\n                                initial={{ opacity: 0, y: 20, scale: 0.95 }}\n                                animate={{ \n                                  opacity: 1, \n                                  y: 0, \n                                  scale: 1,\n                                  transition: { \n                                    delay: entry.isNew && !entry.isEditing ? 0 : index * 0.05, \n                                    duration: 0.4,\n                                    type: \"spring\",\n                                    stiffness: 500,\n                                    damping: 30\n                                  }\n                                }}\n                                exit={{ opacity: 0, y: -20, scale: 0.95 }}\n                                layout\n                                className={`relative z-10 ${entry.isNew && !isEditing ? 'animate-pulse' : ''}`}\n                              >\n                                {/* Timeline dot */}\n                                <div className={`absolute left-6 top-4 w-3 h-3 rounded-full border-2 border-slate-900 z-20 ${\n                                  entry.type === 'assessment' ? 'bg-green-500' :\n                                  entry.type === 'medication' ? 'bg-blue-500' :\n                                  entry.type === 'therapy' ? 'bg-purple-500' :\n                                  entry.type === 'note' ? 'bg-yellow-500' :\n                                  'bg-orange-500'\n                                }`} />\n                                \n                                <motion.div\n                                  layout\n                                  data-entry-id={entry.id}\n                                  whileHover={!isEditing ? { \n                                    scale: 1.01,\n                                    boxShadow: '0 8px 20px rgba(59, 130, 246, 0.12)'\n                                  } : {}}\n                                  className={`ml-12 bg-gradient-to-r from-slate-800 to-slate-700 rounded-lg border-l-3 transition-all duration-300 ${\n                                    entry.type === 'assessment' ? 'border-green-400' :\n                                    entry.type === 'medication' ? 'border-blue-400' :\n                                    entry.type === 'therapy' ? 'border-purple-400' :\n                                    entry.type === 'note' ? 'border-yellow-400' :\n                                    'border-orange-400'\n                                  } ${entry.isNew && !isEditing ? 'ring-1 ring-blue-400 ring-opacity-50' : ''} ${\n                                    isEditing ? 'ring-2 ring-green-400 ring-opacity-70' : ''\n                                  }`}\n                                >\n                                  {/* Entry Header - Always Visible */}\n                                  <div \n                                    className={`p-4 ${!isEditing ? 'cursor-pointer' : ''}`}\n                                    onClick={!isEditing ? () => {\n                                      if (expandedTimelineEntry === entry.id) {\n                                        setExpandedTimelineEntry(null);\n                                      } else {\n                                        startEditingEntry(entry);\n                                      }\n                                    } : undefined}\n                                  >\n                                    <div className=\"flex items-start justify-between\">\n                                      <div className=\"flex-1\">\n                                        <div className=\"flex items-center gap-2 mb-1\">\n                                          <h4 className=\"text-white font-semibold text-sm\">\n                                            {isEditing ? editingEntryData.title : entry.title}\n                                          </h4>\n                                          {entry.isNew && !isEditing && (\n                                            <motion.span\n                                              animate={{ \n                                                scale: [1, 1.1, 1],\n                                                opacity: [0.7, 1, 0.7]\n                                              }}\n                                              transition={{ \n                                                duration: 2, \n                                                repeat: Infinity,\n                                                ease: \"easeInOut\"\n                                              }}\n                                              className=\"inline-flex items-center px-2 py-1 text-xs font-medium bg-blue-500 text-white rounded-full\"\n                                            >\n                                              New\n                                            </motion.span>\n                                          )}\n                                          {isEditing && (\n                                            <span className=\"inline-flex items-center px-2 py-1 text-xs font-medium bg-green-500 text-white rounded-full\">\n                                              Editing\n                                            </span>\n                                          )}\n                                        </div>\n                                        <div className=\"flex items-center gap-4 text-xs text-slate-300 mb-2\">\n                                          <span className=\"flex items-center gap-1\">\n                                            <Calendar size={12} />\n                                            {isEditing ? editingEntryData.date : entry.date}\n                                          </span>\n                                          <span className=\"flex items-center gap-1\">\n                                            <Clock size={12} />\n                                            {isEditing ? editingEntryData.time : entry.time}\n                                          </span>\n                                          <span>by {isEditing ? editingEntryData.author : entry.author}</span>\n                                        </div>\n                                        <p className=\"text-slate-200 text-sm\">\n                                          {isEditing ? (\n                                            editingEntryData.content || 'No content...'\n                                          ) : (\n                                            entry.content?.length > 100 \n                                              ? `${entry.content.substring(0, 100)}...` \n                                              : entry.content || 'No content...'\n                                          )}\n                                        </p>\n                                      </div>\n                                      \n                                      {!isEditing && (\n                                        <motion.div\n                                          animate={{ rotate: isExpanded ? 180 : 0 }}\n                                          transition={{ duration: 0.2 }}\n                                        >\n                                          <Edit3 size={16} className=\"text-slate-400\" />\n                                        </motion.div>\n                                      )}\n                                    </div>\n                                  </div>\n                                  \n                                  {/* Inline Editing Form */}\n                                  <AnimatePresence>\n                                    {isEditing && (\n                                      <motion.div\n                                        initial={{ height: 0, opacity: 0 }}\n                                        animate={{ height: \"auto\", opacity: 1 }}\n                                        exit={{ height: 0, opacity: 0 }}\n                                        transition={{ duration: 0.3, ease: \"easeInOut\" }}\n                                        className=\"overflow-hidden\"\n                                      >\n                                        <div className=\"px-4 pb-4 pt-0 border-t border-slate-600\">\n                                          <div className=\"space-y-3 mt-3\">\n                                            {/* Type and Timestamp Row */}\n                                            <div className=\"grid grid-cols-2 gap-3\">\n                                              <div>\n                                                <label className=\"block text-xs font-medium text-slate-300 mb-1\">\n                                                  Entry Type\n                                                </label>\n                                                <select\n                                                  value={editingEntryData.type || 'followup'}\n                                                  onChange={(e) => updateEditingEntry('type', e.target.value)}\n                                                  className=\"w-full px-2 py-1 bg-slate-700 border border-slate-600 rounded text-white text-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500\"\n                                                >\n                                                  <option value=\"assessment\">Assessment</option>\n                                                  <option value=\"medication\">Medication</option>\n                                                  <option value=\"therapy\">Therapy</option>\n                                                  <option value=\"followup\">Follow-up</option>\n                                                  <option value=\"note\">Note</option>\n                                                </select>\n                                              </div>\n                                              \n                                              <div>\n                                                <label className=\"block text-xs font-medium text-slate-300 mb-1\">\n                                                  Timestamp\n                                                </label>\n                                                <input\n                                                  type=\"datetime-local\"\n                                                  value={editingEntryData.timestamp ? \n                                                    new Date(editingEntryData.timestamp).toISOString().slice(0, -1) : \n                                                    new Date().toISOString().slice(0, -1)\n                                                  }\n                                                  onChange={(e) => updateEditingEntry('timestamp', new Date(e.target.value).toISOString())}\n                                                  className=\"w-full px-2 py-1 bg-slate-700 border border-slate-600 rounded text-white text-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500\"\n                                                />\n                                              </div>\n                                            </div>\n                                            \n                                            {/* Content */}\n                                            <div>\n                                              <label className=\"block text-xs font-medium text-slate-300 mb-1\">\n                                                Content\n                                              </label>\n                                              <textarea\n                                                value={editingEntryData.content || ''}\n                                                onChange={(e) => updateEditingEntry('content', e.target.value)}\n                                                onKeyPress={handleEditingKeyPress}\n                                                placeholder=\"Enter clinical notes, observations, or updates...\"\n                                                rows={4}\n                                                className=\"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white text-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500 resize-none\"\n                                              />\n                                              <p className=\"text-xs text-slate-400 mt-1\">\n                                                Press Shift+Enter to save, Escape to cancel\n                                              </p>\n                                            </div>\n                                            \n                                            {/* Action Buttons */}\n                                            <div className=\"flex justify-end gap-2 pt-2\">\n                                              <motion.button\n                                                whileHover={{ scale: 1.02 }}\n                                                whileTap={{ scale: 0.98 }}\n                                                onClick={cancelEditingEntry}\n                                                className=\"px-3 py-1 bg-slate-600 text-white rounded hover:bg-slate-500 transition-colors text-sm\"\n                                              >\n                                                Cancel\n                                              </motion.button>\n                                              <motion.button\n                                                whileHover={{ scale: 1.02 }}\n                                                whileTap={{ scale: 0.98 }}\n                                                onClick={saveEditingEntry}\n                                                disabled={!editingEntryData.content?.trim()}\n                                                className=\"px-3 py-1 bg-green-600 text-white rounded hover:bg-green-700 disabled:bg-gray-500 disabled:cursor-not-allowed transition-colors text-sm flex items-center gap-1\"\n                                              >\n                                                <Save size={14} />\n                                                Save\n                                              </motion.button>\n                                            </div>\n                                          </div>\n                                        </div>\n                                      </motion.div>\n                                    )}\n                                  </AnimatePresence>\n                                  \n                                  {/* Expanded View for Non-Editing */}\n                                  <AnimatePresence>\n                                    {isExpanded && !isEditing && entry.details && entry.details !== entry.content && (\n                                      <motion.div\n                                        initial={{ height: 0, opacity: 0 }}\n                                        animate={{ height: \"auto\", opacity: 1 }}\n                                        exit={{ height: 0, opacity: 0 }}\n                                        transition={{ duration: 0.3, ease: \"easeInOut\" }}\n                                        className=\"overflow-hidden\"\n                                      >\n                                        <div className=\"px-4 pb-4 border-t border-slate-600\">\n                                          <h5 className=\"text-white font-medium text-sm mb-2 mt-3\">Detailed Notes:</h5>\n                                          <p className=\"text-slate-300 text-sm leading-relaxed\">{entry.details}</p>\n                                        </div>\n                                      </motion.div>\n                                    )}\n                                  </AnimatePresence>\n                                </motion.div>\n                              </motion.div>\n                            );\n                          })}\n                        </AnimatePresence>\n                        \n                        {/* Empty state */}\n                        {timelineEntries.length === 0 && (\n                          <motion.div\n                            initial={{ opacity: 0 }}\n                            animate={{ opacity: 1 }}\n                            className=\"text-center py-12\"\n                          >\n                            <Clock size={48} className=\"mx-auto text-slate-500 mb-4\" />\n                            <p className=\"text-slate-400 text-lg mb-2\">No timeline entries yet</p>\n                            <p className=\"text-slate-500 text-sm\">Click \"Add Entry\" to create the first timeline entry</p>\n                          </motion.div>\n                        )}\n                      </div>\n                      \n                      <div className=\"absolute bottom-0 left-0 right-0 h-4 bg-gradient-to-t from-white to-transparent z-10 pointer-events-none\" />\n                    </div>\n                  </motion.div>\n                )}\n              </AnimatePresence>\n            </motion.div>\n\n            {isEditing && (\n              <div className=\"sticky bottom-0 bg-gray-50 border-t border-gray-200 px-6 py-4 flex items-center justify-between\">\n                <div className=\"text-sm text-gray-500\">\n                  Changes will be auto-saved\n                </div>\n                <div className=\"flex items-center gap-3\">\n                  <button\n                    onClick={() => {\n                      setIsEditing(false);\n                      setEditData({ ...data });\n                    }}\n                    disabled={isLoading}\n                    className=\"px-4 py-2 text-gray-600 hover:text-gray-800 border border-gray-300 rounded-lg hover:bg-gray-100 transition-colors\"\n                  >\n                    Cancel\n                  </button>\n                  <button\n                    onClick={handleSave}\n                    disabled={isLoading}\n                    className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2\"\n                  >\n                    {isLoading ? <Loader2 size={16} className=\"animate-spin\" /> : <Save size={16} />}\n                    {isLoading ? 'Saving...' : 'Save Changes'}\n                  </button>\n                </div>\n              </div>\n            )}\n          </motion.div>\n        </motion.div>\n      )}\n    </AnimatePresence>\n  );\n};\n\nexport default React.memo(CaseModal, (prevProps, nextProps) => {\n  return (\n    prevProps.isOpen === nextProps.isOpen &&\n    prevProps.data?.id === nextProps.data?.id &&\n    prevProps.data?.updated_at === nextProps.data?.updated_at\n  );\n});\n","// Enhanced Topic Modal with tabbed interface and advanced animations\nimport React, { useState, useEffect, useMemo, useCallback, useRef } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { \n  X, \n  BookOpen, \n  Brain, \n  Target, \n  Award, \n  Clock, \n  Sparkles, \n  Link2,\n  Edit3,\n  Trash2,\n  Save,\n  Loader2,\n  Star,\n  Plus,\n  Check,\n  RotateCcw,\n  TrendingUp,\n  Lightbulb,\n  FileText,\n  Layers\n} from 'lucide-react';\n\n// Animation variants for Framer Motion\nconst modalVariants = {\n  hidden: {\n    opacity: 0,\n    scale: 0.3,\n    y: 50,\n    rotate: -5,\n  },\n  visible: {\n    opacity: 1,\n    scale: 1,\n    y: 0,\n    rotate: 0,\n    transition: {\n      type: \"spring\",\n      damping: 25,\n      stiffness: 300,\n      duration: 0.6,\n    }\n  },\n  exit: {\n    opacity: 0,\n    scale: 0.7,\n    y: 30,\n    rotate: -3,\n    transition: {\n      type: \"easeInOut\",\n      duration: 0.4,\n    }\n  }\n};\n\nconst backdropVariants = {\n  hidden: { \n    opacity: 0,\n    backdropFilter: 'blur(0px)'\n  },\n  visible: { \n    opacity: 1,\n    backdropFilter: 'blur(8px)',\n    transition: {\n      duration: 0.4,\n      ease: \"easeOut\"\n    }\n  },\n  exit: { \n    opacity: 0,\n    backdropFilter: 'blur(0px)',\n    transition: {\n      duration: 0.3,\n      ease: \"easeIn\"\n    }\n  }\n};\n\nconst contentVariants = {\n  hidden: {\n    opacity: 0,\n    y: 20,\n    scale: 0.95,\n  },\n  visible: {\n    opacity: 1,\n    y: 0,\n    scale: 1,\n    transition: {\n      type: \"easeOut\",\n      duration: 0.3,\n      delay: 0.1,\n    }\n  },\n  exit: {\n    opacity: 0,\n    y: -10,\n    scale: 1.02,\n    transition: {\n      type: \"easeIn\",\n      duration: 0.2,\n    }\n  }\n};\n\nconst TopicModal = ({ \n  isOpen, \n  data, \n  onClose,\n  onAnimationStart,\n  onAnimationEnd,\n  setMindMapData,\n  autoSaveMindMapData,\n  addToast\n}) => {\n  const [isAnimating, setIsAnimating] = useState(false);\n  const [isVisible, setIsVisible] = useState(false);\n  const [isClosing, setIsClosing] = useState(false);\n  const [isEditing, setIsEditing] = useState(false);\n  const [editData, setEditData] = useState({});\n  const [isLoading, setIsLoading] = useState(false);\n  const [hasInitialized, setHasInitialized] = useState(false);\n  const [activeTab, setActiveTab] = useState('overview');\n  const [isTabTransitioning, setIsTabTransitioning] = useState(false);\n  const [newResource, setNewResource] = useState('');\n  const [showResourceForm, setShowResourceForm] = useState(false);\n\n  useEffect(() => {\n    if (isOpen && data && !hasInitialized) {\n      setIsVisible(true);\n      setEditData({ \n        ...data,\n        resources: data.resources || [],\n        flashcard_count: data.flashcard_count || 0,\n        completed_flashcards: data.completed_flashcards || 0\n      });\n      setHasInitialized(true);\n      setIsAnimating(true);\n      if (onAnimationStart) onAnimationStart();\n      \n      setTimeout(() => {\n        setIsAnimating(false);\n        if (onAnimationEnd) onAnimationEnd();\n      }, 600);\n    } else if (!isOpen && hasInitialized) {\n      setHasInitialized(false);\n    }\n  }, [isOpen, hasInitialized, onAnimationStart, onAnimationEnd]);\n\n  // Separate effect for data updates when modal is already open\n  useEffect(() => {\n    if (isOpen && data && hasInitialized && !isEditing && !isLoading && !isTabTransitioning && !isAnimating) {\n      setEditData({ \n        ...data,\n        resources: data.resources || [],\n        flashcard_count: data.flashcard_count || 0,\n        completed_flashcards: data.completed_flashcards || 0\n      });\n    }\n  }, [data?.id, isOpen, hasInitialized, isEditing, isLoading, isTabTransitioning, isAnimating]);\n\n  const progressPercentage = useMemo(() => {\n    const total = editData.flashcard_count || 0;\n    const completed = editData.completed_flashcards || 0;\n    return total > 0 ? Math.round((completed / total) * 100) : 0;\n  }, [editData.flashcard_count, editData.completed_flashcards]);\n\n  const handleClose = useCallback(() => {\n    if (isAnimating || isClosing) return;\n    \n    setIsAnimating(true);\n    setIsClosing(true);\n    if (onAnimationStart) onAnimationStart();\n    \n    // Set visibility to false to trigger exit animation\n    setIsVisible(false);\n  }, [onAnimationStart, isAnimating, isClosing]);\n\n  const handleSave = useCallback(async () => {\n    if (isLoading) return;\n    \n    setIsLoading(true);\n    try {\n      setMindMapData(prevData => {\n        const updatedTopics = prevData.topics.map(topic =>\n          String(topic.id) === String(data?.id) ? { ...topic, ...editData } : topic\n        );\n        const newData = { ...prevData, topics: updatedTopics };\n        autoSaveMindMapData(newData);\n        return newData;\n      });\n      \n      setIsEditing(false);\n      addToast('Topic updated successfully', 'success');\n    } catch (error) {\n      console.error('Error saving topic:', error);\n      addToast('Failed to save topic', 'error');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [data?.id, editData, setMindMapData, autoSaveMindMapData, addToast, isLoading]);\n\n  const handleDelete = useCallback(async () => {\n    if (isLoading) return;\n    \n    if (!window.confirm('Are you sure you want to delete this topic?')) return;\n    \n    setIsLoading(true);\n    try {\n      setMindMapData(prevData => {\n        const updatedTopics = prevData.topics.filter(topic => String(topic.id) !== String(data?.id));\n        const newData = { ...prevData, topics: updatedTopics };\n        autoSaveMindMapData(newData);\n        return newData;\n      });\n      \n      addToast('Topic deleted successfully', 'success');\n      handleClose();\n    } catch (error) {\n      console.error('Error deleting topic:', error);\n      addToast('Failed to delete topic', 'error');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [data?.id, setMindMapData, autoSaveMindMapData, addToast, handleClose, isLoading]);\n\n  const updateField = useCallback((field, value) => {\n    setEditData(prev => ({ ...prev, [field]: value }));\n  }, []);\n\n  const addResource = useCallback(() => {\n    if (!newResource.trim()) return;\n    \n    const updatedResources = [...(editData.resources || []), newResource.trim()];\n    updateField('resources', updatedResources);\n    setNewResource('');\n    setShowResourceForm(false);\n  }, [newResource, editData.resources, updateField]);\n\n  const removeResource = useCallback((index) => {\n    const updatedResources = editData.resources.filter((_, i) => i !== index);\n    updateField('resources', updatedResources);\n  }, [editData.resources, updateField]);\n\n  const renderField = (label, field, type = 'text', options = {}) => {\n    const value = editData[field] || '';\n    \n    if (!isEditing) {\n      if (type === 'textarea') {\n        return (\n          <div className=\"space-y-2\">\n            <label className=\"block text-sm font-medium text-gray-700\">{label}</label>\n            <div className=\"p-3 bg-gray-50 rounded-lg border min-h-[2.5rem] text-gray-800\">\n              {value || <span className=\"text-gray-400 italic\">Not specified</span>}\n            </div>\n          </div>\n        );\n      }\n      \n      if (type === 'select') {\n        return (\n          <div className=\"space-y-2\">\n            <label className=\"block text-sm font-medium text-gray-700\">{label}</label>\n            <div className=\"p-3 bg-gray-50 rounded-lg border text-gray-800\">\n              {value || <span className=\"text-gray-400 italic\">Not specified</span>}\n            </div>\n          </div>\n        );\n      }\n      \n      return (\n        <div className=\"space-y-2\">\n          <label className=\"block text-sm font-medium text-gray-700\">{label}</label>\n          <div className=\"p-3 bg-gray-50 rounded-lg border text-gray-800\">\n            {value || <span className=\"text-gray-400 italic\">Not specified</span>}\n          </div>\n        </div>\n      );\n    }\n\n    // Editing mode\n    if (type === 'textarea') {\n      return (\n        <div className=\"space-y-2\">\n          <label className=\"block text-sm font-medium text-gray-700\">{label}</label>\n          <textarea\n            value={value}\n            onChange={(e) => updateField(field, e.target.value)}\n            className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors\"\n            rows={options.rows || 3}\n            placeholder={`Enter ${label.toLowerCase()}...`}\n          />\n        </div>\n      );\n    }\n\n    if (type === 'select' && options.choices) {\n      return (\n        <div className=\"space-y-2\">\n          <label className=\"block text-sm font-medium text-gray-700\">{label}</label>\n          <select\n            value={value}\n            onChange={(e) => updateField(field, e.target.value)}\n            className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors\"\n          >\n            <option value=\"\">Select {label.toLowerCase()}...</option>\n            {options.choices.map(choice => (\n              <option key={choice} value={choice}>{choice}</option>\n            ))}\n          </select>\n        </div>\n      );\n    }\n\n    return (\n      <div className=\"space-y-2\">\n        <label className=\"block text-sm font-medium text-gray-700\">{label}</label>\n        <input\n          type={type}\n          value={value}\n          onChange={(e) => updateField(field, type === 'number' ? Number(e.target.value) : e.target.value)}\n          className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors\"\n          placeholder={`Enter ${label.toLowerCase()}...`}\n        />\n      </div>\n    );\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <AnimatePresence mode=\"wait\" onExitComplete={() => {\n      setIsAnimating(false);\n      setIsClosing(false);\n      setHasInitialized(false);\n      onClose();\n      if (onAnimationEnd) onAnimationEnd();\n    }}>\n      {isVisible && (\n        <motion.div\n          key={`topic-modal-${data?.id || 'default'}`}\n          initial=\"hidden\"\n          animate=\"visible\"\n          exit=\"exit\"\n          variants={backdropVariants}\n          className=\"fixed inset-0 bg-black flex items-center justify-center z-50\"\n          style={{ \n            willChange: 'backdrop-filter, opacity',\n            backfaceVisibility: 'hidden',\n            transform: 'translate3d(0, 0, 0)'\n          }}\n          onClick={(e) => e.target === e.currentTarget && handleClose()}\n        >\n          <motion.div\n            initial=\"hidden\"\n            animate=\"visible\"\n            exit=\"exit\"\n            variants={modalVariants}\n            className=\"bg-white rounded-2xl shadow-2xl max-w-4xl w-full mx-4 max-h-[85vh] overflow-hidden\"\n            style={{ \n              willChange: 'transform, opacity, scale',\n              backfaceVisibility: 'hidden'\n            }}\n            onClick={(e) => e.stopPropagation()}\n            onAnimationStart={() => {\n              setIsAnimating(true);\n              if (onAnimationStart) onAnimationStart();\n            }}\n            onAnimationComplete={() => {\n              setIsAnimating(false);\n              if (onAnimationEnd) onAnimationEnd();\n            }}\n          >\n            <motion.div \n              initial=\"hidden\"\n              animate=\"visible\"\n              exit=\"exit\"\n              variants={contentVariants}\n              className=\"bg-gradient-to-br from-slate-900 to-slate-800 text-white px-6 py-4 flex items-center justify-between\"\n            >\n              <div className=\"flex items-center gap-3\">\n                <BookOpen size={24} />\n                <h2 className=\"text-xl font-semibold\">Topic Details</h2>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                {!isEditing && !isLoading && (\n                  <>\n                    <button\n                      onClick={() => setIsEditing(true)}\n                      className=\"text-white hover:text-gray-200 p-2 rounded-full hover:bg-white hover:bg-opacity-20 transition-all\"\n                      title=\"Edit\"\n                    >\n                      <Edit3 size={20} />\n                    </button>\n                    <button\n                      onClick={handleDelete}\n                      className=\"text-white hover:text-red-200 p-2 rounded-full hover:bg-red-500 hover:bg-opacity-30 transition-all\"\n                      title=\"Delete\"\n                    >\n                      <Trash2 size={20} />\n                    </button>\n                  </>\n                )}\n                <button onClick={handleClose} className=\"text-white hover:text-gray-200 p-2 rounded-full hover:bg-white hover:bg-opacity-20 transition-all\">\n                  <X size={20} />\n                </button>\n              </div>\n            </motion.div>\n\n            {/* Tab Navigation */}\n            <div className=\"bg-gradient-to-r from-slate-900 via-slate-800 to-slate-900 border-b border-slate-600\">\n              <nav className=\"flex flex-wrap gap-2 px-6 py-4\">\n                {[\n                  { key: 'overview', label: 'Overview', icon: BookOpen },\n                  { key: 'progress', label: 'Progress', icon: TrendingUp },\n                  { key: 'resources', label: 'Resources', icon: FileText },\n                  { key: 'insights', label: 'Insights', icon: Lightbulb },\n                  { key: 'connections', label: 'Connections', icon: Link2 }\n                ].map(({ key, label, icon: Icon }) => (\n                  <motion.button\n                    key={key}\n                    onClick={() => {\n                      if (isTabTransitioning) return;\n                      setIsTabTransitioning(true);\n                      setActiveTab(key);\n                      setTimeout(() => setIsTabTransitioning(false), 300);\n                    }}\n                    className={`relative flex items-center gap-2 px-4 py-3 rounded-xl font-medium text-sm transition-all duration-300 ${\n                      activeTab === key\n                        ? 'bg-gradient-to-r from-purple-500 to-indigo-600 text-white shadow-lg shadow-purple-500/25'\n                        : 'text-slate-300 hover:text-white hover:bg-slate-700/50 hover:shadow-md'\n                    }`}\n                    whileHover={{ scale: activeTab === key ? 1 : 1.02 }}\n                    whileTap={{ scale: 0.98 }}\n                    initial={false}\n                    animate={{\n                      scale: activeTab === key ? 1.05 : 1,\n                      boxShadow: activeTab === key \n                        ? '0 8px 25px rgba(147, 51, 234, 0.3), 0 0 20px rgba(99, 102, 241, 0.2)' \n                        : '0 2px 8px rgba(0, 0, 0, 0.1)'\n                    }}\n                    transition={{ duration: 0.3, ease: \"easeOut\" }}\n                  >\n                    <Icon size={16} className={activeTab === key ? 'drop-shadow-sm' : ''} />\n                    {label}\n                    \n                    {activeTab === key && (\n                      <motion.div\n                        layoutId=\"topicTabGlow\"\n                        className=\"absolute inset-0 bg-gradient-to-r from-purple-400/20 to-indigo-500/20 rounded-xl blur-sm\"\n                        initial={false}\n                        transition={{ type: \"spring\", bounce: 0.2, duration: 0.6 }}\n                      />\n                    )}\n                  </motion.button>\n                ))}\n              </nav>\n            </div>\n            \n            {/* Tab Content */}\n            <motion.div \n              className=\"relative overflow-hidden bg-gradient-to-br from-slate-50 to-slate-100\"\n              layout=\"position\"\n              layoutRoot\n              transition={{ \n                layout: { duration: 0.4, ease: \"easeInOut\" },\n                height: { duration: 0.4, ease: \"easeInOut\" }\n              }}\n            >\n              <AnimatePresence mode=\"wait\" initial={false} onExitComplete={() => setIsTabTransitioning(false)}>\n                {/* Overview Tab */}\n                {activeTab === 'overview' && (\n                  <motion.div\n                    key=\"overview\"\n                    initial={{ opacity: 0, x: -30 }}\n                    animate={{ opacity: 1, x: 0 }}\n                    exit={{ opacity: 0, x: 30 }}\n                    transition={{ duration: 0.4, ease: \"easeOut\" }}\n                    layout=\"position\"\n                    layoutId=\"tabContent\"\n                    className=\"p-6 overflow-y-auto max-h-[calc(85vh-200px)] scrollbar-thin scrollbar-thumb-slate-400 scrollbar-track-slate-200\"\n                  >\n                    <div className=\"space-y-6\">\n                      <div className=\"bg-white rounded-xl p-6 shadow-lg border border-slate-200\">\n                        <h3 className=\"text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2\">\n                          <Brain size={20} className=\"text-purple-600\" />\n                          Topic Information\n                        </h3>\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                          {renderField('Title', 'title')}\n                          {renderField('Category', 'category', 'select', {\n                            choices: [\n                              'Mood Disorders',\n                              'Anxiety Disorders', \n                              'Psychotic Disorders',\n                              'Personality Disorders',\n                              'Substance Use Disorders',\n                              'Neurodevelopmental Disorders',\n                              'Trauma-Related Disorders',\n                              'Eating Disorders',\n                              'Sleep Disorders',\n                              'Neurocognitive Disorders',\n                              'Other'\n                            ]\n                          })}\n                        </div>\n                        <div className=\"mt-6\">\n                          {renderField('Description', 'description', 'textarea', { rows: 4 })}\n                        </div>\n                      </div>\n                      \n                      <div className=\"bg-white rounded-xl p-6 shadow-lg border border-slate-200\">\n                        <h3 className=\"text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2\">\n                          <Target size={20} className=\"text-green-600\" />\n                          Learning Progress\n                        </h3>\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                          {renderField('Total Flashcards', 'flashcard_count', 'number')}\n                          {renderField('Completed Flashcards', 'completed_flashcards', 'number')}\n                        </div>\n                        \n                        {/* Progress Visualization */}\n                        <div className=\"mt-6\">\n                          <div className=\"flex items-center justify-between mb-2\">\n                            <span className=\"text-sm font-medium text-gray-700\">Progress</span>\n                            <span className=\"text-sm text-gray-500\">{progressPercentage}%</span>\n                          </div>\n                          <div className=\"w-full bg-gray-200 rounded-full h-2\">\n                            <motion.div\n                              className=\"bg-gradient-to-r from-purple-500 to-indigo-600 h-2 rounded-full\"\n                              initial={{ width: 0 }}\n                              animate={{ width: `${progressPercentage}%` }}\n                              transition={{ duration: 0.8, ease: \"easeOut\" }}\n                            />\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  </motion.div>\n                )}\n\n                {/* Progress Tab */}\n                {activeTab === 'progress' && (\n                  <motion.div\n                    key=\"progress\"\n                    initial={{ opacity: 0, x: -30 }}\n                    animate={{ opacity: 1, x: 0 }}\n                    exit={{ opacity: 0, x: 30 }}\n                    transition={{ duration: 0.4, ease: \"easeOut\" }}\n                    layout=\"position\"\n                    layoutId=\"tabContent\"\n                    className=\"p-6 overflow-y-auto max-h-[calc(85vh-200px)] scrollbar-thin scrollbar-thumb-slate-400 scrollbar-track-slate-200\"\n                  >\n                    <div className=\"bg-white rounded-xl p-6 shadow-lg border border-slate-200\">\n                      <h3 className=\"text-lg font-semibold text-slate-800 mb-6 flex items-center gap-2\">\n                        <TrendingUp size={20} className=\"text-blue-600\" />\n                        Learning Analytics\n                      </h3>\n                      \n                      {/* Progress Cards */}\n                      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8\">\n                        <motion.div\n                          whileHover={{ scale: 1.02 }}\n                          className=\"bg-gradient-to-br from-green-50 to-emerald-50 p-4 rounded-lg border border-green-200\"\n                        >\n                          <div className=\"flex items-center gap-3 mb-2\">\n                            <Check size={20} className=\"text-green-600\" />\n                            <span className=\"font-medium text-green-800\">Completed</span>\n                          </div>\n                          <div className=\"text-2xl font-bold text-green-700\">\n                            {editData.completed_flashcards || 0}\n                          </div>\n                          <div className=\"text-sm text-green-600\">flashcards mastered</div>\n                        </motion.div>\n                        \n                        <motion.div\n                          whileHover={{ scale: 1.02 }}\n                          className=\"bg-gradient-to-br from-blue-50 to-indigo-50 p-4 rounded-lg border border-blue-200\"\n                        >\n                          <div className=\"flex items-center gap-3 mb-2\">\n                            <Clock size={20} className=\"text-blue-600\" />\n                            <span className=\"font-medium text-blue-800\">Remaining</span>\n                          </div>\n                          <div className=\"text-2xl font-bold text-blue-700\">\n                            {Math.max(0, (editData.flashcard_count || 0) - (editData.completed_flashcards || 0))}\n                          </div>\n                          <div className=\"text-sm text-blue-600\">flashcards to review</div>\n                        </motion.div>\n                        \n                        <motion.div\n                          whileHover={{ scale: 1.02 }}\n                          className=\"bg-gradient-to-br from-purple-50 to-violet-50 p-4 rounded-lg border border-purple-200\"\n                        >\n                          <div className=\"flex items-center gap-3 mb-2\">\n                            <Award size={20} className=\"text-purple-600\" />\n                            <span className=\"font-medium text-purple-800\">Progress</span>\n                          </div>\n                          <div className=\"text-2xl font-bold text-purple-700\">\n                            {progressPercentage}%\n                          </div>\n                          <div className=\"text-sm text-purple-600\">completion rate</div>\n                        </motion.div>\n                      </div>\n                      \n                      {/* Visual Progress Bar */}\n                      <div className=\"mb-6\">\n                        <div className=\"flex items-center justify-between mb-3\">\n                          <span className=\"text-lg font-medium text-gray-800\">Overall Progress</span>\n                          <span className=\"text-sm text-gray-500\">\n                            {editData.completed_flashcards || 0} / {editData.flashcard_count || 0}\n                          </span>\n                        </div>\n                        <div className=\"relative\">\n                          <div className=\"w-full bg-gray-200 rounded-full h-4\">\n                            <motion.div\n                              className=\"bg-gradient-to-r from-purple-500 via-blue-500 to-indigo-600 h-4 rounded-full flex items-center justify-end pr-2\"\n                              initial={{ width: 0 }}\n                              animate={{ width: `${progressPercentage}%` }}\n                              transition={{ duration: 1.2, ease: \"easeOut\" }}\n                            >\n                              {progressPercentage > 10 && (\n                                <span className=\"text-xs font-bold text-white drop-shadow-sm\">\n                                  {progressPercentage}%\n                                </span>\n                              )}\n                            </motion.div>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  </motion.div>\n                )}\n\n                {/* Resources Tab */}\n                {activeTab === 'resources' && (\n                  <motion.div\n                    key=\"resources\"\n                    initial={{ opacity: 0, x: -30 }}\n                    animate={{ opacity: 1, x: 0 }}\n                    exit={{ opacity: 0, x: 30 }}\n                    transition={{ duration: 0.4, ease: \"easeOut\" }}\n                    layout=\"position\"\n                    layoutId=\"tabContent\"\n                    className=\"p-6 overflow-y-auto max-h-[calc(85vh-200px)] scrollbar-thin scrollbar-thumb-slate-400 scrollbar-track-slate-200\"\n                  >\n                    <div className=\"bg-white rounded-xl p-6 shadow-lg border border-slate-200\">\n                      <div className=\"flex items-center justify-between mb-6\">\n                        <h3 className=\"text-lg font-semibold text-slate-800 flex items-center gap-2\">\n                          <FileText size={20} className=\"text-orange-600\" />\n                          Learning Resources\n                        </h3>\n                        {isEditing && (\n                          <button\n                            onClick={() => setShowResourceForm(!showResourceForm)}\n                            className=\"flex items-center gap-2 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm\"\n                          >\n                            <Plus size={16} />\n                            Add Resource\n                          </button>\n                        )}\n                      </div>\n                      \n                      {/* Add Resource Form */}\n                      {isEditing && showResourceForm && (\n                        <motion.div\n                          initial={{ opacity: 0, height: 0 }}\n                          animate={{ opacity: 1, height: \"auto\" }}\n                          exit={{ opacity: 0, height: 0 }}\n                          className=\"mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200\"\n                        >\n                          <div className=\"flex gap-3\">\n                            <input\n                              type=\"text\"\n                              value={newResource}\n                              onChange={(e) => setNewResource(e.target.value)}\n                              placeholder=\"Enter resource URL or description...\"\n                              className=\"flex-1 p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                              onKeyPress={(e) => e.key === 'Enter' && addResource()}\n                            />\n                            <button\n                              onClick={addResource}\n                              className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors\"\n                            >\n                              Add\n                            </button>\n                          </div>\n                        </motion.div>\n                      )}\n                      \n                      {/* Resources List */}\n                      <div className=\"space-y-3\">\n                        {editData.resources && editData.resources.length > 0 ? (\n                          editData.resources.map((resource, index) => (\n                            <motion.div\n                              key={index}\n                              initial={{ opacity: 0, y: 10 }}\n                              animate={{ opacity: 1, y: 0 }}\n                              transition={{ delay: index * 0.1 }}\n                              className=\"flex items-center justify-between p-3 bg-gray-50 rounded-lg border\"\n                            >\n                              <span className=\"text-gray-700\">{resource}</span>\n                              {isEditing && (\n                                <button\n                                  onClick={() => removeResource(index)}\n                                  className=\"text-red-500 hover:text-red-700 p-1 rounded\"\n                                >\n                                  <X size={16} />\n                                </button>\n                              )}\n                            </motion.div>\n                          ))\n                        ) : (\n                          <div className=\"text-center py-8 text-gray-500\">\n                            <FileText size={48} className=\"mx-auto mb-3 text-gray-300\" />\n                            <p>No resources added yet</p>\n                            {isEditing && (\n                              <p className=\"text-sm mt-1\">Click \"Add Resource\" to get started</p>\n                            )}\n                          </div>\n                        )}\n                      </div>\n                    </div>\n                  </motion.div>\n                )}\n\n                {/* Insights Tab */}\n                {activeTab === 'insights' && (\n                  <motion.div\n                    key=\"insights\"\n                    initial={{ opacity: 0, x: -30 }}\n                    animate={{ opacity: 1, x: 0 }}\n                    exit={{ opacity: 0, x: 30 }}\n                    transition={{ duration: 0.4, ease: \"easeOut\" }}\n                    layout=\"position\"\n                    layoutId=\"tabContent\"\n                    className=\"p-6 overflow-y-auto max-h-[calc(85vh-200px)] scrollbar-thin scrollbar-thumb-slate-400 scrollbar-track-slate-200\"\n                  >\n                    <div className=\"bg-white rounded-xl p-6 shadow-lg border border-slate-200\">\n                      <h3 className=\"text-lg font-semibold text-slate-800 mb-6 flex items-center gap-2\">\n                        <Lightbulb size={20} className=\"text-yellow-600\" />\n                        Learning Insights\n                      </h3>\n                      \n                      {/* Insights Cards */}\n                      <div className=\"space-y-4\">\n                        <motion.div\n                          whileHover={{ scale: 1.01 }}\n                          className=\"p-4 bg-gradient-to-r from-yellow-50 to-amber-50 rounded-lg border border-yellow-200\"\n                        >\n                          <div className=\"flex items-start gap-3\">\n                            <Sparkles size={20} className=\"text-yellow-600 mt-1\" />\n                            <div>\n                              <h4 className=\"font-medium text-yellow-800 mb-1\">Study Recommendation</h4>\n                              <p className=\"text-yellow-700 text-sm\">\n                                Based on your progress, consider reviewing foundational concepts before advancing to complex topics.\n                              </p>\n                            </div>\n                          </div>\n                        </motion.div>\n                        \n                        <motion.div\n                          whileHover={{ scale: 1.01 }}\n                          className=\"p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg border border-blue-200\"\n                        >\n                          <div className=\"flex items-start gap-3\">\n                            <Brain size={20} className=\"text-blue-600 mt-1\" />\n                            <div>\n                              <h4 className=\"font-medium text-blue-800 mb-1\">Learning Pattern</h4>\n                              <p className=\"text-blue-700 text-sm\">\n                                You tend to perform better with visual learning materials. Consider adding more diagrams and charts.\n                              </p>\n                            </div>\n                          </div>\n                        </motion.div>\n                        \n                        <motion.div\n                          whileHover={{ scale: 1.01 }}\n                          className=\"p-4 bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg border border-green-200\"\n                        >\n                          <div className=\"flex items-start gap-3\">\n                            <Target size={20} className=\"text-green-600 mt-1\" />\n                            <div>\n                              <h4 className=\"font-medium text-green-800 mb-1\">Next Steps</h4>\n                              <p className=\"text-green-700 text-sm\">\n                                Focus on completing the remaining flashcards to solidify your understanding of this topic.\n                              </p>\n                            </div>\n                          </div>\n                        </motion.div>\n                      </div>\n                    </div>\n                  </motion.div>\n                )}\n\n                {/* Connections Tab */}\n                {activeTab === 'connections' && (\n                  <motion.div\n                    key=\"connections\"\n                    initial={{ opacity: 0, x: -30 }}\n                    animate={{ opacity: 1, x: 0 }}\n                    exit={{ opacity: 0, x: 30 }}\n                    transition={{ duration: 0.4, ease: \"easeOut\" }}\n                    layout=\"position\"\n                    layoutId=\"tabContent\"\n                    className=\"p-6 overflow-y-auto max-h-[calc(85vh-200px)] scrollbar-thin scrollbar-thumb-slate-400 scrollbar-track-slate-200\"\n                  >\n                    <div className=\"bg-white rounded-xl p-6 shadow-lg border border-slate-200\">\n                      <h3 className=\"text-lg font-semibold text-slate-800 mb-6 flex items-center gap-2\">\n                        <Link2 size={20} className=\"text-indigo-600\" />\n                        Related Content\n                      </h3>\n                      \n                      <div className=\"text-center py-8 text-gray-500\">\n                        <Layers size={48} className=\"mx-auto mb-3 text-gray-300\" />\n                        <p>No connections found</p>\n                        <p className=\"text-sm mt-1\">Create connections by linking this topic to cases, tasks, or literature</p>\n                      </div>\n                    </div>\n                  </motion.div>\n                )}\n              </AnimatePresence>\n            </motion.div>\n\n            {isEditing && (\n              <div className=\"sticky bottom-0 bg-gray-50 border-t border-gray-200 px-6 py-4 flex items-center justify-between\">\n                <div className=\"text-sm text-gray-500\">\n                  Changes will be auto-saved\n                </div>\n                <div className=\"flex items-center gap-3\">\n                  <button\n                    onClick={() => {\n                      setIsEditing(false);\n                      setEditData({ ...data });\n                      setShowResourceForm(false);\n                    }}\n                    disabled={isLoading}\n                    className=\"px-4 py-2 text-gray-600 hover:text-gray-800 border border-gray-300 rounded-lg hover:bg-gray-100 transition-colors\"\n                  >\n                    Cancel\n                  </button>\n                  <button\n                    onClick={handleSave}\n                    disabled={isLoading}\n                    className=\"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors flex items-center gap-2\"\n                  >\n                    {isLoading ? <Loader2 size={16} className=\"animate-spin\" /> : <Save size={16} />}\n                    {isLoading ? 'Saving...' : 'Save Changes'}\n                  </button>\n                </div>\n              </div>\n            )}\n          </motion.div>\n        </motion.div>\n      )}\n    </AnimatePresence>\n  );\n};\n\nexport default React.memo(TopicModal, (prevProps, nextProps) => {\n  return (\n    prevProps.isOpen === nextProps.isOpen &&\n    prevProps.data?.id === nextProps.data?.id &&\n    prevProps.data?.updated_at === nextProps.data?.updated_at\n  );\n});\n","// Enhanced Task Modal with tabbed interface and advanced animations\nimport React, { useState, useEffect, useMemo, useCallback, useRef } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { \n  X, \n  CheckSquare, \n  Clock, \n  AlertTriangle, \n  Flag, \n  Calendar, \n  Link2, \n  Target,\n  Edit3,\n  Trash2,\n  Save,\n  Loader2,\n  Star,\n  Play,\n  Pause,\n  RotateCcw,\n  TrendingUp,\n  Users,\n  BookOpen,\n  FileText,\n  Tag\n} from 'lucide-react';\n\n// Animation variants for Framer Motion\nconst modalVariants = {\n  hidden: {\n    opacity: 0,\n    scale: 0.3,\n    y: 50,\n    rotate: -5,\n  },\n  visible: {\n    opacity: 1,\n    scale: 1,\n    y: 0,\n    rotate: 0,\n    transition: {\n      type: \"spring\",\n      damping: 25,\n      stiffness: 300,\n      duration: 0.6,\n    }\n  },\n  exit: {\n    opacity: 0,\n    scale: 0.7,\n    y: 30,\n    rotate: -3,\n    transition: {\n      type: \"easeInOut\",\n      duration: 0.4,\n    }\n  }\n};\n\nconst backdropVariants = {\n  hidden: { \n    opacity: 0,\n    backdropFilter: 'blur(0px)'\n  },\n  visible: { \n    opacity: 1,\n    backdropFilter: 'blur(8px)',\n    transition: {\n      duration: 0.4,\n      ease: \"easeOut\"\n    }\n  },\n  exit: { \n    opacity: 0,\n    backdropFilter: 'blur(0px)',\n    transition: {\n      duration: 0.3,\n      ease: \"easeIn\"\n    }\n  }\n};\n\nconst contentVariants = {\n  hidden: {\n    opacity: 0,\n    y: 20,\n    scale: 0.95,\n  },\n  visible: {\n    opacity: 1,\n    y: 0,\n    scale: 1,\n    transition: {\n      type: \"easeOut\",\n      duration: 0.3,\n      delay: 0.1,\n    }\n  },\n  exit: {\n    opacity: 0,\n    y: -10,\n    scale: 1.02,\n    transition: {\n      type: \"easeIn\",\n      duration: 0.2,\n    }\n  }\n};\n\nconst TaskModal = ({ \n  isOpen, \n  data, \n  onClose,\n  onAnimationStart,\n  onAnimationEnd,\n  setMindMapData,\n  autoSaveMindMapData,\n  addToast\n}) => {\n  const [isAnimating, setIsAnimating] = useState(false);\n  const [isVisible, setIsVisible] = useState(false);\n  const [isClosing, setIsClosing] = useState(false);\n  const [isEditing, setIsEditing] = useState(false);\n  const [editData, setEditData] = useState({});\n  const [isLoading, setIsLoading] = useState(false);\n  const [hasInitialized, setHasInitialized] = useState(false);\n  const [activeTab, setActiveTab] = useState('overview');\n  const [isTabTransitioning, setIsTabTransitioning] = useState(false);\n\n  useEffect(() => {\n    if (isOpen && data && !hasInitialized) {\n      setIsVisible(true);\n      setEditData({ \n        ...data,\n        status: data.status || 'pending',\n        priority: data.priority || 'medium'\n      });\n      setHasInitialized(true);\n      setIsAnimating(true);\n      if (onAnimationStart) onAnimationStart();\n      \n      setTimeout(() => {\n        setIsAnimating(false);\n        if (onAnimationEnd) onAnimationEnd();\n      }, 600);\n    } else if (!isOpen && hasInitialized) {\n      setHasInitialized(false);\n    }\n  }, [isOpen, hasInitialized, onAnimationStart, onAnimationEnd]);\n\n  // Separate effect for data updates when modal is already open\n  useEffect(() => {\n    if (isOpen && data && hasInitialized && !isEditing && !isLoading && !isTabTransitioning && !isAnimating) {\n      setEditData({ \n        ...data,\n        status: data.status || 'pending',\n        priority: data.priority || 'medium'\n      });\n    }\n  }, [data?.id, isOpen, hasInitialized, isEditing, isLoading, isTabTransitioning, isAnimating]);\n\n  const priorityConfig = useMemo(() => ({\n    low: { color: 'green', label: 'Low Priority', icon: Flag },\n    medium: { color: 'yellow', label: 'Medium Priority', icon: Flag },\n    high: { color: 'red', label: 'High Priority', icon: Flag },\n    urgent: { color: 'purple', label: 'Urgent', icon: AlertTriangle }\n  }), []);\n\n  const statusConfig = useMemo(() => ({\n    pending: { color: 'gray', label: 'Pending', icon: Clock },\n    in_progress: { color: 'blue', label: 'In Progress', icon: Play },\n    completed: { color: 'green', label: 'Completed', icon: CheckSquare },\n    paused: { color: 'orange', label: 'Paused', icon: Pause }\n  }), []);\n\n  const isOverdue = useMemo(() => {\n    if (!editData.due_date) return false;\n    const dueDate = new Date(editData.due_date);\n    const today = new Date();\n    return dueDate < today && editData.status !== 'completed';\n  }, [editData.due_date, editData.status]);\n\n  const handleClose = useCallback(() => {\n    if (isAnimating || isClosing) return;\n    \n    setIsAnimating(true);\n    setIsClosing(true);\n    if (onAnimationStart) onAnimationStart();\n    \n    // Set visibility to false to trigger exit animation\n    setIsVisible(false);\n  }, [onAnimationStart, isAnimating, isClosing]);\n\n  const handleSave = useCallback(async () => {\n    if (isLoading) return;\n    \n    setIsLoading(true);\n    try {\n      setMindMapData(prevData => {\n        const updatedTasks = prevData.tasks.map(task =>\n          String(task.id) === String(data?.id) ? { ...task, ...editData } : task\n        );\n        const newData = { ...prevData, tasks: updatedTasks };\n        autoSaveMindMapData(newData);\n        return newData;\n      });\n      \n      setIsEditing(false);\n      addToast('Task updated successfully', 'success');\n    } catch (error) {\n      console.error('Error saving task:', error);\n      addToast('Failed to save task', 'error');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [data?.id, editData, setMindMapData, autoSaveMindMapData, addToast, isLoading]);\n\n  const handleDelete = useCallback(async () => {\n    if (isLoading) return;\n    \n    if (!window.confirm('Are you sure you want to delete this task?')) return;\n    \n    setIsLoading(true);\n    try {\n      setMindMapData(prevData => {\n        const updatedTasks = prevData.tasks.filter(task => String(task.id) !== String(data?.id));\n        const newData = { ...prevData, tasks: updatedTasks };\n        autoSaveMindMapData(newData);\n        return newData;\n      });\n      \n      addToast('Task deleted successfully', 'success');\n      handleClose();\n    } catch (error) {\n      console.error('Error deleting task:', error);\n      addToast('Failed to delete task', 'error');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [data?.id, setMindMapData, autoSaveMindMapData, addToast, handleClose, isLoading]);\n\n  const handleStatusChange = useCallback((newStatus) => {\n    setEditData(prev => ({ ...prev, status: newStatus }));\n  }, []);\n\n  const updateField = useCallback((field, value) => {\n    setEditData(prev => ({ ...prev, [field]: value }));\n  }, []);\n\n  const renderField = (label, field, type = 'text', options = {}) => {\n    const value = editData[field] || '';\n    \n    if (!isEditing) {\n      if (type === 'textarea') {\n        return (\n          <div className=\"space-y-2\">\n            <label className=\"block text-sm font-medium text-gray-700\">{label}</label>\n            <div className=\"p-3 bg-gray-50 rounded-lg border min-h-[2.5rem] text-gray-800\">\n              {value || <span className=\"text-gray-400 italic\">Not specified</span>}\n            </div>\n          </div>\n        );\n      }\n      \n      if (type === 'select') {\n        return (\n          <div className=\"space-y-2\">\n            <label className=\"block text-sm font-medium text-gray-700\">{label}</label>\n            <div className=\"p-3 bg-gray-50 rounded-lg border text-gray-800\">\n              {value || <span className=\"text-gray-400 italic\">Not specified</span>}\n            </div>\n          </div>\n        );\n      }\n      \n      if (type === 'date') {\n        return (\n          <div className=\"space-y-2\">\n            <label className=\"block text-sm font-medium text-gray-700\">{label}</label>\n            <div className=\"p-3 bg-gray-50 rounded-lg border text-gray-800\">\n              {value ? new Date(value).toLocaleDateString() : <span className=\"text-gray-400 italic\">Not set</span>}\n            </div>\n          </div>\n        );\n      }\n      \n      return (\n        <div className=\"space-y-2\">\n          <label className=\"block text-sm font-medium text-gray-700\">{label}</label>\n          <div className=\"p-3 bg-gray-50 rounded-lg border text-gray-800\">\n            {value || <span className=\"text-gray-400 italic\">Not specified</span>}\n          </div>\n        </div>\n      );\n    }\n\n    // Editing mode\n    if (type === 'textarea') {\n      return (\n        <div className=\"space-y-2\">\n          <label className=\"block text-sm font-medium text-gray-700\">{label}</label>\n          <textarea\n            value={value}\n            onChange={(e) => updateField(field, e.target.value)}\n            className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors\"\n            rows={options.rows || 3}\n            placeholder={`Enter ${label.toLowerCase()}...`}\n          />\n        </div>\n      );\n    }\n\n    if (type === 'select' && options.choices) {\n      return (\n        <div className=\"space-y-2\">\n          <label className=\"block text-sm font-medium text-gray-700\">{label}</label>\n          <select\n            value={value}\n            onChange={(e) => updateField(field, e.target.value)}\n            className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors\"\n          >\n            <option value=\"\">Select {label.toLowerCase()}...</option>\n            {options.choices.map(choice => (\n              <option key={choice.value} value={choice.value}>{choice.label}</option>\n            ))}\n          </select>\n        </div>\n      );\n    }\n\n    if (type === 'date') {\n      return (\n        <div className=\"space-y-2\">\n          <label className=\"block text-sm font-medium text-gray-700\">{label}</label>\n          <input\n            type=\"date\"\n            value={value}\n            onChange={(e) => updateField(field, e.target.value)}\n            className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors\"\n          />\n        </div>\n      );\n    }\n\n    return (\n      <div className=\"space-y-2\">\n        <label className=\"block text-sm font-medium text-gray-700\">{label}</label>\n        <input\n          type={type}\n          value={value}\n          onChange={(e) => updateField(field, type === 'number' ? Number(e.target.value) : e.target.value)}\n          className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors\"\n          placeholder={`Enter ${label.toLowerCase()}...`}\n        />\n      </div>\n    );\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <AnimatePresence mode=\"wait\" onExitComplete={() => {\n      setIsAnimating(false);\n      setIsClosing(false);\n      setHasInitialized(false);\n      onClose();\n      if (onAnimationEnd) onAnimationEnd();\n    }}>\n      {isVisible && (\n        <motion.div\n          key={`task-modal-${data?.id || 'default'}`}\n          initial=\"hidden\"\n          animate=\"visible\"\n          exit=\"exit\"\n          variants={backdropVariants}\n          className=\"fixed inset-0 bg-black flex items-center justify-center z-50\"\n          style={{ \n            willChange: 'backdrop-filter, opacity',\n            backfaceVisibility: 'hidden',\n            transform: 'translate3d(0, 0, 0)'\n          }}\n          onClick={(e) => e.target === e.currentTarget && handleClose()}\n        >\n          <motion.div\n            initial=\"hidden\"\n            animate=\"visible\"\n            exit=\"exit\"\n            variants={modalVariants}\n            className=\"bg-white rounded-2xl shadow-2xl max-w-4xl w-full mx-4 max-h-[85vh] overflow-hidden\"\n            style={{ \n              willChange: 'transform, opacity, scale',\n              backfaceVisibility: 'hidden'\n            }}\n            onClick={(e) => e.stopPropagation()}\n            onAnimationStart={() => {\n              setIsAnimating(true);\n              if (onAnimationStart) onAnimationStart();\n            }}\n            onAnimationComplete={() => {\n              setIsAnimating(false);\n              if (onAnimationEnd) onAnimationEnd();\n            }}\n          >\n            <motion.div \n              initial=\"hidden\"\n              animate=\"visible\"\n              exit=\"exit\"\n              variants={contentVariants}\n              className=\"bg-gradient-to-br from-slate-900 to-slate-800 text-white px-6 py-4 flex items-center justify-between\"\n            >\n              <div className=\"flex items-center gap-3\">\n                <CheckSquare size={24} />\n                <h2 className=\"text-xl font-semibold\">Task Details</h2>\n                {isOverdue && (\n                  <motion.div\n                    animate={{ scale: [1, 1.1, 1] }}\n                    transition={{ duration: 1, repeat: Infinity }}\n                    className=\"flex items-center gap-1 px-2 py-1 bg-red-500 rounded-full text-xs font-medium\"\n                  >\n                    <AlertTriangle size={12} />\n                    Overdue\n                  </motion.div>\n                )}\n              </div>\n              <div className=\"flex items-center gap-2\">\n                {!isEditing && !isLoading && (\n                  <>\n                    <button\n                      onClick={() => setIsEditing(true)}\n                      className=\"text-white hover:text-gray-200 p-2 rounded-full hover:bg-white hover:bg-opacity-20 transition-all\"\n                      title=\"Edit\"\n                    >\n                      <Edit3 size={20} />\n                    </button>\n                    <button\n                      onClick={handleDelete}\n                      className=\"text-white hover:text-red-200 p-2 rounded-full hover:bg-red-500 hover:bg-opacity-30 transition-all\"\n                      title=\"Delete\"\n                    >\n                      <Trash2 size={20} />\n                    </button>\n                  </>\n                )}\n                <button onClick={handleClose} className=\"text-white hover:text-gray-200 p-2 rounded-full hover:bg-white hover:bg-opacity-20 transition-all\">\n                  <X size={20} />\n                </button>\n              </div>\n            </motion.div>\n\n            {/* Tab Navigation */}\n            <div className=\"bg-gradient-to-r from-slate-900 via-slate-800 to-slate-900 border-b border-slate-600\">\n              <nav className=\"flex flex-wrap gap-2 px-6 py-4\">\n                {[\n                  { key: 'overview', label: 'Overview', icon: CheckSquare },\n                  { key: 'progress', label: 'Progress', icon: TrendingUp },\n                  { key: 'connections', label: 'Connections', icon: Link2 },\n                  { key: 'details', label: 'Details', icon: FileText }\n                ].map(({ key, label, icon: Icon }) => (\n                  <motion.button\n                    key={key}\n                    onClick={() => {\n                      if (isTabTransitioning) return;\n                      setIsTabTransitioning(true);\n                      setActiveTab(key);\n                      setTimeout(() => setIsTabTransitioning(false), 300);\n                    }}\n                    className={`relative flex items-center gap-2 px-4 py-3 rounded-xl font-medium text-sm transition-all duration-300 ${\n                      activeTab === key\n                        ? 'bg-gradient-to-r from-emerald-500 to-teal-600 text-white shadow-lg shadow-emerald-500/25'\n                        : 'text-slate-300 hover:text-white hover:bg-slate-700/50 hover:shadow-md'\n                    }`}\n                    whileHover={{ scale: activeTab === key ? 1 : 1.02 }}\n                    whileTap={{ scale: 0.98 }}\n                    initial={false}\n                    animate={{\n                      scale: activeTab === key ? 1.05 : 1,\n                      boxShadow: activeTab === key \n                        ? '0 8px 25px rgba(16, 185, 129, 0.3), 0 0 20px rgba(20, 184, 166, 0.2)' \n                        : '0 2px 8px rgba(0, 0, 0, 0.1)'\n                    }}\n                    transition={{ duration: 0.3, ease: \"easeOut\" }}\n                  >\n                    <Icon size={16} className={activeTab === key ? 'drop-shadow-sm' : ''} />\n                    {label}\n                    \n                    {activeTab === key && (\n                      <motion.div\n                        layoutId=\"taskTabGlow\"\n                        className=\"absolute inset-0 bg-gradient-to-r from-emerald-400/20 to-teal-500/20 rounded-xl blur-sm\"\n                        initial={false}\n                        transition={{ type: \"spring\", bounce: 0.2, duration: 0.6 }}\n                      />\n                    )}\n                  </motion.button>\n                ))}\n              </nav>\n            </div>\n            \n            {/* Tab Content */}\n            <motion.div \n              className=\"relative overflow-hidden bg-gradient-to-br from-slate-50 to-slate-100\"\n              layout=\"position\"\n              layoutRoot\n              transition={{ \n                layout: { duration: 0.4, ease: \"easeInOut\" },\n                height: { duration: 0.4, ease: \"easeInOut\" }\n              }}\n            >\n              <AnimatePresence mode=\"wait\" initial={false} onExitComplete={() => setIsTabTransitioning(false)}>\n                {/* Overview Tab */}\n                {activeTab === 'overview' && (\n                  <motion.div\n                    key=\"overview\"\n                    initial={{ opacity: 0, x: -30 }}\n                    animate={{ opacity: 1, x: 0 }}\n                    exit={{ opacity: 0, x: 30 }}\n                    transition={{ duration: 0.4, ease: \"easeOut\" }}\n                    layout=\"position\"\n                    layoutId=\"tabContent\"\n                    className=\"p-6 overflow-y-auto max-h-[calc(85vh-200px)] scrollbar-thin scrollbar-thumb-slate-400 scrollbar-track-slate-200\"\n                  >\n                    <div className=\"space-y-6\">\n                      <div className=\"bg-white rounded-xl p-6 shadow-lg border border-slate-200\">\n                        <h3 className=\"text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2\">\n                          <Target size={20} className=\"text-emerald-600\" />\n                          Task Information\n                        </h3>\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                          {renderField('Title', 'title')}\n                          {renderField('Priority', 'priority', 'select', {\n                            choices: [\n                              { value: 'low', label: 'Low Priority' },\n                              { value: 'medium', label: 'Medium Priority' },\n                              { value: 'high', label: 'High Priority' },\n                              { value: 'urgent', label: 'Urgent' }\n                            ]\n                          })}\n                        </div>\n                        <div className=\"mt-6\">\n                          {renderField('Description', 'description', 'textarea', { rows: 4 })}\n                        </div>\n                      </div>\n                      \n                      <div className=\"bg-white rounded-xl p-6 shadow-lg border border-slate-200\">\n                        <h3 className=\"text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2\">\n                          <Clock size={20} className=\"text-blue-600\" />\n                          Status & Timeline\n                        </h3>\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                          {renderField('Status', 'status', 'select', {\n                            choices: [\n                              { value: 'pending', label: 'Pending' },\n                              { value: 'in_progress', label: 'In Progress' },\n                              { value: 'completed', label: 'Completed' },\n                              { value: 'paused', label: 'Paused' }\n                            ]\n                          })}\n                          {renderField('Due Date', 'due_date', 'date')}\n                        </div>\n                        \n                        {/* Status Change Buttons */}\n                        <div className=\"mt-6\">\n                          <label className=\"block text-sm font-medium text-gray-700 mb-3\">Quick Status Update</label>\n                          <div className=\"flex flex-wrap gap-3\">\n                            {Object.entries(statusConfig).map(([status, config]) => {\n                              const Icon = config.icon;\n                              const isActive = editData.status === status;\n                              return (\n                                <motion.button\n                                  key={status}\n                                  onClick={() => handleStatusChange(status)}\n                                  disabled={!isEditing}\n                                  whileHover={isEditing ? { scale: 1.05 } : {}}\n                                  whileTap={isEditing ? { scale: 0.95 } : {}}\n                                  className={`flex items-center gap-2 px-4 py-2 rounded-lg font-medium text-sm transition-all ${\n                                    isActive\n                                      ? `bg-${config.color}-100 text-${config.color}-800 border-2 border-${config.color}-300`\n                                      : `bg-gray-100 text-gray-600 border-2 border-gray-200 ${isEditing ? 'hover:bg-gray-200' : 'cursor-not-allowed opacity-50'}`\n                                  }`}\n                                >\n                                  <Icon size={16} />\n                                  {config.label}\n                                </motion.button>\n                              );\n                            })}\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  </motion.div>\n                )}\n\n                {/* Progress Tab */}\n                {activeTab === 'progress' && (\n                  <motion.div\n                    key=\"progress\"\n                    initial={{ opacity: 0, x: -30 }}\n                    animate={{ opacity: 1, x: 0 }}\n                    exit={{ opacity: 0, x: 30 }}\n                    transition={{ duration: 0.4, ease: \"easeOut\" }}\n                    layout=\"position\"\n                    layoutId=\"tabContent\"\n                    className=\"p-6 overflow-y-auto max-h-[calc(85vh-200px)] scrollbar-thin scrollbar-thumb-slate-400 scrollbar-track-slate-200\"\n                  >\n                    <div className=\"bg-white rounded-xl p-6 shadow-lg border border-slate-200\">\n                      <h3 className=\"text-lg font-semibold text-slate-800 mb-6 flex items-center gap-2\">\n                        <TrendingUp size={20} className=\"text-blue-600\" />\n                        Task Progress\n                      </h3>\n                      \n                      {/* Status Overview */}\n                      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8\">\n                        <motion.div\n                          whileHover={{ scale: 1.02 }}\n                          className={`p-4 rounded-lg border-2 ${\n                            editData.status === 'completed' \n                              ? 'bg-green-50 border-green-200' \n                              : 'bg-gray-50 border-gray-200'\n                          }`}\n                        >\n                          <div className=\"flex items-center gap-3 mb-2\">\n                            <CheckSquare size={20} className={editData.status === 'completed' ? 'text-green-600' : 'text-gray-400'} />\n                            <span className={`font-medium ${editData.status === 'completed' ? 'text-green-800' : 'text-gray-600'}`}>\n                              Completion\n                            </span>\n                          </div>\n                          <div className={`text-2xl font-bold ${editData.status === 'completed' ? 'text-green-700' : 'text-gray-700'}`}>\n                            {editData.status === 'completed' ? '100%' : '0%'}\n                          </div>\n                        </motion.div>\n                        \n                        <motion.div\n                          whileHover={{ scale: 1.02 }}\n                          className={`p-4 rounded-lg border-2 ${\n                            isOverdue \n                              ? 'bg-red-50 border-red-200' \n                              : 'bg-blue-50 border-blue-200'\n                          }`}\n                        >\n                          <div className=\"flex items-center gap-3 mb-2\">\n                            <Calendar size={20} className={isOverdue ? 'text-red-600' : 'text-blue-600'} />\n                            <span className={`font-medium ${isOverdue ? 'text-red-800' : 'text-blue-800'}`}>\n                              Due Date\n                            </span>\n                          </div>\n                          <div className={`text-lg font-bold ${isOverdue ? 'text-red-700' : 'text-blue-700'}`}>\n                            {editData.due_date ? new Date(editData.due_date).toLocaleDateString() : 'Not set'}\n                          </div>\n                          {isOverdue && (\n                            <div className=\"text-sm text-red-600 mt-1\">Overdue</div>\n                          )}\n                        </motion.div>\n                        \n                        <motion.div\n                          whileHover={{ scale: 1.02 }}\n                          className={`p-4 rounded-lg border-2 ${\n                            editData.priority === 'urgent' || editData.priority === 'high'\n                              ? 'bg-orange-50 border-orange-200'\n                              : 'bg-gray-50 border-gray-200'\n                          }`}\n                        >\n                          <div className=\"flex items-center gap-3 mb-2\">\n                            <Flag size={20} className={\n                              editData.priority === 'urgent' || editData.priority === 'high' \n                                ? 'text-orange-600' \n                                : 'text-gray-600'\n                            } />\n                            <span className={`font-medium ${\n                              editData.priority === 'urgent' || editData.priority === 'high' \n                                ? 'text-orange-800' \n                                : 'text-gray-800'\n                            }`}>\n                              Priority\n                            </span>\n                          </div>\n                          <div className={`text-lg font-bold ${\n                            editData.priority === 'urgent' || editData.priority === 'high' \n                              ? 'text-orange-700' \n                              : 'text-gray-700'\n                          }`}>\n                            {priorityConfig[editData.priority]?.label || 'Not set'}\n                          </div>\n                        </motion.div>\n                      </div>\n                    </div>\n                  </motion.div>\n                )}\n\n                {/* Connections Tab */}\n                {activeTab === 'connections' && (\n                  <motion.div\n                    key=\"connections\"\n                    initial={{ opacity: 0, x: -30 }}\n                    animate={{ opacity: 1, x: 0 }}\n                    exit={{ opacity: 0, x: 30 }}\n                    transition={{ duration: 0.4, ease: \"easeOut\" }}\n                    layout=\"position\"\n                    layoutId=\"tabContent\"\n                    className=\"p-6 overflow-y-auto max-h-[calc(85vh-200px)] scrollbar-thin scrollbar-thumb-slate-400 scrollbar-track-slate-200\"\n                  >\n                    <div className=\"bg-white rounded-xl p-6 shadow-lg border border-slate-200\">\n                      <h3 className=\"text-lg font-semibold text-slate-800 mb-6 flex items-center gap-2\">\n                        <Link2 size={20} className=\"text-indigo-600\" />\n                        Related Content\n                      </h3>\n                      \n                      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                        {renderField('Linked Case ID', 'linked_case_id')}\n                        {renderField('Linked Topic ID', 'linked_topic_id')}\n                      </div>\n                      \n                      <div className=\"mt-8 text-center py-8 text-gray-500\">\n                        <Link2 size={48} className=\"mx-auto mb-3 text-gray-300\" />\n                        <p>No connections found</p>\n                        <p className=\"text-sm mt-1\">Link this task to cases or topics to create connections</p>\n                      </div>\n                    </div>\n                  </motion.div>\n                )}\n\n                {/* Details Tab */}\n                {activeTab === 'details' && (\n                  <motion.div\n                    key=\"details\"\n                    initial={{ opacity: 0, x: -30 }}\n                    animate={{ opacity: 1, x: 0 }}\n                    exit={{ opacity: 0, x: 30 }}\n                    transition={{ duration: 0.4, ease: \"easeOut\" }}\n                    layout=\"position\"\n                    layoutId=\"tabContent\"\n                    className=\"p-6 overflow-y-auto max-h-[calc(85vh-200px)] scrollbar-thin scrollbar-thumb-slate-400 scrollbar-track-slate-200\"\n                  >\n                    <div className=\"bg-white rounded-xl p-6 shadow-lg border border-slate-200\">\n                      <h3 className=\"text-lg font-semibold text-slate-800 mb-6 flex items-center gap-2\">\n                        <FileText size={20} className=\"text-gray-600\" />\n                        Additional Details\n                      </h3>\n                      \n                      <div className=\"space-y-6\">\n                        <div className=\"text-sm text-gray-600 bg-slate-50 p-4 rounded-lg\">\n                          <p className=\"font-medium mb-2\">Task Details</p>\n                          <div className=\"space-y-2\">\n                            <p><span className=\"font-medium\">Created:</span> {data?.created_at ? new Date(data.created_at).toLocaleString() : 'Unknown'}</p>\n                            <p><span className=\"font-medium\">Last Updated:</span> {data?.updated_at ? new Date(data.updated_at).toLocaleString() : 'Unknown'}</p>\n                            <p><span className=\"font-medium\">Task ID:</span> {data?.id || 'Unknown'}</p>\n                          </div>\n                        </div>\n                        \n                        <div className=\"p-4 bg-blue-50 rounded-lg border border-blue-200\">\n                          <h4 className=\"font-medium text-blue-800 mb-2\">Task Management Tips</h4>\n                          <ul className=\"text-blue-700 text-sm space-y-1\">\n                            <li> Break large tasks into smaller, manageable subtasks</li>\n                            <li> Set realistic due dates to maintain accountability</li>\n                            <li> Link tasks to relevant cases or topics for better organization</li>\n                            <li> Update status regularly to track progress</li>\n                          </ul>\n                        </div>\n                      </div>\n                    </div>\n                  </motion.div>\n                )}\n              </AnimatePresence>\n            </motion.div>\n\n            {isEditing && (\n              <div className=\"sticky bottom-0 bg-gray-50 border-t border-gray-200 px-6 py-4 flex items-center justify-between\">\n                <div className=\"text-sm text-gray-500\">\n                  Changes will be auto-saved\n                </div>\n                <div className=\"flex items-center gap-3\">\n                  <button\n                    onClick={() => {\n                      setIsEditing(false);\n                      setEditData({ ...data });\n                    }}\n                    disabled={isLoading}\n                    className=\"px-4 py-2 text-gray-600 hover:text-gray-800 border border-gray-300 rounded-lg hover:bg-gray-100 transition-colors\"\n                  >\n                    Cancel\n                  </button>\n                  <button\n                    onClick={handleSave}\n                    disabled={isLoading}\n                    className=\"px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors flex items-center gap-2\"\n                  >\n                    {isLoading ? <Loader2 size={16} className=\"animate-spin\" /> : <Save size={16} />}\n                    {isLoading ? 'Saving...' : 'Save Changes'}\n                  </button>\n                </div>\n              </div>\n            )}\n          </motion.div>\n        </motion.div>\n      )}\n    </AnimatePresence>\n  );\n};\n\nexport default React.memo(TaskModal, (prevProps, nextProps) => {\n  return (\n    prevProps.isOpen === nextProps.isOpen &&\n    prevProps.data?.id === nextProps.data?.id &&\n    prevProps.data?.updated_at === nextProps.data?.updated_at\n  );\n});\n","// Floating Edge Utilities for React Flow\n// Calculates intersection points between nodes for custom floating edges\n\n/**\n * Calculate the intersection point of a line with a rectangle\n * @param {Object} rect - Rectangle with x, y, width, height\n * @param {Object} center - Center point with x, y\n * @param {Object} point - External point with x, y\n * @returns {Object} Intersection point with x, y coordinates\n */\nfunction getIntersectionPoint(rect, center, point) {\n  const { x: rectX, y: rectY, width, height } = rect;\n  const { x: centerX, y: centerY } = center;\n  const { x: pointX, y: pointY } = point;\n\n  // Calculate rectangle bounds - no buffer as we want exact edges\n  const left = rectX;\n  const right = rectX + width;\n  const top = rectY;\n  const bottom = rectY + height;\n\n  // Direction vector from center to point\n  const dx = pointX - centerX;\n  const dy = pointY - centerY;\n\n  // Handle edge cases where the line is vertical or horizontal\n  if (Math.abs(dx) < 0.001) {\n    // Vertical line\n    return {\n      x: centerX,\n      y: dy > 0 ? bottom : top,\n      side: dy > 0 ? 'bottom' : 'top'\n    };\n  }\n\n  if (Math.abs(dy) < 0.001) {\n    // Horizontal line\n    return {\n      x: dx > 0 ? right : left,\n      y: centerY,\n      side: dx > 0 ? 'right' : 'left'\n    };\n  }\n\n  // Calculate slope and y-intercept\n  const slope = dy / dx;\n  const yIntercept = centerY - slope * centerX;\n\n  // Calculate intersection points with all four sides\n  const intersections = [];\n\n  // Left side (x = left)\n  const leftY = slope * left + yIntercept;\n  if (leftY >= top && leftY <= bottom) {\n    intersections.push({ x: left, y: leftY, side: 'left', distance: Math.hypot(left - centerX, leftY - centerY) });\n  }\n\n  // Right side (x = right)\n  const rightY = slope * right + yIntercept;\n  if (rightY >= top && rightY <= bottom) {\n    intersections.push({ x: right, y: rightY, side: 'right', distance: Math.hypot(right - centerX, rightY - centerY) });\n  }\n\n  // Top side (y = top)\n  const topX = (top - yIntercept) / slope;\n  if (topX >= left && topX <= right) {\n    intersections.push({ x: topX, y: top, side: 'top', distance: Math.hypot(topX - centerX, top - centerY) });\n  }\n\n  // Bottom side (y = bottom)\n  const bottomX = (bottom - yIntercept) / slope;\n  if (bottomX >= left && bottomX <= right) {\n    intersections.push({ x: bottomX, y: bottom, side: 'bottom', distance: Math.hypot(bottomX - centerX, bottom - centerY) });\n  }\n\n  // Find the intersection point that's in the correct direction\n  // and is closest to the center (to avoid picking the wrong side)\n  const validIntersections = intersections.filter(intersection => {\n    const intersectionDx = intersection.x - centerX;\n    const intersectionDy = intersection.y - centerY;\n    \n    // Check if the intersection is in the same direction as the target point\n    return (\n      (dx > 0 && intersectionDx >= 0) || (dx < 0 && intersectionDx <= 0)\n    ) && (\n      (dy > 0 && intersectionDy >= 0) || (dy < 0 && intersectionDy <= 0)\n    );\n  });\n\n  // Sort by distance and take the closest valid intersection\n  validIntersections.sort((a, b) => a.distance - b.distance);\n  return validIntersections[0] || { x: centerX, y: centerY, side: 'center' };\n}\n\n/**\n * Calculate the floating edge path between two nodes\n * @param {Object} sourceNode - Source node with position and measured dimensions\n * @param {Object} targetNode - Target node with position and measured dimensions\n * @param {Object} options - Optional configuration\n * @returns {Object} Edge path data with sourceX, sourceY, targetX, targetY\n */\nexport function getFloatingEdgePath(sourceNode, targetNode, options = {}) {\n  const {\n    sourcePosition = { x: 0, y: 0 },\n    targetPosition = { x: 0, y: 0 },\n    sourceWidth = 200,\n    sourceHeight = 100,\n    targetWidth = 200,\n    targetHeight = 100,\n    // Direct coordinates from React Flow (fallback)\n    sourceX,\n    sourceY,\n    targetX,\n    targetY,\n    offset = 0 // Default to zero offset to ensure edges connect to borders\n  } = options;\n  \n  // Use direct coordinates if provided and dimensions appear invalid\n  if (sourceX !== undefined && sourceY !== undefined && \n      targetX !== undefined && targetY !== undefined &&\n      (sourceWidth <= 10 || targetWidth <= 10)) {\n    return {\n      sourceX, \n      sourceY, \n      targetX, \n      targetY,\n      sourceSide: 'direct',\n      targetSide: 'direct'\n    };\n  }\n\n  // Calculate node centers\n  const sourceCenter = {\n    x: sourcePosition.x + sourceWidth / 2,\n    y: sourcePosition.y + sourceHeight / 2\n  };\n\n  const targetCenter = {\n    x: targetPosition.x + targetWidth / 2,\n    y: targetPosition.y + targetHeight / 2\n  };\n\n  // Create rectangle objects for intersection calculation\n  const sourceRect = {\n    x: sourcePosition.x,\n    y: sourcePosition.y,\n    width: sourceWidth,\n    height: sourceHeight\n  };\n\n  const targetRect = {\n    x: targetPosition.x,\n    y: targetPosition.y,\n    width: targetWidth,\n    height: targetHeight\n  };\n\n  // Calculate intersection points\n  const sourceIntersection = getIntersectionPoint(sourceRect, sourceCenter, targetCenter);\n  const targetIntersection = getIntersectionPoint(targetRect, targetCenter, sourceCenter);\n\n  // Calculate vector from source to target center\n  const dx = targetCenter.x - sourceCenter.x;\n  const dy = targetCenter.y - sourceCenter.y;\n  const distance = Math.sqrt(dx * dx + dy * dy);\n\n  // Add a stronger extension to ensure visual connection with the node borders\n  // This is done by extending the line in both directions\n  if (distance > 0) {\n    const unitX = dx / distance;\n    const unitY = dy / distance;\n    \n    // Extend lines by 3 pixels to ensure visual connection\n    // Using a larger value for more reliability across different node types\n    const extensionAmount = 3;\n\n    // Extend the line outward from the source node\n    sourceIntersection.x -= unitX * extensionAmount;\n    sourceIntersection.y -= unitY * extensionAmount;\n    \n    // Extend the line outward from the target node\n    targetIntersection.x += unitX * extensionAmount;\n    targetIntersection.y += unitY * extensionAmount;\n    \n    // Apply additional offset if needed\n    if (offset > 0) {\n      sourceIntersection.x += unitX * offset;\n      sourceIntersection.y += unitY * offset;\n      targetIntersection.x -= unitX * offset;\n      targetIntersection.y -= unitY * offset;\n    }\n  }\n\n  // Debug flag to help diagnose intersection issues\n  const debug = options.debug || false;\n  if (debug) {\n    console.log('Source Node:', sourceNode);\n    console.log('Target Node:', targetNode);\n    console.log('Source Intersection:', sourceIntersection);\n    console.log('Target Intersection:', targetIntersection);\n  }\n\n  return {\n    sourceX: sourceIntersection.x,\n    sourceY: sourceIntersection.y,\n    targetX: targetIntersection.x,\n    targetY: targetIntersection.y,\n    sourceSide: sourceIntersection.side,\n    targetSide: targetIntersection.side\n  };\n}\n\n/**\n * Generate SVG path string for a bezier curve between two points\n * @param {number} sourceX - Source X coordinate\n * @param {number} sourceY - Source Y coordinate\n * @param {number} targetX - Target X coordinate\n * @param {number} targetY - Target Y coordinate\n * @param {number} curvature - Curve intensity (0-1)\n * @returns {string} SVG path string\n */\nexport function getBezierPath(sourceX, sourceY, targetX, targetY, curvature = 0.25) {\n  const dx = targetX - sourceX;\n  const dy = targetY - sourceY;\n  \n  // Calculate control points for a smooth bezier curve\n  const controlOffset = Math.sqrt(dx * dx + dy * dy) * curvature;\n  \n  const controlX1 = sourceX + dx * 0.5 + dy * controlOffset * 0.5;\n  const controlY1 = sourceY + dy * 0.5 - dx * controlOffset * 0.5;\n  \n  const controlX2 = sourceX + dx * 0.5 - dy * controlOffset * 0.5;\n  const controlY2 = sourceY + dy * 0.5 + dx * controlOffset * 0.5;\n  \n  return `M ${sourceX},${sourceY} C ${controlX1},${controlY1} ${controlX2},${controlY2} ${targetX},${targetY}`;\n}\n\n/**\n * Calculate the center point of an edge path\n * @param {number} sourceX - Source X coordinate\n * @param {number} sourceY - Source Y coordinate\n * @param {number} targetX - Target X coordinate\n * @param {number} targetY - Target Y coordinate\n * @returns {Object} Center point with x, y coordinates\n */\nexport function getEdgeCenter(sourceX, sourceY, targetX, targetY) {\n  return {\n    x: (sourceX + targetX) / 2,\n    y: (sourceY + targetY) / 2\n  };\n}\n\n/**\n * Calculate marker end position for arrow heads\n * @param {number} sourceX - Source X coordinate\n * @param {number} sourceY - Source Y coordinate\n * @param {number} targetX - Target X coordinate\n * @param {number} targetY - Target Y coordinate\n * @returns {string} Transform string for marker positioning\n */\nexport function getMarkerEnd(sourceX, sourceY, targetX, targetY) {\n  const dx = targetX - sourceX;\n  const dy = targetY - sourceY;\n  const angle = Math.atan2(dy, dx) * (180 / Math.PI);\n  \n  return `url(#arrowhead) rotate(${angle} ${targetX} ${targetY})`;\n}\n","import React, { memo, useMemo, useEffect } from 'react';\nimport { BaseEdge, useReactFlow } from '@xyflow/react';\nimport { getFloatingEdgePath } from '../utils/floatingEdgeUtils';\n\n/**\n * High-Performance Floating Edge Component\n * \n * This is an optimized edge component that calculates intersection points\n * between nodes and renders a direct straight line between them. It's \n * specifically designed for immediate visual feedback during node dragging.\n * \n * Features:\n * - Direct path calculation using geometry\n * - Memoized path computation for performance\n * - No transition delays or animations\n * - Minimal re-rendering\n */\nconst FloatingEdge = memo(({\n  id,\n  source,\n  target,\n  sourceX,\n  sourceY,\n  targetX,\n  targetY,\n  sourcePosition,\n  targetPosition,\n  style = {},\n  markerEnd,\n  markerStart,\n  data,\n  ...props\n}) => {\n  const { getNode } = useReactFlow();\n  \n  // Safely get nodes outside of useMemo to avoid scope issues\n  let sourceNode, targetNode;\n  try {\n    sourceNode = getNode(source);\n    targetNode = getNode(target);\n  } catch (error) {\n    // Nodes not available, will use fallback\n    sourceNode = null;\n    targetNode = null;\n  }\n  \n  // Memoize the edge path calculation for better performance\n  const { edgePath, labelX, labelY } = useMemo(() => {\n    // During animations or rapid updates, use simple direct paths\n    if (data?.__isAnimating || data?.__forceUpdate) {\n      return {\n        edgePath: `M${sourceX},${sourceY} L${targetX},${targetY}`,\n        labelX: (sourceX + targetX) / 2,\n        labelY: (sourceY + targetY) / 2\n      };\n    }\n\n    // Default fallback if nodes aren't available\n    if (!sourceNode || !targetNode) {\n      return {\n        edgePath: `M${sourceX},${sourceY} L${targetX},${targetY}`,\n        labelX: (sourceX + targetX) / 2,\n        labelY: (sourceY + targetY) / 2\n      };\n    }\n\n    try {\n      // Safely check if we have enough information to calculate an accurate path\n      const sourceHasDimensions = Boolean(\n        sourceNode.width || \n        sourceNode.dimensions?.width || \n        sourceNode.data?.width || \n        sourceNode.style?.width\n      );\n      \n      const targetHasDimensions = Boolean(\n        targetNode.width || \n        targetNode.dimensions?.width || \n        targetNode.data?.width || \n        targetNode.style?.width\n      );\n      \n      // If we don't have dimensions, use the provided coordinates directly\n      if (!sourceHasDimensions || !targetHasDimensions) {\n        return {\n          edgePath: `M${sourceX},${sourceY} L${targetX},${targetY}`,\n          labelX: (sourceX + targetX) / 2,\n          labelY: (sourceY + targetY) / 2\n        };\n      }\n\n      // Safe dimension extraction with fallbacks\n      const getNodeDimensions = (node) => {\n        const defaultWidth = node.type === 'topic' ? 180 : 200;\n        const defaultHeight = node.type === 'topic' ? 50 : 100;\n        \n        return {\n          width: node.width || \n                 node.dimensions?.width || \n                 node.data?.width || \n                 defaultWidth,\n          height: node.height || \n                  node.dimensions?.height || \n                  node.data?.height || \n                  defaultHeight\n        };\n      };\n      \n      const sourceDims = getNodeDimensions(sourceNode);\n      const targetDims = getNodeDimensions(targetNode);\n\n      // Calculate floating edge with proper intersections\n      const floatingEdgeData = getFloatingEdgePath(\n        sourceNode,\n        targetNode,\n        {\n          // Use React Flow's sourceX/Y and targetX/Y if available\n          sourcePosition: {\n            x: sourceNode.positionAbsolute?.x || sourceNode.position.x,\n            y: sourceNode.positionAbsolute?.y || sourceNode.position.y\n          },\n          targetPosition: {\n            x: targetNode.positionAbsolute?.x || targetNode.position.x,\n            y: targetNode.positionAbsolute?.y || targetNode.position.y\n          },\n          // Fallback coordinates - use the direct ones provided by React Flow\n          sourceX: sourceX,\n          sourceY: sourceY,\n          targetX: targetX,\n          targetY: targetY,\n          sourceWidth: sourceDims.width,\n          sourceHeight: sourceDims.height,\n          targetWidth: targetDims.width,\n          targetHeight: targetDims.height,\n          debug: false // Set to true to debug connection issues\n        }\n      );\n\n      const { \n        sourceX: sx, \n        sourceY: sy, \n        targetX: tx, \n        targetY: ty \n      } = floatingEdgeData;\n      \n      // Return direct line path\n      return {\n        edgePath: `M ${sx},${sy} L ${tx},${ty}`,\n        labelX: (sx + tx) / 2,\n        labelY: (sy + ty) / 2\n      };\n    } catch (error) {\n      console.warn('FloatingEdge calculation error:', error);\n      return {\n        edgePath: `M${sourceX},${sourceY} L${targetX},${targetY}`,\n        labelX: (sourceX + targetX) / 2,\n        labelY: (sourceY + targetY) / 2\n      };\n    }\n  }, [\n    source,\n    target,\n    sourceX, \n    sourceY, \n    targetX, \n    targetY,\n    data?.__forceUpdate,\n    data?.__isAnimating,\n    // Safe node dimension tracking\n    sourceNode?.id,\n    targetNode?.id,\n    sourceNode?.width,\n    sourceNode?.height,\n    targetNode?.width,\n    targetNode?.height\n  ]);\n\n  return (\n    <BaseEdge\n      id={id}\n      path={edgePath}\n      labelX={labelX}\n      labelY={labelY}\n      style={{\n        stroke: '#64748b',\n        strokeWidth: 3, // Thicker line for better visibility\n        strokeLinecap: 'round', // Round ends for smoother appearance\n        strokeOpacity: 0.95, // Slightly more opaque\n        transition: 'none', // Critical: disable all CSS transitions\n        ...style\n      }}\n      markerEnd={markerEnd}\n      markerStart={markerStart}\n      // Remove {...props} to prevent React Flow-specific props from reaching DOM\n    />\n  );\n}, (prevProps, nextProps) => {\n  // Optimize re-rendering with precise dependency checking\n  return (\n    prevProps.sourceX === nextProps.sourceX &&\n    prevProps.sourceY === nextProps.sourceY &&\n    prevProps.targetX === nextProps.targetX &&\n    prevProps.targetY === nextProps.targetY &&\n    prevProps.source === nextProps.source &&\n    prevProps.target === nextProps.target &&\n    prevProps.data?.__forceUpdate === nextProps.data?.__forceUpdate\n  );\n});\n\nexport default FloatingEdge;\n\n\n","import React, { memo } from 'react';\nimport { BaseEdge, getBezierPath, EdgeLabelRenderer } from '@xyflow/react';\n\n/**\n * Enhanced Edge Component with Label Support\n * \n * This edge component supports labels and uses proper prop destructuring\n * to prevent React Flow-specific props from reaching DOM elements.\n */\nconst EnhancedEdge = memo(({\n  id,\n  source,\n  target,\n  sourceX,\n  sourceY,\n  targetX,\n  targetY,\n  sourcePosition,\n  targetPosition,\n  style = {},\n  markerEnd,\n  markerStart,\n  label,\n  // Destructure React Flow-specific props to prevent them from reaching DOM\n  sourceHandleId,\n  targetHandleId,\n  data,\n  selected,\n  animated,\n  // Don't pass any other props to BaseEdge\n}) => {\n  const [edgePath, labelX, labelY] = getBezierPath({\n    sourceX,\n    sourceY,\n    sourcePosition,\n    targetX,\n    targetY,\n    targetPosition,\n  });\n\n  return (\n    <>\n      <BaseEdge\n        id={id}\n        path={edgePath}\n        style={style}\n        markerEnd={markerEnd}\n        markerStart={markerStart}\n        // Only pass valid BaseEdge props, no React Flow-specific props\n      />\n      {label && (\n        <EdgeLabelRenderer>\n          <div\n            style={{\n              position: 'absolute',\n              transform: `translate(-50%, -50%) translate(${labelX}px,${labelY}px)`,\n              fontSize: 12,\n              pointerEvents: 'all',\n            }}\n            className=\"nodrag nopan bg-white px-2 py-1 rounded shadow border text-xs\"\n          >\n            {label}\n          </div>\n        </EdgeLabelRenderer>\n      )}\n    </>\n  );\n});\n\nEnhancedEdge.displayName = 'EnhancedEdge';\n\nexport default EnhancedEdge;\n","import React from 'react';\n\n/**\n * Custom connection line component for React Flow.\n * Shows a preview of the connection as the user drags to create a new edge.\n * Styled to match our floating edge appearance but with enhanced visual feedback.\n */\nconst ConnectionLine = ({\n  fromX,\n  fromY,\n  toX,\n  toY,\n  connectionLineStyle,\n}) => {\n  // Create a straight path from source to target\n  const path = `M ${fromX},${fromY} L ${toX},${toY}`;\n  \n  // Apply our custom styling combined with any passed styling\n  const defaultStyle = {\n    stroke: '#3b82f6', // Bright blue for visibility\n    strokeWidth: 3.5,\n    strokeLinecap: 'round',\n    strokeDasharray: '5,3', \n    filter: 'drop-shadow(0 0 6px rgba(59, 130, 246, 0.6))',\n    animation: 'flowingDash 1s linear infinite',\n  };\n\n  // Merge the default style with any props passed in\n  const style = { ...defaultStyle, ...connectionLineStyle };\n\n  return (\n    <g>\n      {/* Main visible connection line */}\n      <path\n        d={path}\n        fill=\"none\"\n        style={style}\n      />\n      \n      {/* Larger invisible path for easier interaction */}\n      <path\n        d={path}\n        fill=\"none\"\n        stroke=\"transparent\"\n        strokeWidth={15}\n        style={{ pointerEvents: 'stroke' }}\n      />\n    </g>\n  );\n};\n\nexport default ConnectionLine;\n","// Optimized loading screen component\nimport React from 'react';\nimport { Loader2, Brain, Sparkles } from 'lucide-react';\n\nconst OptimizedLoadingScreen = ({ message = \"Loading your mind map...\", progress = null }) => {\n  return (\n    <div className=\"fixed inset-0 bg-gradient-to-br from-blue-50 to-purple-50 flex items-center justify-center z-50\">\n      <div className=\"text-center\">\n        {/* Animated brain icon */}\n        <div className=\"relative mb-6\">\n          <Brain className=\"w-16 h-16 text-blue-600 mx-auto animate-pulse\" />\n          <Sparkles className=\"w-6 h-6 text-purple-500 absolute -top-2 -right-2 animate-bounce\" />\n        </div>\n        \n        {/* Loading spinner */}\n        <div className=\"flex items-center justify-center gap-3 mb-4\">\n          <Loader2 className=\"w-6 h-6 animate-spin text-blue-600\" />\n          <span className=\"text-lg font-medium text-gray-700\">{message}</span>\n        </div>\n        \n        {/* Progress bar if provided */}\n        {progress !== null && (\n          <div className=\"w-64 bg-gray-200 rounded-full h-2 mx-auto mb-2\">\n            <div \n              className=\"bg-blue-600 h-2 rounded-full transition-all duration-300 ease-out\" \n              style={{ width: `${Math.max(0, Math.min(100, progress))}%` }}\n            />\n          </div>\n        )}\n        \n        {/* Helpful tips during loading */}\n        <div className=\"text-sm text-gray-500 max-w-md mx-auto mt-4\">\n          <p> Tip: Use the force layout button to auto-arrange your nodes</p>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default OptimizedLoadingScreen;\n","// Performance optimizations for mind map rendering\nimport { useMemo, useCallback } from 'react';\n\n// Memoized node data to prevent unnecessary re-renders\nexport const useMemoizedNodeData = (data, dependencies = []) => {\n  return useMemo(() => data, dependencies);\n};\n\n// Throttled layout calculation to prevent excessive computations\nexport const useThrottledLayout = (layoutFunction, delay = 100) => {\n  return useCallback(\n    throttle(layoutFunction, delay),\n    [layoutFunction, delay]\n  );\n};\n\n// Throttle function implementation\nfunction throttle(func, delay) {\n  let timeoutId;\n  let lastExecTime = 0;\n  \n  return function (...args) {\n    const currentTime = Date.now();\n    \n    if (currentTime - lastExecTime > delay) {\n      func.apply(this, args);\n      lastExecTime = currentTime;\n    } else {\n      clearTimeout(timeoutId);\n      timeoutId = setTimeout(() => {\n        func.apply(this, args);\n        lastExecTime = Date.now();\n      }, delay - (currentTime - lastExecTime));\n    }\n  };\n}\n\n// Optimized data conversion with chunking for large datasets\nexport const convertDataInChunks = (data, chunkSize = 50) => {\n  return new Promise((resolve) => {\n    const chunks = [];\n    const allItems = [\n      ...data.topics.map(item => ({ ...item, type: 'topic' })),\n      ...data.cases.map(item => ({ ...item, type: 'case' })),\n      ...data.tasks.map(item => ({ ...item, type: 'task' })),\n      ...data.literature.map(item => ({ ...item, type: 'literature' }))\n    ];\n    \n    for (let i = 0; i < allItems.length; i += chunkSize) {\n      chunks.push(allItems.slice(i, i + chunkSize));\n    }\n    \n    resolve(chunks);\n  });\n};\n\n// Fast initial layout without force simulation\nexport const getQuickLayout = (nodes) => {\n  const gridSize = Math.ceil(Math.sqrt(nodes.length));\n  const nodeSpacing = 200;\n  \n  return nodes.map((node, index) => ({\n    ...node,\n    position: {\n      x: (index % gridSize) * nodeSpacing,\n      y: Math.floor(index / gridSize) * nodeSpacing\n    }\n  }));\n};\n\n// Memory-efficient edge creation\nexport const createOptimizedEdges = (connections, nodeIds) => {\n  const nodeIdSet = new Set(nodeIds);\n  \n  return connections\n    .filter(conn => nodeIdSet.has(conn.source) && nodeIdSet.has(conn.target))\n    .map(conn => ({\n      id: conn.id,\n      source: conn.source,\n      target: conn.target,\n      label: conn.label,\n      type: 'floating',\n      style: {\n        strokeWidth: 2,\n        stroke: '#64748b',\n        opacity: 0.85\n      },\n      animated: false,\n      updatable: true\n    }));\n};\n","// Sample literature data for testing the enhanced Literature modal\nexport const sampleLiteratureData = [\n  {\n    id: 1,\n    title: \"Efficacy of Cognitive Behavioral Therapy for Depression: A Meta-Analysis\",\n    authors: \"Smith, J.A., Johnson, B.K., Williams, C.D.\",\n    year: \"2023\",\n    type: \"meta-analysis\",\n    journal: \"Journal of Clinical Psychology\",\n    volume: \"79\",\n    pages: \"234-251\",\n    doi: \"10.1002/jclp.23456\",\n    abstract: \"This meta-analysis examines the efficacy of cognitive behavioral therapy (CBT) for treating major depressive disorder across 45 randomized controlled trials involving 3,242 participants. Results indicate that CBT shows significant effectiveness with a large effect size (d = 0.85) compared to control conditions. The analysis also reveals that individual CBT may be more effective than group CBT for severe depression cases.\",\n    keywords: \"cognitive behavioral therapy, depression, meta-analysis, psychotherapy, mental health\",\n    notes: \"\",\n    pdf_url: \"https://example.com/sample-cbt-meta-analysis.pdf\",\n    position: { x: 300, y: 100 }\n  },\n  {\n    id: 2,\n    title: \"DSM-5-TR Clinical Cases\",\n    authors: \"American Psychiatric Association\",\n    year: \"2022\",\n    type: \"guideline\",\n    journal: \"American Psychiatric Publishing\",\n    abstract: \"A comprehensive collection of clinical cases that illustrate the diagnostic criteria and clinical features of mental disorders as defined in the DSM-5-TR. Each case includes detailed patient presentations, differential diagnoses, and treatment considerations.\",\n    keywords: \"DSM-5, diagnosis, clinical cases, psychiatric disorders, differential diagnosis\",\n    notes: \"Essential reference for diagnostic clarity\",\n    position: { x: 500, y: 200 }\n  },\n  {\n    id: 3,\n    title: \"Pharmacological Treatment of Bipolar Disorder: Current Evidence\",\n    authors: \"Rodriguez, M.L., Chen, K.H., Anderson, P.R.\",\n    year: \"2023\",\n    type: \"review\",\n    journal: \"Bipolar Disorders\",\n    volume: \"25\",\n    pages: \"123-145\",\n    doi: \"10.1111/bdi.13289\",\n    abstract: \"This comprehensive review examines current evidence for pharmacological treatments of bipolar disorder, including mood stabilizers, antipsychotics, and adjunctive therapies. The review covers efficacy, safety profiles, and treatment-resistant cases.\",\n    keywords: \"bipolar disorder, pharmacotherapy, mood stabilizers, lithium, antipsychotics\",\n    notes: \"Important for medication management decisions\",\n    position: { x: 700, y: 150 }\n  },\n  {\n    id: 4,\n    title: \"Mindfulness-Based Interventions for Anxiety Disorders: A Systematic Review\",\n    authors: \"Taylor, S.M., Brown, A.J., Davis, L.K.\",\n    year: \"2023\",\n    type: \"review\",\n    journal: \"Clinical Psychology Review\",\n    volume: \"88\",\n    pages: \"102-118\",\n    abstract: \"Systematic review of mindfulness-based interventions for treating various anxiety disorders. Analysis of 28 studies shows moderate to large effect sizes for reducing anxiety symptoms, with particular effectiveness for generalized anxiety disorder.\",\n    keywords: \"mindfulness, anxiety disorders, meditation, systematic review, GAD\",\n    notes: \"Good evidence for mindfulness approaches\",\n    position: { x: 400, y: 300 }\n  },\n  {\n    id: 5,\n    title: \"Case Study: Treatment-Resistant Schizophrenia with Clozapine\",\n    authors: \"Wilson, K.R., Martinez, E.S.\",\n    year: \"2022\",\n    type: \"case-study\",\n    journal: \"Schizophrenia Bulletin\",\n    volume: \"48\",\n    pages: \"567-572\",\n    abstract: \"Detailed case study of a 28-year-old male with treatment-resistant schizophrenia who showed significant improvement after clozapine initiation. The case discusses monitoring protocols, side effect management, and long-term outcomes.\",\n    keywords: \"schizophrenia, clozapine, treatment-resistant, case study, antipsychotics\",\n    notes: \"Useful for understanding clozapine protocols\",\n    position: { x: 600, y: 400 }\n  }\n];\n\n// Sample connections between literature and other nodes\nexport const sampleConnections = [\n  {\n    id: \"conn-1\",\n    source: \"literature-1\",\n    target: \"case-101\", // Depression case\n    label: \"Treatment approach\"\n  },\n  {\n    id: \"conn-2\", \n    source: \"literature-2\",\n    target: \"topic-201\", // Diagnostic criteria topic\n    label: \"Reference guide\"\n  },\n  {\n    id: \"conn-3\",\n    source: \"literature-3\",\n    target: \"case-102\", // Bipolar case\n    label: \"Medication guidance\"\n  },\n  {\n    id: \"conn-4\",\n    source: \"literature-4\",\n    target: \"case-103\", // Anxiety case\n    label: \"Treatment option\"\n  },\n  {\n    id: \"conn-5\",\n    source: \"literature-5\",\n    target: \"case-104\", // Schizophrenia case\n    label: \"Treatment protocol\"\n  }\n];\n\n// Enhanced literature node factory\nexport const createLiteratureNode = (data) => ({\n  ...data,\n  label: data.title || 'Literature Item',\n  created_at: new Date().toISOString(),\n  updated_at: new Date().toISOString()\n});\n","// Utility to populate sample literature data for testing\nimport { sampleLiteratureData, sampleConnections } from '../data/sampleLiteratureData';\n\nexport const populateSampleLiteratureData = (setMindMapData, autoSaveMindMapData, addToast) => {\n  setMindMapData(prevData => {\n    // Add sample literature items if they don't already exist\n    const existingIds = new Set(prevData.literature.map(item => item.id));\n    const newLiterature = sampleLiteratureData.filter(item => !existingIds.has(item.id));\n    \n    if (newLiterature.length === 0) {\n      addToast('Sample literature data already exists', 'info');\n      return prevData;\n    }\n\n    // Create sample case and topic nodes to connect with literature\n    const sampleCases = [\n      {\n        id: 101,\n        label: 'Major Depression Case',\n        primary_diagnosis: 'Major Depressive Disorder',\n        chief_complaint: 'Persistent sadness and loss of interest',\n        secondary_diagnoses: ['Anxiety', 'Insomnia'],\n        position: { x: 100, y: 100 }\n      },\n      {\n        id: 102,\n        label: 'Bipolar Disorder Case', \n        primary_diagnosis: 'Bipolar I Disorder',\n        chief_complaint: 'Mood swings and impulsivity',\n        position: { x: 200, y: 200 }\n      },\n      {\n        id: 103,\n        label: 'Generalized Anxiety Case',\n        primary_diagnosis: 'Generalized Anxiety Disorder',\n        chief_complaint: 'Excessive worry and restlessness',\n        position: { x: 300, y: 300 }\n      },\n      {\n        id: 104,\n        label: 'Schizophrenia Case',\n        primary_diagnosis: 'Schizophrenia',\n        chief_complaint: 'Auditory hallucinations and delusions',\n        position: { x: 400, y: 400 }\n      }\n    ];\n\n    const sampleTopics = [\n      {\n        id: 201,\n        title: 'Diagnostic Criteria',\n        category: 'Assessment',\n        tags: ['DSM-5', 'diagnosis', 'criteria'],\n        position: { x: 150, y: 50 }\n      }\n    ];\n\n    // Filter out existing cases and topics\n    const existingCaseIds = new Set(prevData.cases.map(item => item.id));\n    const existingTopicIds = new Set(prevData.topics.map(item => item.id));\n    \n    const newCases = sampleCases.filter(item => !existingCaseIds.has(item.id));\n    const newTopics = sampleTopics.filter(item => !existingTopicIds.has(item.id));\n\n    // Add sample connections\n    const existingConnectionIds = new Set(prevData.connections.map(conn => conn.id));\n    const newConnections = sampleConnections.filter(conn => !existingConnectionIds.has(conn.id));\n\n    const updatedData = {\n      ...prevData,\n      literature: [...prevData.literature, ...newLiterature],\n      cases: [...prevData.cases, ...newCases],\n      topics: [...prevData.topics, ...newTopics],\n      connections: [...prevData.connections, ...newConnections]\n    };\n\n    // Save the updated data\n    autoSaveMindMapData(updatedData);\n    addToast(`Added ${newLiterature.length} literature items, ${newCases.length} cases, and ${newTopics.length} topics`, 'success');\n    \n    return updatedData;\n  });\n};\n\nexport const clearSampleData = (setMindMapData, autoSaveMindMapData, addToast) => {\n  setMindMapData(prevData => {\n    // Remove sample data based on IDs\n    const sampleLiteratureIds = new Set(sampleLiteratureData.map(item => item.id));\n    const sampleConnectionIds = new Set(sampleConnections.map(conn => conn.id));\n    const sampleCaseIds = new Set([101, 102, 103, 104]);\n    const sampleTopicIds = new Set([201]);\n\n    const updatedData = {\n      ...prevData,\n      literature: prevData.literature.filter(item => !sampleLiteratureIds.has(item.id)),\n      cases: prevData.cases.filter(item => !sampleCaseIds.has(item.id)),\n      topics: prevData.topics.filter(item => !sampleTopicIds.has(item.id)),\n      connections: prevData.connections.filter(conn => !sampleConnectionIds.has(conn.id))\n    };\n\n    autoSaveMindMapData(updatedData);\n    addToast('Sample literature data cleared', 'success');\n    \n    return updatedData;\n  });\n};\n","import React, { useState, useEffect, useCallback, useRef, useMemo, Suspense, lazy } from 'react';\nimport '@xyflow/react/dist/style.css';\nimport './App.css';\nimport axios from 'axios';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport {\n  ReactFlow,\n  addEdge,\n  Background,\n  Controls,\n  MiniMap,\n  useNodesState,\n  useEdgesState,\n  ReactFlowProvider,\n  Panel,\n  Handle,\n  Position,\n  useReactFlow,\n} from '@xyflow/react';\n\n// Lazy load heavy D3 dependencies\nconst loadD3Force = () => import('d3-force');\nconst loadDagre = () => import('dagre');\n\nimport {\n  Plus,\n  Brain,\n  Users,\n  CheckSquare,\n  Edit3,\n  Save,\n  ArrowLeft,\n  FileText,\n  Calendar,\n  Target,\n  BookOpen,\n  Trash2,\n  X,\n  Shuffle,\n  Download,\n  Cloud,\n  CheckCircle,\n  Tag,\n  Clock,\n  AlertCircle,\n  Info,\n  Star,\n  Zap,\n  Settings,\n  Eye,\n  Upload,\n  Bell,\n  CheckCircle2,\n  Loader2,\n  Sparkles,\n  Search, // Added for global search functionality\n  Heart,\n  Bookmark,\n  User,\n  Clipboard,\n  StickyNote,\n  Paperclip,\n  ChevronDown,\n  ChevronUp,\n  ArrowDown\n} from 'lucide-react';\n\n// Lazy load components for better initial load time\nimport { RichTextEditor, TemplateManager, LiteratureModal } from './components/LazyComponents';\nimport CaseModal from './components/CaseModal';\nimport TopicModal from './components/TopicModal';\nimport TaskModal from './components/TaskModal';\nimport FloatingEdge from './components/FloatingEdge'; // Import the custom FloatingEdge component\nimport EnhancedEdge from './components/EnhancedEdge'; // Import the enhanced edge component\nimport ConnectionLine from './components/ConnectionLine'; // Import the custom connection line for previews\nimport OptimizedLoadingScreen from './components/OptimizedLoadingScreen';\n\n// Import performance utilities\nimport { \n  useMemoizedNodeData, \n  convertDataInChunks, \n  getQuickLayout, \n  createOptimizedEdges \n} from './utils/performanceUtils';\nimport { populateSampleLiteratureData, clearSampleData } from './utils/sampleDataUtils';\n\n// Use the environment variable for the backend URL, but provide a fallback\n// to the local server for development. This is a more robust pattern.\n// The .replace() call removes any trailing slashes to prevent \"404 Not Found\"\n// errors caused by double slashes in the request path (e.g., \"//api/\").\nconst BACKEND_URL = (process.env.REACT_APP_BACKEND_URL || 'http://localhost:8000').replace(/\\/$/, '');\nconst API = `${BACKEND_URL}/api`;\n\n// Fix ResizeObserver error that prevents React Flow from working\nconst debounce = (func, wait) => {\n  let timeout;\n  return function executedFunction(...args) {\n    const later = () => {\n      clearTimeout(timeout);\n      func(...args);\n    };\n    clearTimeout(timeout);\n    timeout = setTimeout(later, wait);\n  };\n};\n\n// Suppress ResizeObserver errors that don't affect functionality\nconst originalError = console.error;\nconsole.error = (...args) => {\n  if (args[0] && args[0].includes && args[0].includes('ResizeObserver loop')) {\n    return;\n  }\n  originalError(...args);\n};\n\n// Toast Notification System\nconst Toast = ({ message, type = 'success', onClose, duration = 3000 }) => {\n  useEffect(() => {\n    const timer = setTimeout(onClose, duration);\n    return () => clearTimeout(timer);\n  }, [onClose, duration]);\n\n  const getToastStyles = () => {\n    const baseStyles = \"fixed top-4 right-4 z-50 px-6 py-3 rounded-lg shadow-lg transition-all duration-500 transform\";\n    const typeStyles = {\n      success: \"bg-green-600 text-white border-l-4 border-green-400\",\n      error: \"bg-red-600 text-white border-l-4 border-red-400\",\n      info: \"bg-blue-600 text-white border-l-4 border-blue-400\",\n      saving: \"bg-purple-600 text-white border-l-4 border-purple-400\"\n    };\n    return `${baseStyles} ${typeStyles[type]}`;\n  };\n\n  const getIcon = () => {\n    switch (type) {\n      case 'success': return <CheckCircle2 size={16} className=\"mr-2\" />;\n      case 'error': return <AlertCircle size={16} className=\"mr-2\" />;\n      case 'info': return <Info size={16} className=\"mr-2\" />;\n      case 'saving': return <Loader2 size={16} className=\"mr-2 animate-spin\" />;\n      default: return <CheckCircle2 size={16} className=\"mr-2\" />;\n    }\n  };\n\n  return (\n    <div className={getToastStyles()}>\n      <div className=\"flex items-center\">\n        {getIcon()}\n        <span className=\"text-sm font-medium\">{message}</span>\n        <button\n          onClick={onClose}\n          className=\"ml-4 text-white hover:text-gray-200 transition-colors\"\n        >\n          <X size={14} />\n        </button>\n      </div>\n    </div>\n  );\n};\n\n// Enhanced Loading Button Component\nconst LoadingButton = ({ onClick, loading, disabled, children, className, icon: Icon, ...props }) => {\n  return (\n    <button\n      onClick={onClick}\n      disabled={disabled || loading}\n      className={`${className} transform transition-all duration-200 hover:scale-105 active:scale-95 ${disabled || loading ? 'cursor-not-allowed opacity-50' : 'hover:shadow-lg'\n        }`}\n      {...props}\n    >\n      <div className=\"flex items-center gap-2\">\n        {loading ? (\n          <Loader2 size={16} className=\"animate-spin\" />\n        ) : Icon ? (\n          <Icon size={16} />\n        ) : null}\n        {children}\n      </div>\n    </button>\n  );\n};\n\n// localStorage utilities with enhanced feedback\nconst STORAGE_KEY = 'pgy3_mindmap_data';\nconst STORAGE_VERSION = '1.1';\n\nconst localStorageUtils = {\n  // Save data to localStorage with debouncing and callback for UI feedback\n  save: (() => {\n    let timeoutId;\n    return (data, onSaveStart, onSaveComplete, isAnimating = false) => {\n      clearTimeout(timeoutId);\n\n      if (onSaveStart) onSaveStart();\n\n      // Increase debounce delay during animations\n      const debounceDelay = isAnimating ? 1200 : 800;\n\n      timeoutId = setTimeout(() => {\n        try {\n          const storageData = {\n            version: STORAGE_VERSION,\n            timestamp: new Date().toISOString(),\n            data: data\n          };\n          localStorage.setItem(STORAGE_KEY, JSON.stringify(storageData));\n          console.log('Mind map data auto-saved to localStorage');\n          if (onSaveComplete) onSaveComplete(true);\n        } catch (error) {\n          console.error('Error saving to localStorage:', error);\n          if (onSaveComplete) onSaveComplete(false, error);\n\n          if (error.name === 'QuotaExceededError') {\n            console.warn('localStorage quota exceeded, clearing old data...');\n            try {\n              localStorage.removeItem(STORAGE_KEY);\n            } catch (clearError) {\n              console.error('Error clearing localStorage:', clearError);\n            }\n          }\n        }\n      }, debounceDelay); // Variable debounce delay\n    };\n  })(),\n\n  // Load data from localStorage\n  load: () => {\n    try {\n      const stored = localStorage.getItem(STORAGE_KEY);\n      if (!stored) {\n        console.log('No localStorage data found');\n        return null;\n      }\n\n      const storageData = JSON.parse(stored);\n\n      // Version check\n      if (storageData.version !== STORAGE_VERSION) {\n        console.log('localStorage version mismatch, clearing old data');\n        localStorage.removeItem(STORAGE_KEY);\n        return null;\n      }\n\n      console.log('Mind map data loaded from localStorage', storageData.timestamp);\n      return storageData.data;\n    } catch (error) {\n      console.error('Error loading from localStorage:', error);\n      // Clear corrupted data\n      try {\n        localStorage.removeItem(STORAGE_KEY);\n      } catch (clearError) {\n        console.error('Error clearing corrupted localStorage:', clearError);\n      }\n      return null;\n    }\n  },\n\n  // Clear stored data\n  clear: () => {\n    try {\n      localStorage.removeItem(STORAGE_KEY);\n      console.log('localStorage data cleared');\n    } catch (error) {\n      console.error('Error clearing localStorage:', error);\n    }\n  },\n\n  // Get storage info\n  getStorageInfo: () => {\n    try {\n      const stored = localStorage.getItem(STORAGE_KEY);\n      if (!stored) return null;\n\n      const data = JSON.parse(stored);\n      return {\n        version: data.version,\n        timestamp: data.timestamp,\n        size: new Blob([stored]).size\n      };\n    } catch (error) {\n      return null;\n    }\n  }\n};\n\n// Enhanced CSV export utilities\nconst csvUtils = {\n  generatePatientCasesCSV: (cases, onProgress) => {\n    if (!cases || cases.length === 0) {\n      return '';\n    }\n\n    if (onProgress) onProgress(10, 'Preparing headers...');\n\n    // Enhanced CSV headers with more detailed information\n    const headers = [\n      'Case ID',\n      'Encounter Date',\n      'Primary Diagnosis',\n      'Secondary Diagnoses',\n      'Age',\n      'Gender',\n      'Chief Complaint',\n      'History of Present Illness',\n      'Medical History',\n      'Medications',\n      'Mental Status Exam',\n      'Assessment & Plan',\n      'Status',\n      'Notes',\n      'Created Date',\n      'Updated Date',\n      'Linked Topics Count',\n      'Last Modified By'\n    ];\n\n    if (onProgress) onProgress(30, 'Processing case data...');\n\n    // Convert cases to CSV rows with enhanced data\n    const rows = cases.map((caseItem, index) => {\n      if (onProgress) onProgress(30 + (index / cases.length) * 50, `Processing case ${index + 1}/${cases.length}...`);\n\n      return [\n        caseItem.case_id || '',\n        caseItem.encounter_date ? new Date(caseItem.encounter_date).toLocaleDateString() : '',\n        caseItem.primary_diagnosis || '',\n        Array.isArray(caseItem.secondary_diagnoses) ? caseItem.secondary_diagnoses.join('; ') : '',\n        caseItem.age || '',\n        caseItem.gender || '',\n        caseItem.chief_complaint || '',\n        caseItem.history_present_illness || '',\n        caseItem.medical_history || '',\n        Array.isArray(caseItem.medications) ? caseItem.medications.join('; ') : '',\n        caseItem.mental_status_exam || '',\n        caseItem.assessment_plan || '',\n        caseItem.status || '',\n        caseItem.notes || '',\n        caseItem.created_at ? new Date(caseItem.created_at).toLocaleDateString() : '',\n        caseItem.updated_at ? new Date(caseItem.updated_at).toLocaleDateString() : '',\n        Array.isArray(caseItem.linked_topics) ? caseItem.linked_topics.length : '0',\n        'PGY-3 System'\n      ];\n    });\n\n    if (onProgress) onProgress(85, 'Formatting CSV content...');\n\n    // Escape CSV values and join\n    const escapeCsvValue = (value) => {\n      const stringValue = String(value);\n      if (stringValue.includes(',') || stringValue.includes('\"') || stringValue.includes('\\n')) {\n        return `\"${stringValue.replace(/\"/g, '\"\"')}\"`;\n      }\n      return stringValue;\n    };\n\n    const csvContent = [\n      headers.map(escapeCsvValue).join(','),\n      ...rows.map(row => row.map(escapeCsvValue).join(','))\n    ].join('\\n');\n\n    if (onProgress) onProgress(100, 'CSV generation complete!');\n\n    return csvContent;\n  },\n\n  downloadCSV: (csvContent, filename = 'patient_cases.csv') => {\n    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\n    const link = document.createElement('a');\n    const url = URL.createObjectURL(blob);\n\n    link.setAttribute('href', url);\n    link.setAttribute('download', filename);\n    link.style.visibility = 'hidden';\n\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n\n    URL.revokeObjectURL(url);\n  },\n\n  // Generate summary statistics\n  generateCasesSummary: (cases) => {\n    if (!cases || cases.length === 0) return null;\n\n    const diagnoses = {};\n    const statuses = {};\n    const ageGroups = { '18-30': 0, '31-50': 0, '51-70': 0, '70+': 0, 'Unknown': 0 };\n    const genders = {};\n\n    cases.forEach(caseItem => {\n      // Diagnoses\n      if (caseItem.primary_diagnosis) {\n        diagnoses[caseItem.primary_diagnosis] = (diagnoses[caseItem.primary_diagnosis] || 0) + 1;\n      }\n\n      // Status\n      if (caseItem.status) {\n        statuses[caseItem.status] = (statuses[caseItem.status] || 0) + 1;\n      }\n\n      // Age groups\n      if (caseItem.age) {\n        if (caseItem.age <= 30) ageGroups['18-30']++;\n        else if (caseItem.age <= 50) ageGroups['31-50']++;\n        else if (caseItem.age <= 70) ageGroups['51-70']++;\n        else ageGroups['70+']++;\n      } else {\n        ageGroups['Unknown']++;\n      }\n\n      // Gender\n      if (caseItem.gender) {\n        genders[caseItem.gender] = (genders[caseItem.gender] || 0) + 1;\n      }\n    });\n\n    return {\n      totalCases: cases.length,\n      diagnoses,\n      statuses,\n      ageGroups,\n      genders\n    };\n  }\n};\n\n// Enhanced Custom Node Components with better visual effects and data\nconst TopicNode = ({ data, selected }) => {\n  const [isVisible, setIsVisible] = useState(data.skipAnimation || false);\n  \n  // Entry animation - only if not skipping animations\n  useEffect(() => {\n    if (!data.skipAnimation) {\n      const timer = setTimeout(() => setIsVisible(true), 100);\n      return () => clearTimeout(timer);\n    }\n  }, [data.skipAnimation]);\n\n  const completionPercentage = data.flashcard_count > 0\n    ? ((data.completed_flashcards || 0) / data.flashcard_count) * 100\n    : 0;\n\n  return (\n    <div\n      className={`group px-4 py-3 rounded-xl shadow-lg border-2 transition-all duration-700 min-w-[220px] relative hover:shadow-2xl transform hover:scale-105 backdrop-blur-sm ${selected\n          ? 'border-teal-400 shadow-xl scale-105 ring-4 ring-teal-200 animate-pulse'\n          : 'border-transparent hover:border-teal-300 hover:ring-2 hover:ring-teal-100'\n        } ${isVisible ? 'opacity-100 scale-100 translate-y-0' : 'opacity-0 scale-75 translate-y-8'}`}\n      style={{\n        backgroundColor: data.color || '#3B82F6',\n        color: 'white',\n        boxShadow: selected\n          ? `0 0 20px ${data.color || '#3B82F6'}40`\n          : `0 4px 20px ${data.color || '#3B82F6'}20`,\n        transition: 'all 0.7s cubic-bezier(0.34, 1.56, 0.64, 1), transform 0.3s ease'\n      }}\n    >\n      {/* Connection Hotspots - Stacked source and target handles for all four sides */}\n      {/* Top handles */}\n      <Handle\n        id=\"top\"\n        type=\"source\"\n        position={Position.Top}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          left: '50%',\n          transform: 'translateX(-50%)',\n          zIndex: 2\n        }}\n        isConnectable={true}\n      />\n      <Handle\n        id=\"top\"\n        type=\"target\"\n        position={Position.Top}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          left: '50%',\n          transform: 'translateX(-50%)',\n          zIndex: 1\n        }}\n        isConnectable={true}\n      />\n\n      {/* Right handles */}\n      <Handle\n        id=\"right\"\n        type=\"source\"\n        position={Position.Right}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          top: '50%',\n          transform: 'translateY(-50%)',\n          zIndex: 2\n        }}\n        isConnectable={true}\n      />\n      <Handle\n        id=\"right\"\n        type=\"target\"\n        position={Position.Right}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          top: '50%',\n          transform: 'translateY(-50%)',\n          zIndex: 1\n        }}\n        isConnectable={true}\n      />\n\n      {/* Bottom handles */}\n      <Handle\n        id=\"bottom\"\n        type=\"source\"\n        position={Position.Bottom}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          left: '50%',\n          transform: 'translateX(-50%)',\n          zIndex: 2\n        }}\n        isConnectable={true}\n      />\n      <Handle\n        id=\"bottom\"\n        type=\"target\"\n        position={Position.Bottom}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          left: '50%',\n          transform: 'translateX(-50%)',\n          zIndex: 1\n        }}\n        isConnectable={true}\n      />\n\n      {/* Left handles */}\n      <Handle\n        id=\"left\"\n        type=\"source\"\n        position={Position.Left}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          top: '50%',\n          transform: 'translateY(-50%)',\n          zIndex: 2\n        }}\n        isConnectable={true}\n      />\n      <Handle\n        id=\"left\"\n        type=\"target\"\n        position={Position.Left}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          top: '50%',\n          transform: 'translateY(-50%)',\n          zIndex: 1\n        }}\n        isConnectable={true}\n      />\n\n      {/* Priority indicator */}\n      {data.priority && (\n        <div className=\"absolute -top-2 -right-2\">\n          <div className={`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold border-2 border-white ${data.priority === 'high' ? 'bg-red-500' :\n              data.priority === 'medium' ? 'bg-yellow-500' : 'bg-green-500'\n            }`}>\n            {data.priority === 'high' ? '!' : data.priority === 'medium' ? '' : ''}\n          </div>\n        </div>\n      )}\n\n      <div className=\"flex items-center gap-2 mb-2\">\n        <div className=\"flex items-center gap-1\">\n          <Brain size={16} className=\"drop-shadow-sm\" />\n          {data.tags && data.tags.length > 0 && (\n            <Tag size={12} className=\"opacity-75\" />\n          )}\n        </div>\n        <div className=\"font-semibold text-sm truncate flex-1\">{data.label}</div>\n        {data.onDelete && (\n          <button\n            onClick={(e) => {\n              // Only stop propagation if this is a single click, not part of a double-click\n              if (e.detail === 1) {\n                e.stopPropagation();\n                // Use a small timeout to ensure this isn't part of a double-click\n                setTimeout(() => {\n                  data.onDelete();\n                }, 200);\n              }\n            }}\n            onDoubleClick={(e) => {\n              // Prevent delete on double-click, allow modal to open\n              e.preventDefault();\n            }}\n            className=\"ml-auto p-1 hover:bg-white hover:bg-opacity-20 rounded transition-all duration-200 hover:scale-110 opacity-70 hover:opacity-100\"\n          >\n            <X size={12} />\n          </button>\n        )}\n      </div>\n\n      <div className=\"text-xs opacity-90 mb-2\">{data.category}</div>\n\n      {/* Enhanced progress display */}\n      {data.flashcard_count > 0 && (\n        <div className=\"text-xs mt-2 space-y-1\">\n          <div className=\"flex justify-between items-center\">\n            <span className=\"opacity-90\">{data.completed_flashcards}/{data.flashcard_count} flashcards</span>\n            <span className=\"font-semibold\">{Math.round(completionPercentage)}%</span>\n          </div>\n          <div className=\"w-full bg-white bg-opacity-20 rounded-full h-2 overflow-hidden\">\n            <div\n              className=\"h-full bg-white rounded-full transition-all duration-1000 ease-out\"\n              style={{ width: `${completionPercentage}%` }}\n            />\n          </div>\n        </div>\n      )}\n\n      {/* Tags display */}\n      {data.tags && data.tags.length > 0 && (\n        <div className=\"flex flex-wrap gap-1 mt-2\">\n          {data.tags.slice(0, 3).map((tag, index) => (\n            <span\n              key={index}\n              className=\"px-2 py-1 bg-white bg-opacity-20 rounded-full text-xs\"\n            >\n              {tag}\n            </span>\n          ))}\n          {data.tags.length > 3 && (\n            <span className=\"px-2 py-1 bg-white bg-opacity-20 rounded-full text-xs\">\n              +{data.tags.length - 3}\n            </span>\n          )}\n        </div>\n      )}\n\n      {/* Last updated indicator */}\n      {data.updated_at && (\n        <div className=\"absolute bottom-1 right-1 opacity-50\">\n          <Clock size={10} />\n        </div>\n      )}\n    </div>\n  );\n};\n\nconst CaseNode = ({ data, selected }) => {\n  const [isVisible, setIsVisible] = useState(data.skipAnimation || false);\n  \n  // Entry animation with slight delay for staggered effect - only if not skipping animations\n  useEffect(() => {\n    if (!data.skipAnimation) {\n      const timer = setTimeout(() => setIsVisible(true), 150);\n      return () => clearTimeout(timer);\n    }\n  }, [data.skipAnimation]);\n\n  const getStatusColor = (status) => {\n    switch (status) {\n      case 'active': return 'bg-green-100 text-green-800 border-green-200';\n      case 'archived': return 'bg-gray-100 text-gray-800 border-gray-200';\n      case 'follow_up': return 'bg-yellow-100 text-yellow-800 border-yellow-200';\n      default: return 'bg-blue-100 text-blue-800 border-blue-200';\n    }\n  };\n\n  const getUrgencyLevel = (data) => {\n    // Simple urgency calculation based on keywords\n    const urgentKeywords = ['emergency', 'urgent', 'crisis', 'acute', 'severe'];\n    const complaint = data.chief_complaint?.toLowerCase() || '';\n    const diagnosis = data.diagnosis?.toLowerCase() || '';\n\n    if (urgentKeywords.some(keyword => complaint.includes(keyword) || diagnosis.includes(keyword))) {\n      return 'high';\n    }\n    return 'normal';\n  };\n\n  const urgency = getUrgencyLevel(data);\n\n  return (\n    <div\n      className={`group px-4 py-3 rounded-xl shadow-lg border-2 transition-all duration-600 min-w-[220px] bg-white relative hover:shadow-2xl transform hover:scale-105 ${selected\n          ? 'border-blue-400 shadow-xl scale-105 ring-4 ring-blue-200'\n          : 'border-gray-200 hover:border-blue-300 hover:ring-2 hover:ring-blue-100'\n        } ${urgency === 'high' ? 'ring-2 ring-red-300' : ''} ${isVisible ? 'opacity-100 scale-100 translate-y-0 rotate-0' : 'opacity-0 scale-90 translate-y-6 rotate-1'}`}\n      style={{\n        transition: 'all 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94), transform 0.3s ease'\n      }}\n    >\n      {/* Connection Hotspots - Stacked source and target handles for all four sides */}\n      {/* Top handles */}\n      <Handle\n        id=\"top\"\n        type=\"source\"\n        position={Position.Top}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          left: '50%',\n          transform: 'translateX(-50%)',\n          zIndex: 2\n        }}\n        isConnectable={true}\n      />\n      <Handle\n        id=\"top\"\n        type=\"target\"\n        position={Position.Top}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          left: '50%',\n          transform: 'translateX(-50%)',\n          zIndex: 1\n        }}\n        isConnectable={true}\n      />\n\n      {/* Right handles */}\n      <Handle\n        id=\"right\"\n        type=\"source\"\n        position={Position.Right}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          top: '50%',\n          transform: 'translateY(-50%)',\n          zIndex: 2\n        }}\n        isConnectable={true}\n      />\n      <Handle\n        id=\"right\"\n        type=\"target\"\n        position={Position.Right}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          top: '50%',\n          transform: 'translateY(-50%)',\n          zIndex: 1\n        }}\n        isConnectable={true}\n      />\n\n      {/* Bottom handles */}\n      <Handle\n        id=\"bottom\"\n        type=\"source\"\n        position={Position.Bottom}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          left: '50%',\n          transform: 'translateX(-50%)',\n          zIndex: 2\n        }}\n        isConnectable={true}\n      />\n      <Handle\n        id=\"bottom\"\n        type=\"target\"\n        position={Position.Bottom}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          left: '50%',\n          transform: 'translateX(-50%)',\n          zIndex: 1\n        }}\n        isConnectable={true}\n      />\n\n      {/* Left handles */}\n      <Handle\n        id=\"left\"\n        type=\"source\"\n        position={Position.Left}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          top: '50%',\n          transform: 'translateY(-50%)',\n          zIndex: 2\n        }}\n        isConnectable={true}\n      />\n      <Handle\n        id=\"left\"\n        type=\"target\"\n        position={Position.Left}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          top: '50%',\n          transform: 'translateY(-50%)',\n          zIndex: 1\n        }}\n        isConnectable={true}\n      />\n\n      {/* Urgency indicator */}\n      {urgency === 'high' && (\n        <div className=\"absolute -top-2 -right-2\">\n          <div className=\"w-6 h-6 bg-red-500 rounded-full flex items-center justify-center border-2 border-white animate-pulse\">\n            <AlertCircle size={14} className=\"text-white\" />\n          </div>\n        </div>\n      )}\n\n      <div className=\"flex items-center gap-2 mb-2\">\n        <div className=\"flex items-center gap-1\">\n          <Users size={16} className=\"text-blue-600\" />\n          {data.linked_topics && data.linked_topics.length > 0 && (\n            <div className=\"text-xs bg-blue-100 text-blue-600 px-1 rounded\">\n              {data.linked_topics.length}\n            </div>\n          )}\n        </div>\n        <div className=\"font-semibold text-sm text-gray-800 truncate flex-1\">{data.label}</div>\n        {data.onDelete && (\n          <button\n            onClick={(e) => {\n              // Only stop propagation if this is a single click, not part of a double-click\n              if (e.detail === 1) {\n                e.stopPropagation();\n                // Use a small timeout to ensure this isn't part of a double-click\n                setTimeout(() => {\n                  data.onDelete();\n                }, 200);\n              }\n            }}\n            onDoubleClick={(e) => {\n              // Prevent delete on double-click, allow modal to open\n              e.preventDefault();\n            }}\n            className=\"ml-auto p-1 hover:bg-gray-200 rounded transition-all duration-200 hover:scale-110 opacity-70 hover:opacity-100\"\n          >\n            <X size={12} />\n          </button>\n        )}\n      </div>\n\n      <div className=\"text-xs text-gray-600 mb-2 truncate\">{data.diagnosis}</div>\n\n      {/* Enhanced patient info */}\n      <div className=\"space-y-1\">\n        {data.age && (\n          <div className=\"text-xs text-blue-600 flex items-center gap-1\">\n            <Calendar size={10} />\n            Age: {data.age}\n          </div>\n        )}\n\n        {/* Status badge */}\n        {data.status && (\n          <span className={`inline-block px-2 py-1 rounded-full text-xs border ${getStatusColor(data.status)}`}>\n            {data.status}\n          </span>\n        )}\n      </div>\n\n      {/* Progress indicators */}\n      {data.tasks_count && data.tasks_count > 0 && (\n        <div className=\"mt-2 text-xs text-gray-500 flex items-center gap-1\">\n          <CheckSquare size={10} />\n          {data.completed_tasks || 0}/{data.tasks_count} tasks\n        </div>\n      )}\n\n      {/* Last updated indicator */}\n      {data.updated_at && (\n        <div className=\"absolute bottom-1 right-1 opacity-30\">\n          <Clock size={10} />\n        </div>\n      )}\n    </div>\n  );\n};\n\nconst TaskNode = ({ data, selected }) => {\n  const [isVisible, setIsVisible] = useState(data.skipAnimation || false);\n  \n  // Entry animation with different timing for variety - only if not skipping animations\n  useEffect(() => {\n    if (!data.skipAnimation) {\n      const timer = setTimeout(() => setIsVisible(true), 200);\n      return () => clearTimeout(timer);\n    }\n  }, [data.skipAnimation]);\n\n  const statusClasses = {\n    pending: 'bg-yellow-500',\n    in_progress: 'bg-blue-600',\n    completed: 'bg-green-700 opacity-60'\n  };\n\n  return (\n    <div\n      className={`group px-4 py-3 rounded-xl shadow-lg border-2 transition-all duration-500 min-w-[200px] text-white relative hover:shadow-2xl transform hover:scale-105 ${selected\n          ? 'border-yellow-400 shadow-xl scale-105 ring-4 ring-yellow-200'\n          : 'border-transparent hover:border-yellow-300 hover:ring-2 hover:ring-yellow-100'\n        } ${statusClasses[data.status] || 'bg-gray-500'} ${isVisible ? 'opacity-100 scale-100 translate-x-0' : 'opacity-0 scale-85 -translate-x-4'}`}\n      style={{\n        transition: 'all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55), transform 0.3s ease'\n      }}\n    >\n      {/* Connection Hotspots - Stacked source and target handles for all four sides */}\n      {/* Top handles */}\n      <Handle\n        id=\"top\"\n        type=\"source\"\n        position={Position.Top}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          left: '50%',\n          transform: 'translateX(-50%)',\n          zIndex: 2\n        }}\n        isConnectable={true}\n      />\n      <Handle\n        id=\"top\"\n        type=\"target\"\n        position={Position.Top}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          left: '50%',\n          transform: 'translateX(-50%)',\n          zIndex: 1\n        }}\n        isConnectable={true}\n      />\n\n      {/* Right handles */}\n      <Handle\n        id=\"right\"\n        type=\"source\"\n        position={Position.Right}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          top: '50%',\n          transform: 'translateY(-50%)',\n          zIndex: 2\n        }}\n        isConnectable={true}\n      />\n      <Handle\n        id=\"right\"\n        type=\"target\"\n        position={Position.Right}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          top: '50%',\n          transform: 'translateY(-50%)',\n          zIndex: 1\n        }}\n        isConnectable={true}\n      />\n\n      {/* Bottom handles */}\n      <Handle\n        id=\"bottom\"\n        type=\"source\"\n        position={Position.Bottom}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          left: '50%',\n          transform: 'translateX(-50%)',\n          zIndex: 2\n        }}\n        isConnectable={true}\n      />\n      <Handle\n        id=\"bottom\"\n        type=\"target\"\n        position={Position.Bottom}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          left: '50%',\n          transform: 'translateX(-50%)',\n          zIndex: 1\n        }}\n        isConnectable={true}\n      />\n\n      {/* Left handles */}\n      <Handle\n        id=\"left\"\n        type=\"source\"\n        position={Position.Left}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          top: '50%',\n          transform: 'translateY(-50%)',\n          zIndex: 2\n        }}\n        isConnectable={true}\n      />\n      <Handle\n        id=\"left\"\n        type=\"target\"\n        position={Position.Left}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          top: '50%',\n          transform: 'translateY(-50%)',\n          zIndex: 1\n        }}\n        isConnectable={true}\n      />\n\n      <div className=\"flex items-center gap-2 mb-1\">\n        <CheckSquare size={16} />\n        <div className=\"font-semibold text-sm\">{data.label}</div>\n        {data.onDelete && (\n          <button\n            onClick={(e) => {\n              // Only stop propagation if this is a single click, not part of a double-click\n              if (e.detail === 1) {\n                e.stopPropagation();\n                // Use a small timeout to ensure this isn't part of a double-click\n                setTimeout(() => {\n                  data.onDelete();\n                }, 200);\n              }\n            }}\n            onDoubleClick={(e) => {\n              // Prevent delete on double-click, allow modal to open\n              e.preventDefault();\n            }}\n            className=\"ml-auto p-1 hover:bg-white hover:bg-opacity-20 rounded transition-all duration-200 hover:scale-110 opacity-70 hover:opacity-100\"\n          >\n            <X size={12} />\n          </button>\n        )}\n      </div>\n      <div className=\"text-xs opacity-90\">Priority: {data.priority}</div>\n      {data.due_date && (\n        <div className=\"text-xs mt-1 opacity-90\">Due: {new Date(data.due_date).toLocaleDateString()}</div>\n      )}\n    </div>\n  );\n};\n\nconst LiteratureNode = ({ data, selected }) => {\n  const [isVisible, setIsVisible] = useState(data.skipAnimation || false);\n  \n  // Entry animation with the longest delay for final polish - only if not skipping animations\n  useEffect(() => {\n    if (!data.skipAnimation) {\n      const timer = setTimeout(() => setIsVisible(true), 250);\n      return () => clearTimeout(timer);\n    }\n  }, [data.skipAnimation]);\n\n  return (\n    <div\n      className={`group px-4 py-3 rounded-xl shadow-lg border-2 transition-all duration-650 min-w-[200px] bg-purple-50 relative hover:shadow-2xl transform hover:scale-105 ${selected\n          ? 'border-purple-400 shadow-xl scale-105 ring-4 ring-purple-200'\n          : 'border-purple-200 hover:border-purple-300 hover:ring-2 hover:ring-purple-100'\n        } ${isVisible ? 'opacity-100 scale-100 translate-x-0 rotate-0' : 'opacity-0 scale-95 translate-x-4 -rotate-1'}`}\n      style={{\n        transition: 'all 0.65s cubic-bezier(0.175, 0.885, 0.32, 1.275), transform 0.3s ease'\n      }}\n    >\n      {/* Connection Hotspots - Stacked source and target handles for all four sides */}\n      {/* Top handles */}\n      <Handle\n        id=\"top\"\n        type=\"source\"\n        position={Position.Top}\n        className=\"w-3 h-3 !bg-purple-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          left: '50%',\n          transform: 'translateX(-50%)',\n          zIndex: 2\n        }}\n        isConnectable={true}\n      />\n      <Handle\n        id=\"top\"\n        type=\"target\"\n        position={Position.Top}\n        className=\"w-3 h-3 !bg-purple-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          left: '50%',\n          transform: 'translateX(-50%)',\n          zIndex: 1\n        }}\n        isConnectable={true}\n      />\n\n      {/* Right handles */}\n      <Handle\n        id=\"right\"\n        type=\"source\"\n        position={Position.Right}\n        className=\"w-3 h-3 !bg-purple-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          top: '50%',\n          transform: 'translateY(-50%)',\n          zIndex: 2\n        }}\n        isConnectable={true}\n      />\n      <Handle\n        id=\"right\"\n        type=\"target\"\n        position={Position.Right}\n        className=\"w-3 h-3 !bg-purple-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          top: '50%',\n          transform: 'translateY(-50%)',\n          zIndex: 1\n        }}\n        isConnectable={true}\n      />\n\n      {/* Bottom handles */}\n      <Handle\n        id=\"bottom\"\n        type=\"source\"\n        position={Position.Bottom}\n        className=\"w-3 h-3 !bg-purple-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          left: '50%',\n          transform: 'translateX(-50%)',\n          zIndex: 2\n        }}\n        isConnectable={true}\n      />\n      <Handle\n        id=\"bottom\"\n        type=\"target\"\n        position={Position.Bottom}\n        className=\"w-3 h-3 !bg-purple-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          left: '50%',\n          transform: 'translateX(-50%)',\n          zIndex: 1\n        }}\n        isConnectable={true}\n      />\n\n      {/* Left handles */}\n      <Handle\n        id=\"left\"\n        type=\"source\"\n        position={Position.Left}\n        className=\"w-3 h-3 !bg-purple-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          top: '50%',\n          transform: 'translateY(-50%)',\n          zIndex: 2\n        }}\n        isConnectable={true}\n      />\n      <Handle\n        id=\"left\"\n        type=\"target\"\n        position={Position.Left}\n        className=\"w-3 h-3 !bg-purple-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          top: '50%',\n          transform: 'translateY(-50%)',\n          zIndex: 1\n        }}\n        isConnectable={true}\n      />\n\n      <div \n        className=\"flex items-center gap-2 mb-1 cursor-pointer\"\n        onClick={(e) => {\n          // Only stop propagation if this is a single click, not part of a double-click\n          if (e.detail === 1) {\n            e.stopPropagation();\n            setTimeout(() => {\n              if (data.onLiteratureClick) {\n                data.onLiteratureClick(data);\n              }\n            }, 200);\n          }\n        }}\n        onDoubleClick={(e) => {\n          // Allow double-click to bubble up for modal opening\n          e.preventDefault();\n        }}\n      >\n        <BookOpen size={16} className=\"text-purple-600\" />\n        <div className=\"font-semibold text-sm text-gray-800\">{data.label}</div>\n        {data.onDelete && (\n          <button\n            onClick={(e) => {\n              // Only stop propagation if this is a single click, not part of a double-click\n              if (e.detail === 1) {\n                e.stopPropagation();\n                // Use a small timeout to ensure this isn't part of a double-click\n                setTimeout(() => {\n                  data.onDelete();\n                }, 200);\n              }\n            }}\n            onDoubleClick={(e) => {\n              // Prevent delete on double-click, allow modal to open\n              e.preventDefault();\n            }}\n            className=\"ml-auto p-1 hover:bg-purple-200 rounded transition-all duration-200 hover:scale-110 opacity-70 hover:opacity-100\"\n          >\n            <X size={12} />\n          </button>\n        )}\n      </div>\n      <div className=\"text-xs text-gray-600\">{data.authors}</div>\n      <div className=\"text-xs text-purple-600 mt-1\">{data.year}</div>\n    </div>\n  );\n};\n\nconst nodeTypes = {\n  topic: TopicNode,\n  case: CaseNode,\n  task: TaskNode,\n  literature: LiteratureNode,\n};\n\n\n\n// Enhanced Dedicated Editing Form Component\nconst EnhancedEditingForm = ({ type, data, onClose, onSave, onDelete }) => {\n  // Initialize formData with proper field structure based on node type\n  const getInitialFormData = (type, data) => {\n    const baseData = data || {};\n    \n    switch (type) {\n      case 'case':\n        return {\n          case_id: '',\n          age: '',\n          primary_diagnosis: '',\n          gender: '',\n          chiefComplaint: '',\n          initialPresentation: '',\n          currentPresentation: '',\n          medicationHistory: '',\n          therapyProgress: '',\n          defensePatterns: '',\n          clinicalReflection: '',\n          ...baseData // Existing data takes precedence\n        };\n      case 'topic':\n        return {\n          title: '',\n          category: '',\n          color: '#3B82F6',\n          description: '',\n          notes: '',\n          tags: [],\n          ...baseData\n        };\n      case 'task':\n        return {\n          title: '',\n          description: '',\n          status: 'pending',\n          priority: 'medium',\n          due_date: '',\n          ...baseData\n        };\n      case 'literature':\n        return {\n          title: '',\n          authors: '',\n          year: '',\n          doi: '',\n          abstract: '',\n          notes: '',\n          tags: [],\n          ...baseData\n        };\n      default:\n        return baseData;\n    }\n  };\n\n  const [formData, setFormData] = useState(() => getInitialFormData(type, data));\n  const [activeTab, setActiveTab] = useState('basic');\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [errors, setErrors] = useState({});\n\n  // Update formData when data prop changes\n  useEffect(() => {\n    setFormData(getInitialFormData(type, data));\n  }, [type, data]);\n\n  const tabs = {\n    basic: 'Basic Info',\n    details: 'Details',\n    notes: 'Notes & Tags',\n    history: 'History'\n  };\n\n  const validateForm = () => {\n    const newErrors = {};\n\n    switch (type) {\n      case 'topic':\n        if (!formData.title?.trim()) newErrors.title = 'Title is required';\n        if (!formData.category?.trim()) newErrors.category = 'Category is required';\n        break;\n      case 'case':\n        if (!formData.case_id?.trim()) newErrors.case_id = 'Case ID is required';\n        if (!formData.primary_diagnosis?.trim()) newErrors.primary_diagnosis = 'Primary diagnosis is required';\n        break;\n      case 'task':\n        if (!formData.title?.trim()) newErrors.title = 'Title is required';\n        break;\n      case 'literature':\n        if (!formData.title?.trim()) newErrors.title = 'Title is required';\n        if (!formData.authors?.trim()) newErrors.authors = 'Authors are required';\n        break;\n    }\n\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = async () => {\n    if (!validateForm()) return;\n\n    setIsSubmitting(true);\n    try {\n      await onSave(formData);\n    } catch (error) {\n      console.error('Error saving:', error);\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  const updateFormData = (field, value) => {\n    setFormData(prev => ({ ...prev, [field]: value }));\n    if (errors[field]) {\n      setErrors(prev => ({ ...prev, [field]: null }));\n    }\n  };\n\n  const renderBasicTab = () => {\n    switch (type) {\n      case 'topic':\n        return (\n          <div className=\"space-y-4\">\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">Title *</label>\n              <input\n                type=\"text\"\n                value={formData.title || ''}\n                onChange={(e) => updateFormData('title', e.target.value)}\n                className={`w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500 ${errors.title ? 'border-red-500' : 'border-gray-300'\n                  }`}\n                placeholder=\"Enter topic title\"\n              />\n              {errors.title && <p className=\"text-red-500 text-xs mt-1\">{errors.title}</p>}\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">Category *</label>\n              <select\n                value={formData.category || ''}\n                onChange={(e) => updateFormData('category', e.target.value)}\n                className={`w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500 ${errors.category ? 'border-red-500' : 'border-gray-300'\n                  }`}\n              >\n                <option value=\"\">Select category</option>\n                <option value=\"Mood Disorders\">Mood Disorders</option>\n                <option value=\"Anxiety Disorders\">Anxiety Disorders</option>\n                <option value=\"Psychotic Disorders\">Psychotic Disorders</option>\n                <option value=\"Personality Disorders\">Personality Disorders</option>\n                <option value=\"Substance Use Disorders\">Substance Use Disorders</option>\n                <option value=\"Other\">Other</option>\n              </select>\n              {errors.category && <p className=\"text-red-500 text-xs mt-1\">{errors.category}</p>}\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">Color Theme</label>\n              <div className=\"flex gap-2\">\n                {['#3B82F6', '#EF4444', '#10B981', '#F59E0B', '#8B5CF6', '#EC4899'].map(color => (\n                  <button\n                    key={color}\n                    onClick={() => updateFormData('color', color)}\n                    className={`w-8 h-8 rounded-full border-2 ${formData.color === color ? 'border-gray-800' : 'border-gray-300'\n                      }`}\n                    style={{ backgroundColor: color }}\n                  />\n                ))}\n              </div>\n            </div>\n          </div>\n        );\n\n      case 'case':\n        return (\n          <div className=\"space-y-4\">\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">Case ID *</label>\n                <input\n                  type=\"text\"\n                  value={formData.case_id || ''}\n                  onChange={(e) => updateFormData('case_id', e.target.value)}\n                  className={`w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500 ${errors.case_id ? 'border-red-500' : 'border-gray-300'\n                    }`}\n                  placeholder=\"CASE-001\"\n                />\n                {errors.case_id && <p className=\"text-red-500 text-xs mt-1\">{errors.case_id}</p>}\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">Age</label>\n                <input\n                  type=\"number\"\n                  value={formData.age || ''}\n                  onChange={(e) => updateFormData('age', e.target.value)}\n                  className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\n                  min=\"0\"\n                  max=\"120\"\n                />\n              </div>\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">Primary Diagnosis *</label>\n              <input\n                type=\"text\"\n                value={formData.primary_diagnosis || ''}\n                onChange={(e) => updateFormData('primary_diagnosis', e.target.value)}\n                className={`w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500 ${errors.primary_diagnosis ? 'border-red-500' : 'border-gray-300'\n                  }`}\n                placeholder=\"Enter primary diagnosis\"\n              />\n              {errors.primary_diagnosis && <p className=\"text-red-500 text-xs mt-1\">{errors.primary_diagnosis}</p>}\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">Gender</label>\n              <select\n                value={formData.gender || ''}\n                onChange={(e) => updateFormData('gender', e.target.value)}\n                className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\n              >\n                <option value=\"\">Select gender</option>\n                <option value=\"Male\">Male</option>\n                <option value=\"Female\">Female</option>\n                <option value=\"Non-binary\">Non-binary</option>\n                <option value=\"Other\">Other</option>\n              </select>\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">Chief Complaint</label>\n              <textarea\n                value={formData.chiefComplaint || ''}\n                onChange={(e) => updateFormData('chiefComplaint', e.target.value)}\n                className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\n                rows={2}\n                placeholder=\"Describe the primary concern\"\n              />\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">Initial Presentation</label>\n              <textarea\n                value={formData.initialPresentation || ''}\n                onChange={(e) => updateFormData('initialPresentation', e.target.value)}\n                className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\n                rows={3}\n                placeholder=\"Symptoms and context at first visit\"\n              />\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">Current Presentation</label>\n              <textarea\n                value={formData.currentPresentation || ''}\n                onChange={(e) => updateFormData('currentPresentation', e.target.value)}\n                className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\n                rows={3}\n                placeholder=\"Describe how the case looks now\"\n              />\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">Medication History</label>\n              <textarea\n                value={formData.medicationHistory || ''}\n                onChange={(e) => updateFormData('medicationHistory', e.target.value)}\n                className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\n                rows={2}\n                placeholder=\"e.g. SSRI trials, mood stabilizers, etc.\"\n              />\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">Therapy Progress</label>\n              <textarea\n                value={formData.therapyProgress || ''}\n                onChange={(e) => updateFormData('therapyProgress', e.target.value)}\n                className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\n                rows={2}\n                placeholder=\"How the patient has responded to therapy\"\n              />\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">Defense Patterns</label>\n              <textarea\n                value={formData.defensePatterns || ''}\n                onChange={(e) => updateFormData('defensePatterns', e.target.value)}\n                className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\n                rows={2}\n                placeholder=\"e.g. projection, denial, rationalization\"\n              />\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">Clinical Reflection</label>\n              <textarea\n                value={formData.clinicalReflection || ''}\n                onChange={(e) => updateFormData('clinicalReflection', e.target.value)}\n                className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\n                rows={3}\n                placeholder=\"Your thoughts or questions about the case\"\n              />\n            </div>\n          </div>\n        );\n\n      default:\n        return <div>Basic form for {type}</div>;\n    }\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 backdrop-blur-sm\">\n      <div className=\"bg-white rounded-xl shadow-2xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-hidden\">\n        {/* Header */}\n        <div className=\"bg-gradient-to-r from-blue-600 to-purple-600 text-white p-6\">\n          <div className=\"flex items-center justify-between\">\n            <h2 className=\"text-xl font-semibold capitalize flex items-center gap-2\">\n              <Sparkles size={20} />\n              Enhanced {type} Editor\n            </h2>\n            <button\n              onClick={onClose}\n              className=\"text-white hover:text-gray-200 transition-colors\"\n            >\n              <X size={24} />\n            </button>\n          </div>\n        </div>\n\n        {/* Tabs */}\n        <div className=\"border-b border-gray-200\">\n          <div className=\"flex\">\n            {Object.entries(tabs).map(([key, label]) => (\n              <button\n                key={key}\n                onClick={() => setActiveTab(key)}\n                className={`px-6 py-3 text-sm font-medium transition-colors ${activeTab === key\n                    ? 'border-b-2 border-blue-500 text-blue-600 bg-blue-50'\n                    : 'text-gray-500 hover:text-gray-700'\n                  }`}\n              >\n                {label}\n              </button>\n            ))}\n          </div>\n        </div>\n\n        {/* Content */}\n        <div className=\"p-6 overflow-y-auto max-h-[calc(90vh-200px)]\">\n          {activeTab === 'basic' && renderBasicTab()}\n          {activeTab === 'details' && <div>Details content for {type}</div>}\n          {activeTab === 'notes' && <div>Notes and tags content</div>}\n          {activeTab === 'history' && <div>History content</div>}\n        </div>\n\n        {/* Footer */}\n        <div className=\"bg-gray-50 px-6 py-4 flex items-center justify-between border-t\">\n          <div className=\"flex gap-2\">\n            {onDelete && (\n              <LoadingButton\n                onClick={onDelete}\n                icon={Trash2}\n                className=\"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg\"\n              >\n                Delete\n              </LoadingButton>\n            )}\n          </div>\n\n          <div className=\"flex gap-2\">\n            <button\n              onClick={onClose}\n              className=\"px-4 py-2 text-gray-600 hover:text-gray-800 border border-gray-300 rounded-lg hover:bg-gray-100 transition-colors\"\n            >\n              Cancel\n            </button>\n            <LoadingButton\n              onClick={handleSubmit}\n              loading={isSubmitting}\n              icon={isSubmitting ? Loader2 : Save}\n              className=\"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg\"\n            >\n              {isSubmitting ? 'Saving...' : 'Save Changes'}\n            </LoadingButton>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\nconst NodeSelector = ({ isOpen, onClose, onSelect, templates }) => {\n  const [selectedNodeType, setSelectedNodeType] = useState(null);\n\n  // When the modal is closed, reset the internal state\n  useEffect(() => {\n    if (!isOpen) {\n      // Add a small delay to allow the closing animation to finish before state reset\n      const timer = setTimeout(() => setSelectedNodeType(null), 300);\n      return () => clearTimeout(timer);\n    }\n  }, [isOpen]);\n\n  if (!isOpen) return null;\n\n  const nodeTypes = [\n    { type: 'topic', label: 'Psychiatric Topic', icon: Brain, color: 'bg-blue-600', description: 'Add a new psychiatric topic or disorder' },\n    { type: 'literature', label: 'Literature', icon: BookOpen, color: 'bg-purple-600', description: 'Add research papers, articles, or references' },\n    { type: 'case', label: 'Patient Case', icon: Users, color: 'bg-indigo-600', description: 'Add a new patient case study' },\n    { type: 'task', label: 'Task', icon: CheckSquare, color: 'bg-amber-600', description: 'Add a task or to-do item' }\n  ];\n\n  const handleNodeTypeSelect = (nodeType) => {\n    setSelectedNodeType(nodeType);\n  };\n\n  const handleFinalSelect = (templateId = null) => {\n    onSelect(selectedNodeType, templateId);\n    onClose();\n  };\n\n  const filteredTemplates = selectedNodeType ? (templates || []).filter(t => t.nodeType === selectedNodeType) : [];\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 backdrop-blur-sm animate-in fade-in-25 duration-300\">\n      <div className=\"bg-white rounded-xl shadow-2xl p-6 max-w-md w-full mx-4 transform transition-all duration-300 ease-out\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between mb-6\">\n          <div className=\"flex items-center gap-3\">\n            {selectedNodeType && (\n              <button\n                onClick={() => setSelectedNodeType(null)}\n                className=\"text-gray-400 hover:text-gray-600 p-1 rounded-full hover:bg-gray-100 transition-colors\"\n              >\n                <ArrowLeft size={20} />\n              </button>\n            )}\n            <h3 className=\"text-xl font-semibold text-gray-800\">\n              {selectedNodeType ? `Select a ${selectedNodeType} template` : 'Add New Node'}\n            </h3>\n          </div>\n          <button\n            onClick={onClose}\n            className=\"text-gray-400 hover:text-gray-600 p-1\"\n          >\n            <X size={20} />\n          </button>\n        </div>\n\n        <div className=\"relative overflow-hidden\" style={{ minHeight: '200px' }}>\n          {/* View 1: Node Type Selection */}\n          <div className={`transition-transform duration-300 ease-in-out ${selectedNodeType ? '-translate-x-full opacity-0' : 'translate-x-0 opacity-100'}`}>\n            <div className=\"space-y-3\">\n              {nodeTypes.map(({ type, label, icon: Icon, color, description }) => (\n                <button\n                  key={type}\n                  onClick={() => handleNodeTypeSelect(type)}\n                  className=\"w-full flex items-center gap-4 p-4 rounded-lg border-2 border-gray-200 hover:border-blue-400 hover:bg-blue-50 transition-all text-left\"\n                >\n                  <div className={`${color} p-2 rounded-lg text-white`}>\n                    <Icon size={20} />\n                  </div>\n                  <div>\n                    <div className=\"font-medium text-gray-800\">{label}</div>\n                    <div className=\"text-sm text-gray-500\">{description}</div>\n                  </div>\n                </button>\n              ))}\n            </div>\n          </div>\n\n          {/* View 2: Template Selection */}\n          <div className={`absolute top-0 left-0 w-full transition-transform duration-300 ease-in-out ${selectedNodeType ? 'translate-x-0 opacity-100' : 'translate-x-full opacity-0'}`}>\n            {selectedNodeType && (\n              <div className=\"space-y-3\">\n                {/* Create Blank Option */}\n                <button\n                  onClick={() => handleFinalSelect(null)}\n                  className=\"w-full flex items-center gap-4 p-4 rounded-lg border-2 border-dashed border-gray-300 hover:border-blue-400 hover:bg-blue-50 transition-all text-left\"\n                >\n                  <div className=\"bg-gray-200 p-2 rounded-lg text-gray-600\">\n                    <Plus size={20} />\n                  </div>\n                  <div>\n                    <div className=\"font-medium text-gray-800\">Create Blank {selectedNodeType}</div>\n                    <div className=\"text-sm text-gray-500\">Start with an empty node.</div>\n                  </div>\n                </button>\n\n                {/* Filtered Templates */}\n                {filteredTemplates.map((template) => (\n                  <button\n                    key={template.id}\n                    onClick={() => handleFinalSelect(template.id)}\n                    className=\"w-full flex items-center gap-4 p-4 rounded-lg border-2 border-gray-200 hover:border-blue-400 hover:bg-blue-50 transition-all text-left\"\n                  >\n                    <div className=\"bg-indigo-100 p-2 rounded-lg text-indigo-600\">\n                      <FileText size={20} />\n                    </div>\n                    <div>\n                      <div className=\"font-medium text-gray-800\">{template.name}</div>\n                      <div className=\"text-sm text-gray-500 truncate\">{template.data?.description || template.data?.abstract || template.data?.assessment_plan || 'No description'}</div>\n\n                    </div>\n                  </button>\n                ))}\n\n                {filteredTemplates.length === 0 && (\n                  <div className=\"text-center text-sm text-gray-500 py-4\">\n                    No templates found for this node type.\n                  </div>\n                )}\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\n// Edge Label Modal Component\nconst EdgeLabelModal = ({ edge, isOpen, onClose, onSave }) => {\n  const [label, setLabel] = useState(edge?.label || '');\n\n  // Update label when edge changes\n  useEffect(() => {\n    setLabel(edge?.label || '');\n  }, [edge]);\n\n  const handleSave = () => {\n    onSave(edge.id, label);\n    onClose();\n  };\n\n  const handleKeyPress = (e) => {\n    if (e.key === 'Enter') {\n      handleSave();\n    } else if (e.key === 'Escape') {\n      onClose();\n    }\n  };\n\n  if (!isOpen || !edge) return null;\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 backdrop-blur-sm\">\n      <div className=\"bg-white rounded-xl shadow-2xl p-6 max-w-md w-full mx-4 transform transition-all\">\n        <div className=\"flex items-center justify-between mb-6\">\n          <h3 className=\"text-xl font-semibold text-gray-800\">Edit Connection Label</h3>\n          <button\n            onClick={onClose}\n            className=\"text-gray-400 hover:text-gray-600 p-1 transition-colors\"\n          >\n            <X size={20} />\n          </button>\n        </div>\n\n        <div className=\"mb-6\">\n          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n            Connection Label\n          </label>\n          <input\n            type=\"text\"\n            value={label}\n            onChange={(e) => setLabel(e.target.value)}\n            onKeyPress={handleKeyPress}\n            placeholder=\"Enter a label for this connection...\"\n            className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all\"\n            autoFocus\n          />\n          <p className=\"text-xs text-gray-500 mt-1\">\n            Press Enter to save, Escape to cancel\n          </p>\n        </div>\n\n        <div className=\"flex items-center justify-end gap-3\">\n          <button\n            onClick={onClose}\n            className=\"px-4 py-2 text-gray-600 hover:text-gray-800 border border-gray-300 rounded-lg hover:bg-gray-100 transition-colors\"\n          >\n            Cancel\n          </button>\n          <button\n            onClick={handleSave}\n            className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2\"\n          >\n            <Save size={16} />\n            Save Label\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\n// Enhanced Main Dashboard Component with improved visual effects\nconst DashboardComponent = () => {\n  const { fitView, setCenter, zoomTo, getViewport } = useReactFlow();\n\n  const [nodes, setNodes, onNodesChange] = useNodesState([]);\n  const [edges, setEdges, onEdgesChange] = useEdgesState([]);\n\n  const [mindMapData, setMindMapData] = useState({\n    topics: [],\n    cases: [],\n    tasks: [],\n    literature: [],\n    connections: []\n  });\n\n  const [isEditing, setIsEditing] = useState(false);\n  const [selectedNode, setSelectedNode] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [loadingProgress, setLoadingProgress] = useState(0);\n  const [loadingMessage, setLoadingMessage] = useState('Initializing...');\n  const [isInitialLoad, setIsInitialLoad] = useState(true);\n  const [focusedCategory, setFocusedCategory] = useState(null);\n  const [showNodeSelector, setShowNodeSelector] = useState(false);\n  // Specialized modal state for each node type with stable data references\n  const [caseModal, setCaseModal] = useState({ isOpen: false, data: null });\n  const [topicModal, setTopicModal] = useState({ isOpen: false, data: null });\n  const [taskModal, setTaskModal] = useState({ isOpen: false, data: null });\n  const caseModalStableData = useRef(null);\n  const topicModalStableData = useRef(null);\n  const taskModalStableData = useRef(null);\n  const [isReactFlowReady, setIsReactFlowReady] = useState(false);\n  const [hasAppliedInitialLayout, setHasAppliedInitialLayout] = useState(false);\n  const [isExportingCSV, setIsExportingCSV] = useState(false);\n  const [lastSaved, setLastSaved] = useState(null);\n  const [isSaving, setIsSaving] = useState(false);\n  const [edgeModal, setEdgeModal] = useState({ isOpen: false, edge: null });\n  const [templates, setTemplates] = useState([]);\n  const [exportProgress, setExportProgress] = useState({ show: false, progress: 0, message: '' });\n\n  const [toasts, setToasts] = useState([]);\n  const [isTemplateManagerOpen, setIsTemplateManagerOpen] = useState(false);\n  const [literatureModal, setLiteratureModal] = useState({ isOpen: false, data: null });\n  const [isAnimating, setIsAnimating] = useState(false); // Track animation state\n  const [modalAnimationStates, setModalAnimationStates] = useState({\n    case: false,\n    topic: false,\n    task: false,\n    literature: false\n  });\n  const addToast = useCallback((message, type = 'success', duration = 3000) => {\n    const id = Date.now();\n    const newToast = { id, message, type, duration };\n    setToasts(prev => [...prev, newToast]);\n  }, []);\n\n  const removeToast = useCallback((id) => {\n    setToasts(prev => prev.filter(toast => toast.id !== id));\n  }, []);\n\n  const autoSaveMindMapData = useCallback((data) => {\n    // Enhanced animation and modal state checking\n    const anyModalOpen = caseModal.isOpen || topicModal.isOpen || taskModal.isOpen || literatureModal.isOpen;\n    const anyModalAnimating = Object.values(modalAnimationStates).some(state => state);\n    const anyModalTransitioning = (caseModal.isOpen && caseModal.data?.isTabTransitioning) || \n                                  (topicModal.isOpen && topicModal.data?.isTabTransitioning) ||\n                                  (taskModal.isOpen && taskModal.data?.isTabTransitioning);\n    \n    if (isAnimating || anyModalOpen || anyModalTransitioning || anyModalAnimating) {\n      console.log('Deferring auto-save during animation, modal interaction, or tab transition');\n      // Use a longer delay and exponential backoff for persistent animation states\n      const delay = anyModalTransitioning || anyModalAnimating ? 2000 : 1000;\n      setTimeout(() => autoSaveMindMapData(data), delay);\n      return;\n    }\n\n    const onSaveStart = () => setIsSaving(true);\n    const onSaveComplete = (success, error) => {\n      setIsSaving(false);\n      if (success) {\n        setLastSaved(new Date());\n        // Reduce toast frequency during auto-save to prevent UI distractions\n        // addToast('Data auto-saved', 'saving', 1000);\n      } else {\n        addToast('Auto-save failed', 'error', 4000);\n        console.error('Auto-save error:', error);\n      }\n    };\n\n    localStorageUtils.save(data, onSaveStart, onSaveComplete, isAnimating);\n    // Use requestIdleCallback for backend saves to avoid blocking animations\n    if (window.requestIdleCallback) {\n      window.requestIdleCallback(() => {\n        // Double-check animation state before backend save\n        const stillAnimating = isAnimating || Object.values(modalAnimationStates).some(state => state);\n        if (!stillAnimating) {\n          saveToBackend(data);\n        }\n      }, { timeout: 5000 });\n    } else {\n      setTimeout(() => {\n        const stillAnimating = isAnimating || Object.values(modalAnimationStates).some(state => state);\n        if (!stillAnimating) {\n          saveToBackend(data);\n        }\n      }, 100); // Longer delay fallback\n    }\n  }, [addToast, isAnimating, modalAnimationStates, caseModal.isOpen, topicModal.isOpen, taskModal.isOpen, literatureModal.isOpen]);\n\n  // Separate function for position-only updates (more frequent, less critical)\n  const autoSavePositionData = useCallback((data) => {\n    // Enhanced checks for animation states\n    const anyModalOpen = caseModal.isOpen || topicModal.isOpen || taskModal.isOpen || literatureModal.isOpen;\n    const anyModalAnimating = Object.values(modalAnimationStates).some(state => state);\n    if (isAnimating || anyModalOpen || anyModalAnimating) return;\n    \n    // Save to localStorage immediately\n    localStorageUtils.save(data, null, null, isAnimating);\n    \n    // Also save to backend with a small delay to batch updates\n    clearTimeout(window.positionBackendSaveTimeout);\n    window.positionBackendSaveTimeout = setTimeout(() => {\n      // Call saveToBackend indirectly to avoid initialization issues\n      autoSaveMindMapData(data);\n    }, 800); // 800ms delay to batch multiple position changes\n  }, [isAnimating, modalAnimationStates, caseModal.isOpen, topicModal.isOpen, taskModal.isOpen, literatureModal.isOpen, autoSaveMindMapData]);\n\n  // Stable data effects to prevent modal re-renders during auto-save\n  useEffect(() => {\n    if (caseModal.isOpen && caseModal.data) {\n      // Store stable reference when modal opens\n      caseModalStableData.current = { ...caseModal.data };\n    } else if (!caseModal.isOpen) {\n      // Clear reference when modal closes\n      caseModalStableData.current = null;\n    }\n  }, [caseModal.isOpen, caseModal.data?.id]);\n\n  useEffect(() => {\n    if (topicModal.isOpen && topicModal.data) {\n      topicModalStableData.current = { ...topicModal.data };\n    } else if (!topicModal.isOpen) {\n      topicModalStableData.current = null;\n    }\n  }, [topicModal.isOpen, topicModal.data?.id]);\n\n  useEffect(() => {\n    if (taskModal.isOpen && taskModal.data) {\n      taskModalStableData.current = { ...taskModal.data };\n    } else if (!taskModal.isOpen) {\n      taskModalStableData.current = null;\n    }\n  }, [taskModal.isOpen, taskModal.data?.id]);\n\nconst handleDeleteNode = useCallback((fullNodeId) => {\n  // fullNodeId is always in the format `${nodeType}-${id}`\n  console.log(`Deleting node with full ID:`, fullNodeId);\n\n  // Extract nodeType and id from fullNodeId\n  const [nodeType, ...idParts] = fullNodeId.split('-');\n  const nodeId = idParts.join('-');\n  const collectionKey = nodeType === 'literature' ? 'literature' : `${nodeType}s`;\n\n  setMindMapData(prevData => {\n    // Remove the node from its collection\n    const updatedCollection = (prevData[collectionKey] || []).filter(item => String(item.id) !== nodeId);\n    // Remove any connections that are attached to the deleted node\n    const updatedConnections = (prevData.connections || []).filter(\n      conn => conn.source !== fullNodeId && conn.target !== fullNodeId\n    );\n    const newData = {\n      ...prevData,\n      [collectionKey]: updatedCollection,\n      connections: updatedConnections,\n    };\n    autoSaveMindMapData(newData);\n    addToast(`${nodeType.charAt(0).toUpperCase() + nodeType.slice(1)} deleted.`, 'success');\n    return newData;\n  });\n  // Remove the node from the visual state\n  setNodes((nds) => nds.filter((node) => node.id !== fullNodeId));\n  // Remove edges referencing this node\n  setEdges((eds) => eds.filter((edge) => edge.source !== fullNodeId && edge.target !== fullNodeId));\n}, [setMindMapData, autoSaveMindMapData, addToast, setNodes, setEdges]);\n\n// Handle literature node click to open modal\nconst handleLiteratureClick = useCallback((literatureData) => {\n  setIsAnimating(true); // Set animation state\n  setLiteratureModal({ isOpen: true, data: literatureData });\n  // Clear animation state after modal animation completes\n  setTimeout(() => setIsAnimating(false), 700); // 600ms modal animation + 100ms buffer\n}, []);\n\n// Auto-sync node titles with modal form data\nconst syncNodeTitles = useCallback(() => {\n  setNodes(currentNodes => {\n    return currentNodes.map(node => {\n      const nodeType = node.id.split('-')[0];\n      const nodeId = node.id.split('-')[1];\n      \n      let newLabel = node.data.label;\n      \n      // Find the corresponding data item and sync title\n      if (nodeType === 'case') {\n        const caseData = mindMapData.cases?.find(c => c.id === nodeId);\n        if (caseData) {\n          newLabel = caseData.primaryDiagnosis || caseData.primary_diagnosis || caseData.title || 'Untitled Case';\n        }\n      } else if (nodeType === 'topic') {\n        const topicData = mindMapData.topics?.find(t => t.id === nodeId);\n        if (topicData) {\n          newLabel = topicData.title || 'Untitled Topic';\n        }\n      } else if (nodeType === 'task') {\n        const taskData = mindMapData.tasks?.find(t => t.id === nodeId);\n        if (taskData) {\n          newLabel = taskData.title || 'Untitled Task';\n        }\n      } else if (nodeType === 'literature') {\n        const literatureData = mindMapData.literature?.find(l => l.id === nodeId);\n        if (literatureData) {\n          newLabel = literatureData.title || 'Untitled Literature';\n        }\n      }\n      \n      // Only update if the label actually changed\n      if (newLabel !== node.data.label) {\n        return {\n          ...node,\n          data: {\n            ...node.data,\n            label: newLabel\n          }\n        };\n      }\n      \n      return node;\n    });\n  });\n}, [mindMapData, setNodes]);\n\n// Trigger auto-sync when mindMapData changes\nuseEffect(() => {\n  const hasData = mindMapData && (mindMapData.cases?.length > 0 || mindMapData.topics?.length > 0 || \n                                 mindMapData.tasks?.length > 0 || mindMapData.literature?.length > 0);\n  \n  if (hasData) {\n    syncNodeTitles();\n    \n    // If we don't have nodes but we have data, convert data to React Flow\n    if (nodes.length === 0) {\n      console.log('Converting data to React Flow nodes due to data change');\n      // Use a timeout to avoid dependency issues and ensure state is stable\n      setTimeout(() => {\n        convertDataToReactFlow(mindMapData, false); // CHANGED: Don't apply force layout automatically\n      }, 100);\n    }\n  }\n}, [mindMapData, syncNodeTitles, nodes.length]); // Removed convertDataToReactFlow from dependencies\n\n  const convertDataToReactFlow = useCallback(async (data, applyLayoutImmediately = false) => {\n    // Use optimized quick layout for initial load\n    const allItems = [\n      ...data.topics.map(item => ({ ...item, type: 'topic' })),\n      ...data.cases.map(item => ({ ...item, type: 'case' })),\n      ...data.tasks.map(item => ({ ...item, type: 'task' })),\n      ...data.literature.map(item => ({ ...item, type: 'literature' }))\n    ];\n\n    // If we have data and need immediate layout, apply force layout to positions\n    let layoutNodes;\n    \n    // Check if nodes already have positions - if they do, don't override with force layout\n    const hasExistingPositions = allItems.some(item => \n      item.position && typeof item.position.x === 'number' && typeof item.position.y === 'number'\n    );\n    \n    if (allItems.length > 0 && applyLayoutImmediately && !hasExistingPositions) {\n      try {\n        // Lazy load D3 force simulation for initial positioning\n        const { \n          forceSimulation, \n          forceManyBody, \n          forceLink, \n          forceCenter, \n          forceCollide \n        } = await loadD3Force();\n\n        // Create nodes for simulation\n        const simulationNodes = allItems.map((item, index) => ({\n          id: `${item.type}-${item.id}`,\n          x: item.position?.x || (Math.random() - 0.5) * 200,\n          y: item.position?.y || (Math.random() - 0.5) * 200,\n          type: item.type\n        }));\n\n        // Create D3-compatible edge objects\n        const d3Edges = (data.connections || []).map(edge => ({\n          source: edge.source,\n          target: edge.target,\n          id: edge.id\n        })).filter(edge => {\n          const nodeIds = new Set(simulationNodes.map(n => n.id));\n          return nodeIds.has(edge.source) && nodeIds.has(edge.target);\n        });\n\n        // Run simulation synchronously for initial layout\n        const simulation = forceSimulation(simulationNodes)\n          .force('link', forceLink(d3Edges).id(d => d.id).distance(200).strength(0.5))\n          .force('charge', forceManyBody().strength(-800).distanceMax(400))\n          .force('center', forceCenter(window.innerWidth / 3, window.innerHeight / 2))\n          .force('collision', forceCollide().radius(80))\n          .stop();\n\n        // Run enough ticks to get a good layout\n        for (let i = 0; i < 300; i++) {\n          simulation.tick();\n        }\n\n        // Create a map of positioned nodes\n        const positionMap = new Map();\n        simulationNodes.forEach(node => {\n          positionMap.set(node.id, { x: node.x, y: node.y });\n        });\n\n        layoutNodes = allItems.map(item => {\n          const nodeId = `${item.type}-${item.id}`;\n          const position = positionMap.get(nodeId) || { x: 0, y: 0 };\n          return { ...item, position };\n        });\n      } catch (error) {\n        console.warn('Failed to apply initial layout, using fallback positioning:', error);\n        layoutNodes = allItems;\n      }\n    } else {\n      layoutNodes = allItems;\n    }\n\n    // Quick layout without expensive calculations - ensure all nodes get proper positions\n    const quickNodes = (layoutNodes || allItems).map((item, index) => {\n      const nodeId = `${item.type}-${item.id}`;\n      \n      // Convert case fields efficiently\n      const nodeData = item.type === 'case' ? {\n        ...item,\n        chiefComplaint: item.chiefComplaint || item.chief_complaint || '',\n        initialPresentation: item.initialPresentation || item.initial_presentation || '',\n        currentPresentation: item.currentPresentation || item.current_presentation || '',\n        medicationHistory: item.medicationHistory || item.medication_history || '',\n        therapyProgress: item.therapyProgress || item.therapy_progress || '',\n        defensePatterns: item.defensePatterns || item.defense_patterns || '',\n        clinicalReflection: item.clinicalReflection || item.clinical_reflection || ''\n      } : item;\n\n      // Ensure proper positioning: use existing position, or create grid-based position\n      let position;\n      if (item.position && typeof item.position.x === 'number' && typeof item.position.y === 'number') {\n        position = item.position;\n      } else {\n        // Create grid-based layout for nodes without positions\n        const gridSize = Math.ceil(Math.sqrt(allItems.length));\n        const nodeSpacing = 250;\n        const offsetX = 300; // Offset from left sidebar\n        const offsetY = 150; // Offset from top\n        \n        position = {\n          x: (index % gridSize) * nodeSpacing + offsetX,\n          y: Math.floor(index / gridSize) * nodeSpacing + offsetY\n        };\n      }\n\n      return {\n        id: nodeId,\n        type: item.type,\n        position: position,\n        data: { \n          ...nodeData, \n          onDelete: () => handleDeleteNode(nodeId),\n          onLiteratureClick: item.type === 'literature' ? handleLiteratureClick : undefined,\n          skipAnimation: isInitialLoad // Use the isInitialLoad state\n        },\n      };\n    });\n\n    // Create optimized edges\n    const optimizedEdges = createOptimizedEdges(\n      data.connections || [], \n      quickNodes.map(n => n.id)\n    );\n\n    // Set nodes and edges immediately for fast UI response\n    setNodes(quickNodes);\n    setEdges(optimizedEdges);\n  }, [setNodes, setEdges, handleDeleteNode, handleLiteratureClick, isInitialLoad]);\n\n  const saveToBackend = useCallback(async (data) => {\n    // Deep clone the data to avoid modifying the original\n    const cleanData = {\n      topics: JSON.parse(JSON.stringify(data.topics || [])),\n      cases: JSON.parse(JSON.stringify(data.cases || [])),\n      tasks: JSON.parse(JSON.stringify(data.tasks || [])),\n      literature: JSON.parse(JSON.stringify(data.literature || [])),\n      connections: JSON.parse(JSON.stringify(data.connections || []))\n    };\n    \n    try {\n      \n      // Current timestamp for created_at/updated_at fields\n      const now = new Date().toISOString();\n      \n      // Clean and validate topics\n      cleanData.topics = cleanData.topics.map((topic, index) => {\n        // Ensure all required fields exist\n        return {\n          id: String(topic.id || `${Date.now()}-${index}-topic`),\n          title: topic.title || \"Untitled Topic\",\n          description: topic.description || \"\",\n          category: topic.category || \"Uncategorized\",\n          color: topic.color || \"#3B82F6\",\n          position: {\n            x: Number(topic.position?.x) || 0,\n            y: Number(topic.position?.y) || 0\n          },\n          flashcard_count: Number(topic.flashcard_count) || 0,\n          completed_flashcards: Number(topic.completed_flashcards) || 0,\n          resources: Array.isArray(topic.resources) ? topic.resources : [],\n          created_at: topic.created_at || now,\n          updated_at: now\n        };\n      });\n      \n      // Clean and validate cases\n      cleanData.cases = cleanData.cases.map((caseItem, index) => {\n        // Ensure all required fields exist, handle both camelCase and snake_case\n        return {\n          id: String(caseItem.id || `${Date.now()}-${index}-case`),\n          case_id: caseItem.case_id || `CASE-${Date.now()}-${index}`,\n          encounter_date: caseItem.encounter_date || now,\n          primary_diagnosis: caseItem.primary_diagnosis || \"Unspecified\",\n          secondary_diagnoses: Array.isArray(caseItem.secondary_diagnoses) ? caseItem.secondary_diagnoses : [],\n          age: caseItem.age !== undefined ? Number(caseItem.age) : null,\n          gender: caseItem.gender || null,\n          // Handle both camelCase (frontend) and snake_case (backend) field names\n          chief_complaint: caseItem.chiefComplaint || caseItem.chief_complaint || \"\",\n          initial_presentation: caseItem.initialPresentation || caseItem.initial_presentation || \"\",\n          current_presentation: caseItem.currentPresentation || caseItem.current_presentation || \"\",\n          medication_history: caseItem.medicationHistory || caseItem.medication_history || \"\",\n          therapy_progress: caseItem.therapyProgress || caseItem.therapy_progress || \"\",\n          defense_patterns: caseItem.defensePatterns || caseItem.defense_patterns || \"\",\n          clinical_reflection: caseItem.clinicalReflection || caseItem.clinical_reflection || \"\",\n          history_present_illness: caseItem.history_present_illness || null,\n          medical_history: caseItem.medical_history || null,\n          medications: Array.isArray(caseItem.medications) ? caseItem.medications : [],\n          mental_status_exam: caseItem.mental_status_exam || null,\n          assessment_plan: caseItem.assessment_plan || null,\n          notes: caseItem.notes || null,\n          status: caseItem.status || \"active\",\n          linked_topics: Array.isArray(caseItem.linked_topics) ? caseItem.linked_topics : [],\n          position: {\n            x: Number(caseItem.position?.x) || 0,\n            y: Number(caseItem.position?.y) || 0\n          },\n          created_at: caseItem.created_at || now,\n          updated_at: now\n        };\n      });\n      \n      // Clean and validate tasks\n      cleanData.tasks = cleanData.tasks.map((task, index) => {\n        // Ensure all required fields exist\n        return {\n          id: String(task.id || `${Date.now()}-${index}-task`),\n          title: task.title || \"Untitled Task\",\n          description: task.description || null,\n          status: task.status || \"pending\",\n          priority: task.priority || \"medium\",\n          due_date: task.due_date || null,\n          linked_case_id: task.linked_case_id || null,\n          linked_topic_id: task.linked_topic_id || null,\n          position: {\n            x: Number(task.position?.x) || 0,\n            y: Number(task.position?.y) || 0\n          },\n          created_at: task.created_at || now,\n          updated_at: now\n        };\n      });\n      \n      // Clean and validate literature\n      cleanData.literature = cleanData.literature.map((lit, index) => {\n        // Ensure all required fields exist\n        return {\n          id: String(lit.id || `${Date.now()}-${index}-lit`),\n          title: lit.title || \"Untitled Literature\",\n          authors: lit.authors || null,\n          publication: lit.publication || null,\n          year: lit.year !== undefined ? Number(lit.year) : null,\n          doi: lit.doi || null,\n          abstract: lit.abstract || null,\n          notes: lit.notes || null,\n          pdf_path: lit.pdf_path || null,\n          linked_topics: Array.isArray(lit.linked_topics) ? lit.linked_topics : [],\n          position: {\n            x: Number(lit.position?.x) || 0,\n            y: Number(lit.position?.y) || 0\n          },\n          created_at: lit.created_at || now,\n          updated_at: now\n        };\n      });\n      \n      // Clean and validate connections\n      cleanData.connections = cleanData.connections.map((conn, index) => {\n        // For connections, we only need these basic properties\n        return {\n          id: String(conn.id || `${Date.now()}-${index}-conn`),\n          source: conn.source || \"\",\n          target: conn.target || \"\",\n          label: conn.label || \"\"\n        };\n      });\n      \n      // Filter out any items with empty or invalid source/target\n      cleanData.connections = cleanData.connections.filter(conn => \n        conn.source && conn.target && \n        typeof conn.source === 'string' && \n        typeof conn.target === 'string' && \n        conn.source.length > 0 && \n        conn.target.length > 0\n      );\n      \n      console.log('Sending cleaned data to backend:', cleanData);\n      \n      const response = await axios.put(`${API}/mindmap-data`, cleanData, {\n        headers: { 'Content-Type': 'application/json' }\n      });\n      \n      console.log('Backend save successful:', response.data);\n    } catch (err) {\n      console.error('Failed to save to backend:', err.response?.data || err.message);\n      \n      // Log detailed validation errors\n      if (err.response?.status === 422 && err.response?.data?.detail) {\n        console.error('Validation errors:');\n        console.error(JSON.stringify(err.response.data.detail, null, 2));\n        \n        // Log the request data that caused the error\n        console.error('Request data that caused validation error:');\n        console.error(JSON.stringify(cleanData, null, 2));\n      }\n      \n      // Don't throw the error to prevent breaking the app\n    }\n  }, []);\n\n  const onConnect = useCallback((params) => {\n    const edgeId = `conn-${Date.now()}`;\n    const newEdge = { \n      ...params, \n      id: edgeId,\n      type: 'floating', // Use our high-performance floating edge type\n      style: { \n        strokeWidth: 2, \n        stroke: '#64748b',\n        opacity: 0.85,\n        transition: 'none' // Critical: disable transitions for immediate updates\n      },\n      // Add a unique timestamp to force React to re-render this edge when source or target nodes move\n      data: { __forceUpdate: Date.now() },\n      interactionWidth: 20 // Wider area for interaction\n    };\n    setEdges((eds) => addEdge(newEdge, eds));\n    setMindMapData(prev => {\n      const newConnections = [...prev.connections, { \n        id: newEdge.id, \n        source: params.source, \n        target: params.target, \n        label: '' \n      }];\n      const newData = { ...prev, connections: newConnections };\n      autoSaveMindMapData(newData);\n      return newData;\n    });\n  }, [setEdges, setMindMapData, autoSaveMindMapData]);\n\n  const onNodeClick = useCallback((event, node) => {\n    setSelectedNode(node);\n    // Visual feedback - highlight selected node\n    setNodes(currentNodes => currentNodes.map(n => ({\n      ...n,\n      selected: n.id === node.id\n    })));\n  }, [setNodes]);\n\n  const onNodeDoubleClick = useCallback((event, node) => {\n    const [type, id] = node.id.split('-');\n    \n    // Prevent multiple rapid clicks by checking if modal is already open\n    if (type === 'case' && caseModal.isOpen) return;\n    if (type === 'topic' && topicModal.isOpen) return;\n    if (type === 'task' && taskModal.isOpen) return;\n    if (type === 'literature' && literatureModal.isOpen) return;\n    \n    // Route to appropriate specialized modal based on node type\n    if (type === 'literature') {\n      const dataItem = mindMapData.literature.find(item => String(item.id) === id);\n      if (dataItem) {\n        setLiteratureModal({ isOpen: true, data: dataItem });\n      }\n      return;\n    }\n    \n    if (type === 'case') {\n      const dataItem = mindMapData.cases.find(item => String(item.id) === id);\n      if (dataItem) {\n        setModalAnimationStates(prev => ({ ...prev, case: true }));\n        setCaseModal({ isOpen: true, data: dataItem });\n        // Clear animation state after modal animation completes\n        setTimeout(() => {\n          setModalAnimationStates(prev => ({ ...prev, case: false }));\n        }, 800);\n      }\n      return;\n    }\n    \n    if (type === 'topic') {\n      const dataItem = mindMapData.topics.find(item => String(item.id) === id);\n      if (dataItem) {\n        setModalAnimationStates(prev => ({ ...prev, topic: true }));\n        setTopicModal({ isOpen: true, data: dataItem });\n        // Clear animation state after modal animation completes\n        setTimeout(() => {\n          setModalAnimationStates(prev => ({ ...prev, topic: false }));\n        }, 800);\n      }\n      return;\n    }\n    \n    if (type === 'task') {\n      const dataItem = mindMapData.tasks.find(item => String(item.id) === id);\n      if (dataItem) {\n        setModalAnimationStates(prev => ({ ...prev, task: true }));\n        setTaskModal({ isOpen: true, data: dataItem });\n        // Clear animation state after modal animation completes\n        setTimeout(() => {\n          setModalAnimationStates(prev => ({ ...prev, task: false }));\n        }, 800);\n      }\n      return;\n    }\n  }, [mindMapData, caseModal.isOpen, topicModal.isOpen, taskModal.isOpen, literatureModal.isOpen]);\n\n  const onEdgeDoubleClick = useCallback((event, edge) => {\n    // Double-click to delete edge immediately\n    setEdges(eds => eds.filter(e => e.id !== edge.id));\n    setMindMapData(prev => {\n      const newConnections = prev.connections.filter(conn => conn.id !== edge.id);\n      const newData = { ...prev, connections: newConnections };\n      autoSaveMindMapData(newData);\n      addToast('Connection deleted', 'success');\n      return newData;\n    });\n  }, [setEdges, setMindMapData, autoSaveMindMapData, addToast]);\n\n  const onEdgeContextMenu = useCallback((event, edge) => {\n    // Right-click to edit edge label\n    event.preventDefault();\n    setEdgeModal({ isOpen: true, edge: edge });\n  }, []);\n\n  const handleSaveEdgeLabel = useCallback((edgeId, label) => {\n    setEdges(eds =>\n      eds.map(edge =>\n        edge.id === edgeId ? { ...edge, label: label } : edge\n      )\n    );\n    setMindMapData(prev => {\n      const newConnections = prev.connections.map(conn =>\n        conn.id === edgeId ? { ...conn, label: label } : conn\n      );\n      const newData = { ...prev, connections: newConnections };\n      autoSaveMindMapData(newData);\n      return newData;\n    });\n  }, [setEdges, setMindMapData, autoSaveMindMapData]);\n\n  // Edge hover handlers for highlighting\n  const onEdgeMouseEnter = useCallback((event, edge) => {\n    setEdges(eds =>\n      eds.map(e =>\n        e.id === edge.id ? { ...e, className: 'highlighted' } : e\n      )\n    );\n  }, [setEdges]);\n\n  const onEdgeMouseLeave = useCallback((event, edge) => {\n    setEdges(eds =>\n      eds.map(e =>\n        e.id === edge.id ? { ...e, className: '' } : e\n      )\n    );\n  }, [setEdges]);\n\n  // Lazy-loaded force-directed layout for better performance\n  const forceLayout = useCallback(async () => {\n    if (nodes.length === 0) return;\n\n    try {\n      // Lazy load D3 force simulation\n      const { \n        forceSimulation, \n        forceManyBody, \n        forceLink, \n        forceCenter, \n        forceCollide \n      } = await loadD3Force();\n\n      // Preserve the current edges before layout\n      const currentEdges = [...edges];\n      \n      // Create a set of valid node IDs for fast lookup\n      const nodeIdSet = new Set(nodes.map(node => node.id));\n      \n      // Filter edges to only include those with both source and target nodes present\n      const validEdges = currentEdges.filter(edge => \n        nodeIdSet.has(edge.source) && nodeIdSet.has(edge.target)\n      );\n\n      // Create D3-compatible edge objects for the force simulation\n      const d3Edges = validEdges.map(edge => ({\n        source: edge.source,\n        target: edge.target,\n        id: edge.id\n      }));\n\n      // Create a copy of nodes for simulation (D3 mutates the objects)\n      const simulationNodes = nodes.map(node => ({ \n        id: node.id,\n        x: node.position.x, \n        y: node.position.y,\n        fx: null, // Remove any fixed positions\n        fy: null\n      }));\n\n      // Create simulation with optimized forces for mind map layout\n      const simulation = forceSimulation(simulationNodes)\n        .force('link', forceLink(d3Edges).id(d => d.id).distance(200).strength(0.5))\n        .force('charge', forceManyBody().strength(-800).distanceMax(400))\n        .force('center', forceCenter(window.innerWidth / 3, window.innerHeight / 2))\n        .force('collision', forceCollide().radius(80))\n        .stop();\n\n      // Run simulation in chunks to prevent blocking\n      const ticksPerFrame = 50;\n      const totalTicks = 400;\n      let currentTick = 0;\n\n      const runSimulationChunk = () => {\n        const remainingTicks = Math.min(ticksPerFrame, totalTicks - currentTick);\n        for (let i = 0; i < remainingTicks; i++) {\n          simulation.tick();\n        }\n        currentTick += remainingTicks;\n\n        if (currentTick < totalTicks) {\n          requestAnimationFrame(runSimulationChunk);\n        } else {\n          // Simulation complete, update nodes\n          const updatedNodes = simulationNodes.map(simNode => {\n            const originalNode = nodes.find(n => n.id === simNode.id);\n            return {\n              ...originalNode,\n              position: { x: simNode.x, y: simNode.y },\n            };\n          });\n          \n          // Update both nodes and edges in a single batch\n          setNodes(updatedNodes);\n          setEdges(validEdges);\n\n          // Update mindMapData with new positions\n          setMindMapData(currentData => {\n            const updatedData = { ...currentData };\n            \n            updatedNodes.forEach(node => {\n              const [type, id] = node.id.split('-');\n              const key = type === 'literature' ? 'literature' : `${type}s`;\n              const item = updatedData[key]?.find(i => String(i.id) === id);\n              if (item) {\n                item.position = node.position;\n              }\n            });\n            \n            return updatedData;\n          });\n\n          // Smooth camera transition to fit the new layout\n          setTimeout(() => {\n            fitView({ duration: 800, padding: 0.2 });\n          }, 200);\n        }\n      };\n\n      // Start simulation in next frame\n      requestAnimationFrame(runSimulationChunk);\n    } catch (error) {\n      console.error('Force layout failed:', error);\n      addToast('Layout calculation failed', 'error');\n    }\n  }, [nodes, edges, setNodes, setEdges, setMindMapData, fitView, addToast]);\n\n  // applyForceLayout wrapper function (defined after forceLayout)\n  const applyForceLayout = useCallback(() => {\n    try {\n      forceLayout();\n      addToast('Nodes realigned successfully', 'success');\n    } catch (error) {\n      console.error('Force layout error:', error);\n      addToast('Failed to realign nodes', 'error');\n    }\n  }, [forceLayout, addToast]);\n\n  const handleClearMap = useCallback(() => {\n    if (!window.confirm('Are you sure you want to clear the entire mind map?')) return;\n\n    const empty = { topics: [], cases: [], tasks: [], literature: [], connections: [] };\n    setMindMapData(empty);\n    setNodes([]);\n    setEdges([]);\n    setSelectedNode(null);\n    // Clear all modal states\n    setCaseModal({ isOpen: false, data: null });\n    setTopicModal({ isOpen: false, data: null });\n    setTaskModal({ isOpen: false, data: null });\n    setLiteratureModal({ isOpen: false, data: null });\n    setFocusedCategory(null);\n    autoSaveMindMapData(empty);\n    addToast('Mind map cleared successfully', 'success');\n  }, [setNodes, setEdges, autoSaveMindMapData, addToast]);\n\n  const handleNodesChange = useCallback((changes) => {\n    // Apply the node changes to React Flow state immediately - this is critical!\n    onNodesChange(changes);\n    \n    // Skip heavy operations during animations to prevent interference\n    if (isAnimating) {\n      console.log('Skipping position updates during animation');\n      return;\n    }\n\n\n    \n    // Process position changes for data persistence - SIMPLIFIED\n    const positionChanges = changes.filter(change => \n      change.type === 'position' && change.position\n    );\n    \n    if (positionChanges.length > 0) {\n      console.log('Processing position changes:', positionChanges);\n      \n      // Update mindMapData immediately without complex debouncing\n      setMindMapData(currentData => {\n        const updatedData = { ...currentData };\n        \n        positionChanges.forEach(change => {\n          if (change.position) {\n            const [type, id] = change.id.split('-');\n            const key = type === 'literature' ? 'literature' : `${type}s`;\n            const item = updatedData[key]?.find(i => String(i.id) === id);\n            \n            if (item) {\n              item.position = { ...change.position };\n              console.log(`Updated ${type} ${id} position to:`, change.position);\n            }\n          }\n        });\n        \n        // Save to localStorage immediately\n        localStorageUtils.save(updatedData, null, null, false);\n        \n        return updatedData;\n      });\n      \n      // Simple auto-save without complex timeouts\n      setTimeout(() => {\n        autoSaveMindMapData(mindMapData);\n      }, 500);\n    }\n  }, [onNodesChange, setMindMapData, isAnimating, autoSaveMindMapData, mindMapData]);\n\n  const handleNodeDragStop = useCallback((event, node) => {\n    // Debounce the auto-save to prevent excessive backend calls\n    // Position updates are already handled in handleNodesChange during dragging\n    clearTimeout(window.dragSaveTimeout);\n    window.dragSaveTimeout = setTimeout(() => {\n      setMindMapData(currentData => {\n        autoSaveMindMapData(currentData);\n        return currentData;\n      });\n    }, 500);\n  }, [autoSaveMindMapData]);\n\n  const loadMindMapData = useCallback(async () => {\n    setLoading(true);\n    setLoadingProgress(10);\n    setLoadingMessage('Checking local data...');\n    \n    try {\n      // First, try loading from localStorage for instant startup\n      const local = localStorageUtils.load();\n      if (local) {\n        setLoadingProgress(30);\n        setLoadingMessage('Loading from cache...');\n        \n        if (!local.connections) local.connections = [];\n        setMindMapData(local);\n        \n        setLoadingProgress(60);\n        setLoadingMessage('Applying layout...');\n        \n        await convertDataToReactFlow(local, true); // Apply layout immediately\n        \n        setLoadingProgress(90);\n        setLoadingMessage('Finalizing...');\n        \n        setLoading(false);\n        setIsInitialLoad(false);\n        setLoadingProgress(100);\n        \n        // Background sync with backend without blocking UI\n        setTimeout(async () => {\n          try {\n            const response = await axios.get(`${API}/mindmap-data`);\n            if (JSON.stringify(response.data) !== JSON.stringify(local)) {\n              // Only update if data has changed\n              if (!response.data.connections) response.data.connections = [];\n              setMindMapData(response.data);\n              await convertDataToReactFlow(response.data);\n              autoSaveMindMapData(response.data);\n              addToast('Data synchronized with server', 'info');\n            }\n          } catch (err) {\n            console.warn('Background sync failed:', err);\n          }\n        }, 500);\n        \n        return;\n      }\n\n      // If no local data, load from backend\n      setLoadingProgress(20);\n      setLoadingMessage('Loading from server...');\n      \n      try {\n        const response = await axios.get(`${API}/mindmap-data`);\n        if (!response.data.connections) response.data.connections = [];\n        \n        setLoadingProgress(50);\n        setLoadingMessage('Processing data...');\n        \n        setMindMapData(response.data);\n        \n        setLoadingProgress(80);\n        setLoadingMessage('Applying layout...');\n        \n        await convertDataToReactFlow(response.data, true); // Apply layout immediately\n        autoSaveMindMapData(response.data);\n        \n        setLoadingProgress(100);\n        setLoading(false);\n        setIsInitialLoad(false);\n      } catch (backendError) {\n        console.warn('Backend loading failed, populating with sample data:', backendError);\n        \n        // If backend fails, populate with sample data for better UX\n        setLoadingProgress(60);\n        setLoadingMessage('Loading sample data...');\n        \n        // Populate sample data\n        const emptyData = { topics: [], cases: [], tasks: [], literature: [], connections: [] };\n        \n        setMindMapData(emptyData);\n        \n        // Populate sample data\n        setTimeout(() => {\n          populateSampleLiteratureData(setMindMapData, autoSaveMindMapData, addToast);\n        }, 100);\n        \n        setLoadingProgress(100);\n        setLoading(false);\n        setIsInitialLoad(false);\n      }\n    } catch (err) {\n      console.error('Error loading mind map:', err);\n      addToast('Failed to load mind map', 'error');\n      setLoading(false);\n      setIsInitialLoad(false);\n    }\n  }, [addToast, autoSaveMindMapData, convertDataToReactFlow]);\n\n  useEffect(() => {\n    // Load initial mind map data\n    loadMindMapData();\n    \n    // Load templates from a source (e.g., API or localStorage)\n    // For now, using mock data\n    setTemplates([\n      { id: 'template1', name: 'Schizophrenia Workup', nodeType: 'case', data: { primary_diagnosis: 'Schizophrenia', chief_complaint: 'Auditory hallucinations' } },\n      { id: 'template2', name: 'MDD Follow-up', nodeType: 'case', data: { primary_diagnosis: 'Major Depressive Disorder', status: 'follow_up' } },\n      { id: 'template3', name: 'CBT for Anxiety', nodeType: 'topic', data: { title: 'CBT for Anxiety', category: 'Anxiety Disorders' } }\n    ]);\n  }, []); // Run only once on mount\n\n  // Helper function to check if a node matches the search query\n  const nodeMatchesSearch = useCallback((node, query) => {\n    // Guard against null/undefined node\n    if (!node || !node.id || !node.data) return false;\n    \n    // Return early if no query\n    if (!query) return true;\n    \n    // Normalize and trim query\n    const searchTerm = query.toLowerCase().trim();\n    if (!searchTerm) return true;\n    \n    try {\n      // Safely extract node type and ID\n      const parts = node.id.split('-');\n      const nodeType = parts.length > 0 ? parts[0] : '';\n      const nodeId = parts.length > 1 ? parts[1] : '';\n      \n      // Start with no match\n      let hasMatch = false;\n      \n      // 1. Basic title/label matching - most common searches\n      if (!hasMatch && node.data.label) {\n        const label = node.data.label.toLowerCase();\n        hasMatch = label.includes(searchTerm);\n      }\n      \n      // 2. Node type matching\n      if (!hasMatch && nodeType) {\n        hasMatch = nodeType.includes(searchTerm);\n      }\n      \n      // 3. Case ID pattern matching for case nodes\n      if (!hasMatch && nodeType === 'case' && nodeId) {\n        hasMatch = (`case-${nodeId}`).toLowerCase().includes(searchTerm);\n      }\n      \n      // 4. Type-specific content matching\n      if (!hasMatch) {\n        if (nodeType === 'case') {\n          const diagnosis = (node.data.primary_diagnosis || node.data.primaryDiagnosis || '').toLowerCase();\n          hasMatch = diagnosis.includes(searchTerm);\n        } else if (nodeType === 'topic') {\n          const title = (node.data.title || '').toLowerCase();\n          hasMatch = title.includes(searchTerm);\n        } else if (nodeType === 'literature') {\n          const title = (node.data.title || '').toLowerCase();\n          const authors = (node.data.authors || '').toLowerCase();\n          hasMatch = title.includes(searchTerm) || authors.includes(searchTerm);\n        }\n      }\n      \n      // 5. Psychiatric category matching for all node types\n      if (!hasMatch && node.data.category) {\n        const category = node.data.category.toLowerCase();\n        hasMatch = category.includes(searchTerm);\n      }\n      \n      return hasMatch;\n    } catch (error) {\n      console.error('Error in nodeMatchesSearch for node:', node.id, error);\n      return false;\n    }\n  }, []);\n\n  // Keyboard shortcuts\n  useEffect(() => {\n    const handleKeyDown = (event) => {\n      // Only trigger shortcuts when not typing in input fields\n      if (event.target.tagName === 'INPUT' || event.target.tagName === 'TEXTAREA') return;\n      \n      if (event.ctrlKey || event.metaKey) {\n        switch (event.key) {\n          case 'n':\n            event.preventDefault();\n            setShowNodeSelector(true);\n            break;\n          case 'e':\n            event.preventDefault();\n            setIsEditing(!isEditing);\n            break;\n          case 'r':\n            event.preventDefault();\n            applyForceLayout();\n            break;\n          case 'f':\n            event.preventDefault();\n            // Focus the search box\n            document.querySelector('input[type=\"text\"][placeholder*=\"Search\"]')?.focus();\n            break;\n          default:\n            break;\n        }\n      }\n      \n      if (event.key === 'Escape') {\n        setSelectedNode(null);\n        // Close all modals\n        setCaseModal({ isOpen: false, data: null });\n        setTopicModal({ isOpen: false, data: null });\n        setTaskModal({ isOpen: false, data: null });\n        setLiteratureModal({ isOpen: false, data: null });\n        setShowNodeSelector(false);\n        setIsTemplateManagerOpen(false);\n        \n        // Clear search if no modals are open\n        if (!caseModal.isOpen && !topicModal.isOpen && !taskModal.isOpen && \n            !literatureModal.isOpen && !showNodeSelector && !isTemplateManagerOpen) {\n          // Search functionality removed\n        }\n      }\n    };\n\n    window.addEventListener('keydown', handleKeyDown);\n    return () => window.removeEventListener('keydown', handleKeyDown);\n  }, [isEditing, applyForceLayout, caseModal, topicModal, taskModal, literatureModal, showNodeSelector, isTemplateManagerOpen]);\n\n  useEffect(() => {\n    // DISABLED automatic force layout to prevent overriding individual node positions\n    // Force layout should only be applied manually via \"Realign Nodes\" button\n    if (isReactFlowReady && !hasAppliedInitialLayout && nodes.length > 0) {\n      // Just mark as applied without applying force layout \n      setHasAppliedInitialLayout(true);\n    } else if (isInitialLoad && nodes.length > 0) {\n      // For initial load, just mark as applied since layout was already done in convertDataToReactFlow\n      setHasAppliedInitialLayout(true);\n    }\n  }, [isReactFlowReady, hasAppliedInitialLayout, nodes, isInitialLoad]); // Removed forceLayout from dependencies\n\n  // Simplified search and category filtering - no style interference\n  useEffect(() => {\n    if (nodes.length === 0) return;\n    \n    // Skip during animations to prevent interference\n    const anyModalAnimating = Object.values(modalAnimationStates).some(state => state);\n    if (isAnimating || anyModalAnimating) return;\n    \n  }, [focusedCategory, nodes, nodeMatchesSearch, isAnimating, modalAnimationStates]);\n  \n  // CSS-based search filtering - no direct style manipulation\n  useEffect(() => {\n    if (!isReactFlowReady) return;\n    \n    // Apply CSS classes instead of direct style manipulation\n    const styleSheet = document.getElementById('search-filter-styles') || document.createElement('style');\n    styleSheet.id = 'search-filter-styles';\n    \n    if (!document.getElementById('search-filter-styles')) {\n      document.head.appendChild(styleSheet);\n    }\n    \n    // Generate CSS for search filtering\n    let css = `\n      /* Default node styling */\n      .react-flow__node {\n        transition: opacity 0.3s ease, transform 0.3s ease, filter 0.3s ease !important;\n      }\n      \n      /* Search dimmed nodes */\n      .react-flow__node.search-dimmed {\n        opacity: 0.15 !important;\n        filter: grayscale(0.7) !important;\n        transform: scale(0.9) !important;\n      }\n      \n      /* Selected node highlighting */\n      .react-flow__node.search-selected {\n        box-shadow: 0 0 0 2px #10b981, 0 0 20px rgba(16, 185, 129, 0.6) !important;\n        z-index: 1000 !important;\n      }\n      \n      /* Ensure dragging still works */\n      .react-flow__node.search-dimmed {\n        pointer-events: auto !important;\n      }\n    `;\n    \n    styleSheet.textContent = css;\n    \n  }, [isReactFlowReady]);\n\n  // Optionally: handle layout setup on first render if needed\n\n  // Show optimized loading screen during initial load\n  if (loading) {\n    return <OptimizedLoadingScreen message={loadingMessage} progress={loadingProgress} />;\n  }\n\n  // Sophisticated Animation Variants (matching Literature modal quality)\n  const modalVariants = {\n    hidden: {\n      opacity: 0,\n      scale: 0.3,\n      y: 50,\n      rotate: -5,\n    },\n    visible: {\n      opacity: 1,\n      scale: 1,\n      y: 0,\n      rotate: 0,\n      transition: {\n        type: \"spring\",\n        damping: 25,\n        stiffness: 300,\n        duration: 0.6,\n      }\n    },\n    exit: {\n      opacity: 0,\n      scale: 0.7,\n      y: 30,\n      rotate: -3,\n      transition: {\n        type: \"easeInOut\",\n        duration: 0.4,\n      }\n    }\n  };\n\n  const backdropVariants = {\n    hidden: { opacity: 0 },\n    visible: { \n      opacity: 1,\n      transition: { duration: 0.3 }\n    },\n    exit: { \n      opacity: 0,\n      transition: { duration: 0.4 }\n    }\n  };\n\n  const contentVariants = {\n    hidden: {\n      opacity: 0,\n      y: 20,\n      scale: 0.95,\n    },\n    visible: {\n      opacity: 1,\n      y: 0,\n      scale: 1,\n      transition: {\n        type: \"easeOut\",\n        duration: 0.3,\n        delay: 0.1,\n      }\n    },\n    exit: {\n      opacity: 0,\n      y: -10,\n      scale: 1.02,\n      transition: {\n        type: \"easeIn\",\n        duration: 0.2,\n      }\n    }\n  };\n\n  const buttonVariants = {\n    inactive: {\n      scale: 1,\n    },\n    active: {\n      scale: 1.05,\n      transition: {\n        type: \"spring\",\n        damping: 20,\n        stiffness: 300,\n      }\n    },\n    hover: {\n      scale: 1.03,\n      transition: {\n        type: \"easeOut\",\n        duration: 0.2,\n      }\n    }\n  };\n\n  // All modal components are now imported from separate files\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 flex\">\n      {/* --- Left Sidebar --- */}\n      <div className=\"w-80 bg-gradient-to-b from-slate-800 to-slate-900 text-white p-6 shadow-2xl flex flex-col\">\n        <div className=\"mb-8\">\n          <div className=\"text-3xl font-bold tracking-wide text-white\">PGY-3 HQ</div>\n          <div className=\"text-sm text-slate-300 mt-2\">Psychiatry Resident Dashboard</div>\n        </div>\n\n        {/* --- Category Filters --- */}\n        <div className=\"mb-6\">\n          <h3 className=\"text-sm font-semibold text-slate-300 mb-3\">Filter by Category</h3>\n          <div className=\"grid grid-cols-2 gap-2\">\n            <button\n              onClick={() => setFocusedCategory(null)}\n              className={`px-3 py-2 rounded-lg text-xs transition-all ${\n                focusedCategory === null\n                  ? 'bg-teal-600 text-white'\n                  : 'bg-slate-700 text-slate-300 hover:bg-slate-600'\n              }`}\n            >\n              All\n            </button>\n            <button\n              onClick={() => setFocusedCategory('topic')}\n              className={`px-3 py-2 rounded-lg text-xs transition-all flex items-center gap-1 ${\n                focusedCategory === 'topic'\n                  ? 'bg-blue-600 text-white'\n                  : 'bg-slate-700 text-slate-300 hover:bg-slate-600'\n              }`}\n            >\n              <Brain size={12} />\n              Topics\n            </button>\n            <button\n              onClick={() => setFocusedCategory('case')}\n              className={`px-3 py-2 rounded-lg text-xs transition-all flex items-center gap-1 ${\n                focusedCategory === 'case'\n                  ? 'bg-indigo-600 text-white'\n                  : 'bg-slate-700 text-slate-300 hover:bg-slate-600'\n              }`}\n            >\n              <Users size={12} />\n              Cases\n            </button>\n            <button\n              onClick={() => setFocusedCategory('task')}\n              className={`px-3 py-2 rounded-lg text-xs transition-all flex items-center gap-1 ${\n                focusedCategory === 'task'\n                  ? 'bg-amber-600 text-white'\n                  : 'bg-slate-700 text-slate-300 hover:bg-slate-600'\n              }`}\n            >\n              <CheckSquare size={12} />\n              Tasks\n            </button>\n            <button\n              onClick={() => setFocusedCategory('literature')}\n              className={`px-3 py-2 rounded-lg text-xs transition-all flex items-center gap-1 ${\n                focusedCategory === 'literature'\n                  ? 'bg-purple-600 text-white'\n                  : 'bg-slate-700 text-slate-300 hover:bg-slate-600'\n              }`}\n            >\n              <BookOpen size={12} />\n              Literature\n            </button>\n          </div>\n        </div>\n\n        {/* --- Auto-save Status --- */}\n        <div className=\"mb-4 p-3 bg-slate-700 bg-opacity-50 rounded-lg\">\n          <div className=\"flex items-center gap-2 text-xs\">\n            {isSaving ? (\n              <>\n                <Loader2 size={12} className=\"animate-spin\" />\n                <span className=\"text-amber-300\">Saving...</span>\n              </>\n            ) : lastSaved ? (\n              <>\n                <CheckCircle size={12} className=\"text-green-400\" />\n                <span className=\"text-slate-300\">\n                  Last saved: {lastSaved.toLocaleTimeString()}\n                </span>\n              </>\n            ) : (\n              <>\n                <Cloud size={12} className=\"text-slate-400\" />\n                <span className=\"text-slate-400\">Auto-save enabled</span>\n              </>\n            )}\n          </div>\n        </div>\n\n        {/* --- Controls --- */}\n        <div className=\"space-y-3 mb-6\">\n          <LoadingButton onClick={applyForceLayout} icon={Shuffle} className=\"w-full bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-md text-sm\">\n            Realign Nodes\n          </LoadingButton>\n          <LoadingButton onClick={() => setIsTemplateManagerOpen(true)} icon={Bookmark} className=\"w-full bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-md text-sm\">\n            Manage Templates\n          </LoadingButton>\n          <LoadingButton \n            onClick={() => populateSampleLiteratureData(setMindMapData, autoSaveMindMapData, addToast)} \n            icon={BookOpen} \n            className=\"w-full bg-emerald-600 hover:bg-emerald-700 text-white px-4 py-2 rounded-md text-sm\"\n          >\n            Add Sample Literature\n          </LoadingButton>\n          <LoadingButton onClick={() => setIsEditing(!isEditing)} icon={isEditing ? Save : Edit3} className={`w-full px-4 py-2 rounded-md text-sm ${isEditing ? 'bg-teal-600' : 'bg-slate-600'}`}>\n            {isEditing ? 'Exit Edit Mode' : 'Edit Mind Map'}\n          </LoadingButton>\n          <LoadingButton onClick={() => setShowNodeSelector(true)} icon={Plus} className=\"w-full bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md text-sm\">\n            Add New Node\n          </LoadingButton>\n          <LoadingButton onClick={handleClearMap} icon={Trash2} className=\"w-full bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-md text-sm\">\n            Clear All Data\n          </LoadingButton>\n        </div>\n\n        {/* --- Selected Node Panel --- */}\n        {selectedNode && (\n          <div className=\"mt-auto p-4 bg-slate-700 bg-opacity-50 rounded-lg\">\n            <h3 className=\"text-sm font-semibold text-slate-300 mb-2\">Selected Node</h3>\n            <div className=\"space-y-2\">\n              <div className=\"flex items-center gap-2\">\n                {selectedNode.type === 'topic' && <Brain size={14} className=\"text-blue-400\" />}\n                {selectedNode.type === 'case' && <Users size={14} className=\"text-indigo-400\" />}\n                {selectedNode.type === 'task' && <CheckSquare size={14} className=\"text-amber-400\" />}\n                {selectedNode.type === 'literature' && <BookOpen size={14} className=\"text-purple-400\" />}\n                <span className=\"text-sm text-white font-medium truncate\">\n                  {selectedNode.data.label}\n                </span>\n              </div>\n              {selectedNode.data.category && (\n                <div className=\"text-xs text-slate-400\">\n                  Category: {selectedNode.data.category}\n                </div>\n              )}\n              {selectedNode.data.status && (\n                <div className=\"text-xs text-slate-400\">\n                  Status: {selectedNode.data.status}\n                </div>\n              )}\n              <button\n                onClick={() => {\n                  const [type, id] = selectedNode.id.split('-');\n                  const key = type === 'literature' ? 'literature' : `${type}s`;\n                  const dataItem = mindMapData[key].find(item => String(item.id) === id);\n                  if (dataItem) {\n                    // Route to appropriate specialized modal\n                    if (type === 'case') {\n                      setCaseModal({ isOpen: true, data: dataItem });\n                    } else if (type === 'topic') {\n                      setTopicModal({ isOpen: true, data: dataItem });\n                    } else if (type === 'task') {\n                      setTaskModal({ isOpen: true, data: dataItem });\n                    } else if (type === 'literature') {\n                      handleLiteratureClick(dataItem);\n                    }\n                  }\n                }}\n                className=\"w-full mt-2 px-3 py-2 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded-lg transition-colors flex items-center gap-2\"\n              >\n                <Eye size={12} />\n                View Details\n              </button>\n            </div>\n          </div>\n        )}\n\n        {/* --- Keyboard Shortcuts Help --- */}\n        {!selectedNode && (\n          <div className=\"mt-auto p-3 bg-slate-700 bg-opacity-30 rounded-lg\">\n            <h4 className=\"text-xs font-semibold text-slate-300 mb-2\">Keyboard Shortcuts</h4>\n            <div className=\"space-y-1 text-xs text-slate-400\">\n              <div>Ctrl+N - Add Node</div>\n              <div>Ctrl+E - Toggle Edit Mode</div>\n              <div>Ctrl+R - Realign Nodes</div>\n              <div>Esc - Clear Selection</div>\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* --- Main Mind Map Workspace --- */}\n      <div className=\"flex-1 relative\">\n        <ReactFlowErrorBoundary>\n          <ReactFlow\n            nodes={nodes}\n            edges={edges}\n            onNodesChange={handleNodesChange}\n            onEdgesChange={onEdgesChange}\n            onConnect={onConnect}\n            onNodeClick={onNodeClick}\n            onNodeDoubleClick={onNodeDoubleClick}\n            onNodeDragStop={handleNodeDragStop}\n            onEdgeDoubleClick={onEdgeDoubleClick}\n            onEdgeContextMenu={onEdgeContextMenu}\n            onEdgeMouseEnter={onEdgeMouseEnter}\n            onEdgeMouseLeave={onEdgeMouseLeave}\n            nodeTypes={nodeTypes}\n            edgeTypes={{ floating: FloatingEdge, enhanced: EnhancedEdge }}\n            nodesDraggable={true}\n            nodesConnectable={isEditing}\n            elementsSelectable={true}\n            onInit={(reactFlowInstance) => {\n              setIsReactFlowReady(true);\n              // Store reference for error recovery\n              window.reactFlowInstance = reactFlowInstance;\n            }}\n            onError={(id, message) => {\n              console.warn('React Flow Error:', id, message);\n              // Ignore dimension-related errors during animations\n              if (isAnimating && message.includes('dimensions')) {\n                return;\n              }\n            }}\n            fitView\n            snapToGrid={false}\n            snapGrid={[15, 15]}\n            elevateEdgesOnSelect={false}\n            connectionLineComponent={ConnectionLine}\n          connectionLineStyle={{\n            stroke: '#3b82f6', // Use a bright blue color for better visibility during connection\n            strokeWidth: 3.5, // Slightly thicker than regular edges\n            opacity: 0.9,\n            strokeLinecap: 'round',\n            strokeDasharray: '5,3', // Shorter dash pattern for more modern look\n            filter: 'drop-shadow(0 0 6px rgba(59, 130, 246, 0.6))', // Softer glow\n            animation: 'flowingDash 1s linear infinite' // Add flowing animation\n          }}\n          defaultEdgeOptions={{\n            type: 'enhanced', // Use our enhanced edge with proper prop handling\n            style: { \n              strokeWidth: 2.5, \n              stroke: '#64748b',\n              opacity: 0.9,\n              strokeLinecap: 'round',\n              transition: 'none'\n            }\n            // Remove pathOptions - this is not a standard React Flow prop\n          }}\n          className=\"bg-gradient-to-br from-blue-50 to-indigo-100\"\n        >\n          <Background color=\"#aaa\" gap={16} />\n          <Controls />\n          <MiniMap />\n        </ReactFlow>\n        </ReactFlowErrorBoundary>\n      </div>\n      \n      {/* --- Modals --- */}\n      {isTemplateManagerOpen && (\n        <TemplateManager\n          isOpen={isTemplateManagerOpen}\n          onClose={() => setIsTemplateManagerOpen(false)}\n          templates={templates}\n          setTemplates={setTemplates}\n        />\n      )}\n      \n      {/* Literature Modal */}\n      {literatureModal.isOpen && (\n        <LiteratureModal\n          isOpen={literatureModal.isOpen}\n          onClose={() => {\n            setIsAnimating(true); // Set animation state for closing\n            setLiteratureModal({ isOpen: false, data: null });\n            // Clear animation state after modal close animation completes\n            setTimeout(() => setIsAnimating(false), 500); // 400ms close animation + 100ms buffer\n          }}\n          onAnimationStart={() => setIsAnimating(true)}\n          onAnimationEnd={() => setIsAnimating(false)}\n          literatureData={literatureModal.data}\n          allNodes={nodes}\n          connections={mindMapData.connections || []}\n          setMindMapData={setMindMapData}\n          autoSaveMindMapData={autoSaveMindMapData}\n          addToast={addToast}\n        />\n      )}\n      {showNodeSelector && (\n        <NodeSelector\n          isOpen={showNodeSelector}\n          onClose={() => setShowNodeSelector(false)}\n          onSelect={(nodeType, templateId) => {\n            setShowNodeSelector(false);\n            const dataId = Date.now();\n            const id = `${nodeType}-${dataId}`;\n            \n            // Create node data object with appropriate fields based on type\n            let nodeData = { id: dataId, label: `New ${nodeType}` };\n            \n            // For case nodes, add structured fields\n            if (nodeType === 'case') {\n              nodeData = {\n                ...nodeData,\n                chiefComplaint: '',\n                initialPresentation: '',\n                currentPresentation: '',\n                medicationHistory: '',\n                therapyProgress: '',\n                defensePatterns: '',\n                clinicalReflection: ''\n              };\n            }\n            \n            // Calculate grid-based position for new nodes to avoid clustering\n            // Use current data count instead of nodes.length for more accurate positioning\n            const currentDataCount = (mindMapData.topics?.length || 0) + \n                                   (mindMapData.cases?.length || 0) + \n                                   (mindMapData.tasks?.length || 0) + \n                                   (mindMapData.literature?.length || 0);\n            \n            const gridSize = Math.ceil(Math.sqrt(currentDataCount + 1));\n            const nodeSpacing = 280;\n            const offsetX = 400; // Offset from left sidebar\n            const offsetY = 150; // Offset from top\n            \n            const gridPosition = {\n              x: (currentDataCount % gridSize) * nodeSpacing + offsetX,\n              y: Math.floor(currentDataCount / gridSize) * nodeSpacing + offsetY\n            };\n            \n            const newNode = {\n              id,\n              type: nodeType,\n              position: gridPosition,\n              data: { ...nodeData, onDelete: () => handleDeleteNode(id) }\n            };\n\n            setMindMapData(d => {\n              const key = nodeType === 'literature' ? 'literature' : `${nodeType}s`;\n              const dataToAdd = { ...newNode.data, position: newNode.position };\n              delete dataToAdd.onDelete;\n              const updatedData = {\n                ...d,\n                [key]: [...(d[key] || []), dataToAdd]\n              };\n              autoSaveMindMapData(updatedData);\n              return updatedData;\n            });\n\n            setNodes(n => n.concat(newNode));\n          }}\n          templates={templates}\n        />\n      )}\n\n      {/* Specialized Modals with optimized rendering */}\n      <AnimatePresence mode=\"wait\">\n        {caseModal.isOpen && (\n          <CaseModal \n            key={`case-modal-${caseModal.data?.id || 'default'}`}\n            isOpen={caseModal.isOpen} \n            data={caseModalStableData.current || caseModal.data} \n            onClose={() => {\n              setModalAnimationStates(prev => ({ ...prev, case: true }));\n              setCaseModal({ isOpen: false, data: null });\n            }}\n            onAnimationStart={() => {\n              setIsAnimating(true);\n              setModalAnimationStates(prev => ({ ...prev, case: true }));\n            }}\n            onAnimationEnd={() => {\n              setIsAnimating(false);\n              setModalAnimationStates(prev => ({ ...prev, case: false }));\n            }}\n            setMindMapData={setMindMapData}\n            autoSaveMindMapData={autoSaveMindMapData}\n            addToast={addToast}\n          />\n        )}\n      </AnimatePresence>\n      \n      <AnimatePresence mode=\"wait\">\n        {topicModal.isOpen && (\n          <TopicModal \n            key={`topic-modal-${topicModal.data?.id || 'default'}`}\n            isOpen={topicModal.isOpen} \n            data={topicModalStableData.current || topicModal.data} \n            onClose={() => {\n              setModalAnimationStates(prev => ({ ...prev, topic: true }));\n              setTopicModal({ isOpen: false, data: null });\n            }}\n            onAnimationStart={() => {\n              setIsAnimating(true);\n              setModalAnimationStates(prev => ({ ...prev, topic: true }));\n            }}\n            onAnimationEnd={() => {\n              setIsAnimating(false);\n              setModalAnimationStates(prev => ({ ...prev, topic: false }));\n            }}\n            setMindMapData={setMindMapData}\n            autoSaveMindMapData={autoSaveMindMapData}\n            addToast={addToast}\n          />\n        )}\n      </AnimatePresence>\n      \n      <AnimatePresence mode=\"wait\">\n        {taskModal.isOpen && (\n          <TaskModal \n            key={`task-modal-${taskModal.data?.id || 'default'}`}\n            isOpen={taskModal.isOpen} \n            data={taskModalStableData.current || taskModal.data} \n            onClose={() => {\n              setModalAnimationStates(prev => ({ ...prev, task: true }));\n              setTaskModal({ isOpen: false, data: null });\n            }}\n            onAnimationStart={() => {\n              setIsAnimating(true);\n              setModalAnimationStates(prev => ({ ...prev, task: true }));\n            }}\n            onAnimationEnd={() => {\n              setIsAnimating(false);\n              setModalAnimationStates(prev => ({ ...prev, task: false }));\n            }}\n            setMindMapData={setMindMapData}\n            autoSaveMindMapData={autoSaveMindMapData}\n            addToast={addToast}\n          />\n        )}\n      </AnimatePresence>\n\n      <EdgeLabelModal \n        isOpen={edgeModal.isOpen} \n        edge={edgeModal.edge} \n        onClose={() => setEdgeModal({ isOpen: false, edge: null })} \n        onSave={handleSaveEdgeLabel} \n      />\n\n      {loading && (\n        <div className=\"absolute inset-0 bg-white bg-opacity-80 flex items-center justify-center z-50\">\n          <Loader2 size={48} className=\"animate-spin text-blue-600\" />\n        </div>\n      )}\n      \n      {toasts.map(toast => (\n        <Toast\n          key={toast.id}\n          message={toast.message}\n          type={toast.type}\n          duration={toast.duration}\n          onClose={() => removeToast(toast.id)}\n        />\n      ))}\n    </div>\n  );\n};\n\n// Error Boundary for React Flow\nclass ReactFlowErrorBoundary extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { hasError: false };\n  }\n\n  static getDerivedStateFromError(error) {\n    // Check if it's a React Flow dimension error\n    if (error.message && error.message.includes('dimensions')) {\n      console.warn('React Flow dimension error caught, recovering...');\n      return { hasError: false }; // Don't show error, just recover\n    }\n    return { hasError: true };\n  }\n\n  componentDidCatch(error, errorInfo) {\n    if (error.message && error.message.includes('dimensions')) {\n      // For dimension errors, try to recover\n      setTimeout(() => {\n        if (window.reactFlowInstance) {\n          window.reactFlowInstance.fitView();\n        }\n      }, 100);\n      return;\n    }\n    console.error('React Flow Error:', error, errorInfo);\n  }\n\n  render() {\n    if (this.state.hasError) {\n      return (\n        <div className=\"flex-1 flex items-center justify-center\">\n          <div className=\"text-center\">\n            <h3 className=\"text-lg font-medium text-gray-900 mb-2\">Mind Map Temporarily Unavailable</h3>\n            <p className=\"text-gray-600 mb-4\">There was an issue with the mind map. Please refresh the page.</p>\n            <button \n              onClick={() => window.location.reload()} \n              className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700\"\n            >\n              Refresh Page\n            </button>\n          </div>\n        </div>\n      );\n    }\n\n    return this.props.children;\n  }\n}\n\nconst Dashboard = () => (\n  <ReactFlowProvider>\n    <DashboardComponent />\n  </ReactFlowProvider>\n);\n\nfunction App() {\n  return <Dashboard />;\n}\n\nexport default App;","import React from \"react\";\nimport ReactDOM from \"react-dom/client\";\nimport \"./index.css\";\nimport App from \"./App\";\n\nconst root = ReactDOM.createRoot(document.getElementById(\"root\"));\nroot.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n);\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","var getProto = Object.getPrototypeOf ? (obj) => (Object.getPrototypeOf(obj)) : (obj) => (obj.__proto__);\nvar leafPrototypes;\n// create a fake namespace object\n// mode & 1: value is a module id, require it\n// mode & 2: merge all properties of value into the ns\n// mode & 4: return value when already ns object\n// mode & 16: return value when it's Promise-like\n// mode & 8|1: behave like require\n__webpack_require__.t = function(value, mode) {\n\tif(mode & 1) value = this(value);\n\tif(mode & 8) return value;\n\tif(typeof value === 'object' && value) {\n\t\tif((mode & 4) && value.__esModule) return value;\n\t\tif((mode & 16) && typeof value.then === 'function') return value;\n\t}\n\tvar ns = Object.create(null);\n\t__webpack_require__.r(ns);\n\tvar def = {};\n\tleafPrototypes = leafPrototypes || [null, getProto({}), getProto([]), getProto(getProto)];\n\tfor(var current = mode & 2 && value; (typeof current == 'object' || typeof current == 'function') && !~leafPrototypes.indexOf(current); current = getProto(current)) {\n\t\tObject.getOwnPropertyNames(current).forEach((key) => (def[key] = () => (value[key])));\n\t}\n\tdef['default'] = () => (value);\n\t__webpack_require__.d(ns, def);\n\treturn ns;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = (chunkId) => {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce((promises, key) => {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"static/js/\" + chunkId + \".\" + {\"213\":\"c0413f75\",\"261\":\"de3004f3\",\"524\":\"c4c81a9f\"}[chunkId] + \".chunk.js\";\n};","// This function allow to reference async chunks\n__webpack_require__.miniCssF = (chunkId) => {\n\t// return url for filenames based on template\n\treturn undefined;\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","var inProgress = {};\nvar dataWebpackPrefix = \"frontend:\";\n// loadScript function to load a script via script tag\n__webpack_require__.l = (url, done, key, chunkId) => {\n\tif(inProgress[url]) { inProgress[url].push(done); return; }\n\tvar script, needAttach;\n\tif(key !== undefined) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tfor(var i = 0; i < scripts.length; i++) {\n\t\t\tvar s = scripts[i];\n\t\t\tif(s.getAttribute(\"src\") == url || s.getAttribute(\"data-webpack\") == dataWebpackPrefix + key) { script = s; break; }\n\t\t}\n\t}\n\tif(!script) {\n\t\tneedAttach = true;\n\t\tscript = document.createElement('script');\n\n\t\tscript.charset = 'utf-8';\n\t\tscript.timeout = 120;\n\t\tif (__webpack_require__.nc) {\n\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\t\tscript.setAttribute(\"data-webpack\", dataWebpackPrefix + key);\n\n\t\tscript.src = url;\n\t}\n\tinProgress[url] = [done];\n\tvar onScriptComplete = (prev, event) => {\n\t\t// avoid mem leaks in IE.\n\t\tscript.onerror = script.onload = null;\n\t\tclearTimeout(timeout);\n\t\tvar doneFns = inProgress[url];\n\t\tdelete inProgress[url];\n\t\tscript.parentNode && script.parentNode.removeChild(script);\n\t\tdoneFns && doneFns.forEach((fn) => (fn(event)));\n\t\tif(prev) return prev(event);\n\t}\n\tvar timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000);\n\tscript.onerror = onScriptComplete.bind(null, script.onerror);\n\tscript.onload = onScriptComplete.bind(null, script.onload);\n\tneedAttach && document.head.appendChild(script);\n};","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.nmd = (module) => {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","__webpack_require__.p = \"/\";","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t792: 0\n};\n\n__webpack_require__.f.j = (chunkId, promises) => {\n\t\t// JSONP chunk loading for javascript\n\t\tvar installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n\t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n\t\t\t// a Promise means \"currently loading\".\n\t\t\tif(installedChunkData) {\n\t\t\t\tpromises.push(installedChunkData[2]);\n\t\t\t} else {\n\t\t\t\tif(true) { // all chunks have JS\n\t\t\t\t\t// setup Promise in chunk cache\n\t\t\t\t\tvar promise = new Promise((resolve, reject) => (installedChunkData = installedChunks[chunkId] = [resolve, reject]));\n\t\t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n\t\t\t\t\t// start chunk loading\n\t\t\t\t\tvar url = __webpack_require__.p + __webpack_require__.u(chunkId);\n\t\t\t\t\t// create error before stack unwound to get useful stacktrace later\n\t\t\t\t\tvar error = new Error();\n\t\t\t\t\tvar loadingEnded = (event) => {\n\t\t\t\t\t\tif(__webpack_require__.o(installedChunks, chunkId)) {\n\t\t\t\t\t\t\tinstalledChunkData = installedChunks[chunkId];\n\t\t\t\t\t\t\tif(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n\t\t\t\t\t\t\tif(installedChunkData) {\n\t\t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n\t\t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n\t\t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n\t\t\t\t\t\t\t\terror.type = errorType;\n\t\t\t\t\t\t\t\terror.request = realSrc;\n\t\t\t\t\t\t\t\tinstalledChunkData[1](error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t__webpack_require__.l(url, loadingEnded, \"chunk-\" + chunkId, chunkId);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n};\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = (chunkId) => (installedChunks[chunkId] === 0);\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkfrontend\"] = self[\"webpackChunkfrontend\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [967,497,96], () => (__webpack_require__(8806)))\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["LoadingSpinner","_ref","message","_jsx","className","children","_jsxs","Loader2","LazyRichTextEditor","lazy","LazyTemplateManager","LazyLiteratureModal","withLazyLoading","LazyComponent","fallbackMessage","props","Suspense","fallback","TemplateManager","LiteratureModal","modalVariants","hidden","opacity","scale","y","rotate","visible","transition","type","damping","stiffness","duration","exit","backdropVariants","backdropFilter","ease","contentVariants","delay","CaseModal","isOpen","data","onClose","onAnimationStart","onAnimationEnd","setMindMapData","autoSaveMindMapData","addToast","isAnimating","setIsAnimating","useState","isVisible","setIsVisible","isClosing","setIsClosing","isEditing","setIsEditing","editData","setEditData","isLoading","setIsLoading","hasInitialized","setHasInitialized","activeTab","setActiveTab","isTabTransitioning","setIsTabTransitioning","expandedTimelineEntry","setExpandedTimelineEntry","editingEntryId","setEditingEntryId","editingEntryData","setEditingEntryData","isCreatingEntry","setIsCreatingEntry","timelineScrollRef","useRef","useEffect","setTimeout","id","timelineEntries","useMemo","timeline","Array","isArray","length","sort","a","b","Date","timestamp","date","time","title","content","details","author","isNew","scrollToLatest","useCallback","current","scrollTop","scrollHeight","scrollToShowEditingEntry","container","containerHeight","clientHeight","targetScroll","estimatedFormHeight","scrollTo","top","Math","max","behavior","containerRect","getBoundingClientRect","editingElement","querySelector","elementBottom","bottom","containerBottom","additionalScroll","saveTimelineChange","entryId","prev","newTimeline","prevData","updatedCases","cases","map","caseItem","String","updated_at","toISOString","newData","getEntryTitle","assessment","medication","therapy","followup","note","createNewTimelineEntry","newEntry","now","split","toLocaleTimeString","hour","minute","hour12","updatedTimeline","startEditingEntry","entry","entryElement","entryRect","estimatedExpandedHeight","entryBottomAfterExpansion","height","scrollAmount","entryBottom","saveEditingEntry","currentTimeline","finalEntry","toString","startsWith","dateObj","filter","e","cancelEditingEntry","handleEditingKeyPress","key","shiftKey","preventDefault","updateEditingEntry","field","value","timeout","clearTimeout","handleClose","handleSave","async","error","console","handleDelete","window","confirm","updateField","renderField","label","arguments","undefined","options","onChange","target","rows","placeholder","toLowerCase","choices","choice","Number","AnimatePresence","mode","onExitComplete","motion","div","initial","animate","variants","style","willChange","backfaceVisibility","transform","onClick","currentTarget","stopPropagation","onAnimationComplete","Users","size","_Fragment","Edit3","Trash2","X","icon","FileText","Clipboard","Heart","Clock","Sparkles","Target","_ref2","Icon","button","whileHover","whileTap","boxShadow","some","layoutId","bounce","layout","layoutRoot","x","AlertCircle","disabled","Plus","ArrowDown","ref","scrollbarWidth","scrollbarColor","index","_entry$content","_editingEntryData$con","isExpanded","span","repeat","Infinity","Calendar","substring","slice","onKeyPress","trim","Save","React","prevProps","nextProps","_prevProps$data","_nextProps$data","_prevProps$data2","_nextProps$data2","TopicModal","newResource","setNewResource","showResourceForm","setShowResourceForm","resources","flashcard_count","completed_flashcards","progressPercentage","total","completed","round","updatedTopics","topics","topic","addResource","updatedResources","removeResource","_","i","BookOpen","TrendingUp","Lightbulb","Link2","Brain","width","Check","Award","resource","Layers","TaskModal","_priorityConfig$editD","status","priority","priorityConfig","low","color","Flag","medium","high","urgent","AlertTriangle","statusConfig","pending","in_progress","Play","CheckSquare","paused","Pause","isOverdue","due_date","updatedTasks","tasks","task","handleStatusChange","newStatus","toLocaleDateString","Object","entries","_ref3","config","isActive","created_at","toLocaleString","getIntersectionPoint","rect","center","point","rectX","rectY","centerX","centerY","pointX","pointY","left","right","dx","dy","abs","side","slope","yIntercept","intersections","leftY","push","distance","hypot","rightY","topX","bottomX","validIntersections","intersection","intersectionDx","intersectionDy","FloatingEdge","memo","_sourceNode","_targetNode","_sourceNode2","_sourceNode3","_targetNode2","_targetNode3","source","sourceX","sourceY","targetX","targetY","sourcePosition","targetPosition","markerEnd","markerStart","getNode","useReactFlow","sourceNode","targetNode","edgePath","labelX","labelY","__isAnimating","__forceUpdate","_sourceNode$dimension","_sourceNode$data","_sourceNode$style","_targetNode$dimension","_targetNode$data","_targetNode$style","_sourceNode$positionA","_sourceNode$positionA2","_targetNode$positionA","_targetNode$positionA2","sourceHasDimensions","Boolean","dimensions","targetHasDimensions","getNodeDimensions","node","_node$dimensions","_node$data","_node$dimensions2","_node$data2","defaultWidth","defaultHeight","sourceDims","targetDims","floatingEdgeData","sourceWidth","sourceHeight","targetWidth","targetHeight","offset","sourceSide","targetSide","sourceCenter","targetCenter","sourceRect","targetRect","sourceIntersection","targetIntersection","sqrt","unitX","unitY","extensionAmount","debug","log","getFloatingEdgePath","positionAbsolute","position","sx","sy","tx","ty","warn","BaseEdge","path","stroke","strokeWidth","strokeLinecap","strokeOpacity","EnhancedEdge","sourceHandleId","targetHandleId","selected","animated","getBezierPath","EdgeLabelRenderer","fontSize","pointerEvents","displayName","fromX","fromY","toX","toY","connectionLineStyle","strokeDasharray","animation","d","fill","progress","min","sampleLiteratureData","authors","year","journal","volume","pages","doi","abstract","keywords","notes","pdf_url","sampleConnections","populateSampleLiteratureData","existingIds","Set","literature","item","newLiterature","has","existingCaseIds","existingTopicIds","newCases","primary_diagnosis","chief_complaint","secondary_diagnoses","newTopics","category","tags","existingConnectionIds","connections","conn","newConnections","updatedData","loadD3Force","API","process","replace","originalError","_len2","args","_key2","includes","Toast","timer","success","info","saving","getIcon","CheckCircle2","Info","LoadingButton","loading","STORAGE_KEY","localStorageUtils","save","timeoutId","onSaveStart","onSaveComplete","storageData","version","localStorage","setItem","JSON","stringify","name","removeItem","clearError","load","stored","getItem","parse","clear","getStorageInfo","Blob","nodeTypes","skipAnimation","completionPercentage","backgroundColor","Handle","Position","Top","zIndex","isConnectable","Right","Bottom","Left","Tag","onDelete","detail","onDoubleClick","tag","case","_ref4","urgency","_data$chief_complaint","_data$diagnosis","complaint","diagnosis","keyword","getUrgencyLevel","linked_topics","age","getStatusColor","tasks_count","completed_tasks","_ref5","_ref6","onLiteratureClick","NodeSelector","_ref9","onSelect","templates","selectedNodeType","setSelectedNodeType","description","handleFinalSelect","filteredTemplates","t","nodeType","ArrowLeft","minHeight","_ref0","template","_template$data","_template$data2","_template$data3","assessment_plan","EdgeLabelModal","_ref1","edge","onSave","setLabel","autoFocus","DashboardComponent","_caseModal$data2","_topicModal$data2","_taskModal$data2","_caseModal$data3","_topicModal$data3","_taskModal$data3","fitView","setCenter","zoomTo","getViewport","nodes","setNodes","onNodesChange","useNodesState","edges","setEdges","onEdgesChange","useEdgesState","mindMapData","selectedNode","setSelectedNode","setLoading","loadingProgress","setLoadingProgress","loadingMessage","setLoadingMessage","isInitialLoad","setIsInitialLoad","focusedCategory","setFocusedCategory","showNodeSelector","setShowNodeSelector","caseModal","setCaseModal","topicModal","setTopicModal","taskModal","setTaskModal","caseModalStableData","topicModalStableData","taskModalStableData","isReactFlowReady","setIsReactFlowReady","hasAppliedInitialLayout","setHasAppliedInitialLayout","isExportingCSV","setIsExportingCSV","lastSaved","setLastSaved","isSaving","setIsSaving","edgeModal","setEdgeModal","setTemplates","exportProgress","setExportProgress","show","toasts","setToasts","isTemplateManagerOpen","setIsTemplateManagerOpen","literatureModal","setLiteratureModal","modalAnimationStates","setModalAnimationStates","newToast","removeToast","toast","_caseModal$data","_topicModal$data","_taskModal$data","anyModalOpen","anyModalAnimating","values","state","anyModalTransitioning","requestIdleCallback","saveToBackend","positionBackendSaveTimeout","handleDeleteNode","fullNodeId","idParts","nodeId","join","collectionKey","updatedCollection","updatedConnections","charAt","toUpperCase","nds","eds","handleLiteratureClick","literatureData","syncNodeTitles","currentNodes","newLabel","_mindMapData$cases","caseData","find","c","primaryDiagnosis","_mindMapData$topics","topicData","_mindMapData$tasks","taskData","_mindMapData$literatu","l","_mindMapData$cases2","_mindMapData$topics2","_mindMapData$tasks2","_mindMapData$literatu2","convertDataToReactFlow","applyLayoutImmediately","allItems","layoutNodes","hasExistingPositions","forceSimulation","forceManyBody","forceLink","forceCenter","forceCollide","simulationNodes","_item$position","_item$position2","random","d3Edges","nodeIds","n","simulation","force","strength","distanceMax","innerWidth","innerHeight","radius","stop","tick","positionMap","Map","forEach","set","get","quickNodes","nodeData","chiefComplaint","initialPresentation","initial_presentation","currentPresentation","current_presentation","medicationHistory","medication_history","therapyProgress","therapy_progress","defensePatterns","defense_patterns","clinicalReflection","clinical_reflection","gridSize","ceil","nodeSpacing","offsetY","floor","optimizedEdges","createOptimizedEdges","nodeIdSet","updatable","cleanData","_topic$position","_topic$position2","_caseItem$position","_caseItem$position2","case_id","encounter_date","gender","history_present_illness","medical_history","medications","mental_status_exam","_task$position","_task$position2","linked_case_id","linked_topic_id","lit","_lit$position","_lit$position2","publication","pdf_path","response","axios","put","headers","err","_err$response","_err$response2","_err$response3","_err$response3$data","onConnect","params","edgeId","newEdge","interactionWidth","addEdge","onNodeClick","event","onNodeDoubleClick","dataItem","onEdgeDoubleClick","onEdgeContextMenu","handleSaveEdgeLabel","onEdgeMouseEnter","onEdgeMouseLeave","forceLayout","currentEdges","validEdges","fx","fy","ticksPerFrame","totalTicks","currentTick","runSimulationChunk","remainingTicks","requestAnimationFrame","updatedNodes","simNode","currentData","_updatedData$key","padding","applyForceLayout","handleClearMap","empty","handleNodesChange","changes","positionChanges","change","_updatedData$key2","handleNodeDragStop","dragSaveTimeout","loadMindMapData","local","backendError","nodeMatchesSearch","query","searchTerm","parts","hasMatch","handleKeyDown","_document$querySelect","tagName","ctrlKey","metaKey","document","focus","addEventListener","removeEventListener","styleSheet","getElementById","createElement","head","appendChild","textContent","OptimizedLoadingScreen","CheckCircle","Cloud","Shuffle","Bookmark","Eye","ReactFlowErrorBoundary","ReactFlow","onNodeDragStop","edgeTypes","floating","enhanced","nodesDraggable","nodesConnectable","elementsSelectable","onInit","reactFlowInstance","onError","snapToGrid","snapGrid","elevateEdgesOnSelect","connectionLineComponent","ConnectionLine","defaultEdgeOptions","Background","gap","Controls","MiniMap","allNodes","templateId","_mindMapData$topics3","_mindMapData$cases3","_mindMapData$tasks3","_mindMapData$literatu3","dataId","currentDataCount","gridPosition","newNode","dataToAdd","concat","constructor","super","this","hasError","getDerivedStateFromError","componentDidCatch","errorInfo","render","location","reload","Dashboard","ReactFlowProvider","ReactDOM","App","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","loaded","__webpack_modules__","m","deferred","O","result","chunkIds","fn","notFulfilled","fulfilled","j","keys","every","splice","r","leafPrototypes","getProto","getPrototypeOf","obj","__esModule","then","ns","create","def","indexOf","getOwnPropertyNames","definition","o","defineProperty","enumerable","f","chunkId","Promise","all","reduce","promises","u","miniCssF","g","globalThis","Function","prop","prototype","hasOwnProperty","call","inProgress","dataWebpackPrefix","url","done","script","needAttach","scripts","getElementsByTagName","s","getAttribute","charset","nc","setAttribute","src","onScriptComplete","onerror","onload","doneFns","parentNode","removeChild","bind","Symbol","toStringTag","nmd","paths","p","installedChunks","installedChunkData","promise","resolve","reject","Error","errorType","realSrc","request","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","chunkLoadingGlobal","self","__webpack_exports__"],"sourceRoot":""}