"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[213],{4213:(e,t,s)=>{s.r(t),s.d(t,{default:()=>N});var a=s(5043),l=s(3546),r=s(6446),i=s(4596),o=s(2626),n=s(8646),d=s(764),c=s(5087),u=s(1680),x=s(8487),m=s(8693),p=s(9292),h=s(4615),b=s(4459),g=s(614),v=s(579);const f={hidden:{opacity:0,scale:.3,y:50,rotate:-5},visible:{opacity:1,scale:1,y:0,rotate:0,transition:{type:"spring",damping:25,stiffness:300,duration:.6}},exit:{opacity:0,scale:.7,y:30,rotate:-3,transition:{type:"easeInOut",duration:.4}}},j={hidden:{opacity:0,backdropFilter:"blur(0px)"},visible:{opacity:1,backdropFilter:"blur(8px)",transition:{duration:.4,ease:"easeOut"}},exit:{opacity:0,backdropFilter:"blur(0px)",transition:{duration:.3,ease:"easeIn"}}},y={hidden:{opacity:0,x:-30,scale:.95},visible:{opacity:1,x:0,scale:1,transition:{type:"spring",damping:20,stiffness:300,duration:.4}},exit:{opacity:0,x:30,scale:.95,transition:{duration:.3,ease:"easeInOut"}}},N=e=>{let{isOpen:t,onClose:s,literatureData:N,allNodes:w=[],connections:C=[],setMindMapData:k,autoSaveMindMapData:A,addToast:S,onAnimationStart:P,onAnimationEnd:L}=e;const[z,E]=(0,a.useState)("overview"),[T,D]=(0,a.useState)(""),[F,M]=(0,a.useState)("all"),[O,_]=(0,a.useState)(!1),[I,H]=(0,a.useState)(!1),[R,V]=(0,a.useState)(!1),[$,U]=(0,a.useState)(!1),[q,B]=(0,a.useState)({title:"",authors:[],year:"",journal:"",abstract:"",keywords:"",doi:"",volume:"",pages:"",notes:""});(0,a.useEffect)(()=>{t&&N&&!$?(B({title:N.title||"",authors:Array.isArray(N.authors)?N.authors:N.authors?[N.authors]:[],year:N.year||"",journal:N.journal||"",abstract:N.abstract||"",keywords:N.keywords||"",doi:N.doi||"",volume:N.volume||"",pages:N.pages||"",notes:N.notes||""}),E("overview"),U(!0),requestAnimationFrame(()=>{H(!0)})):t||(H(!1),U(!1),V(!1))},[t,N,$]);const J=(0,a.useCallback)(()=>{if(!N||!k)return;const e={...N,title:q.title,authors:q.authors,year:q.year,journal:q.journal,abstract:q.abstract,keywords:q.keywords,doi:q.doi,volume:q.volume,pages:q.pages,notes:q.notes};k(t=>{const s={...t,literature:(t.literature||[]).map(t=>t.id===N.id?e:t)};return A&&A(s),s}),S&&S("Literature updated successfully!","success"),V(!1)},[q,N,k,A,S]),K=(e,t)=>{B(s=>({...s,[e]:t}))},Y=()=>{P&&P(),H(!1),_(!0),setTimeout(()=>{s(),L&&L(),_(!1)},400)},G=(0,a.useMemo)(()=>{if(!N||!C)return[];const e=C.filter(e=>e.source.includes("literature")&&e.source.includes(N.id)||e.target.includes("literature")&&e.target.includes(N.id)).map(e=>e.source.includes(N.id)?e.target:e.source);return w.filter(t=>e.includes(t.id))},[N,C,w]),Q=(0,a.useMemo)(()=>{const e=new Set;return G.forEach(t=>{const s=t.data;if("case"===t.type){if(s.primary_diagnosis&&e.add(s.primary_diagnosis.toLowerCase()),s.secondary_diagnoses&&s.secondary_diagnoses.forEach(t=>e.add(t.toLowerCase())),s.chief_complaint){(s.chief_complaint.toLowerCase().match(/\b\w{4,}\b/g)||[]).forEach(t=>e.add(t))}}else"topic"===t.type&&(s.title&&e.add(s.title.toLowerCase()),s.category&&e.add(s.category.toLowerCase()),s.tags&&s.tags.forEach(t=>e.add(t.toLowerCase())))}),Array.from(e).filter(e=>e.length>3)},[G]),W=(0,a.useMemo)(()=>0===Q.length?[]:w.filter(e=>"literature"===e.type&&e.data.id!==(null===N||void 0===N?void 0:N.id)).map(e=>{const t=e.data;let s=0;const a=[t.title||"",t.abstract||"",t.keywords||"",t.authors||""].join(" ").toLowerCase();return Q.forEach(e=>{a.includes(e)&&s++}),{...t,relevanceScore:s}}).filter(e=>e.relevanceScore>0).sort((e,t)=>t.relevanceScore-e.relevanceScore).slice(0,8),[Q,w,N]),X=(0,a.useMemo)(()=>{let e=W;return T&&(e=e.filter(e=>{var t,s,a;return(null===(t=e.title)||void 0===t?void 0:t.toLowerCase().includes(T.toLowerCase()))||(null===(s=e.authors)||void 0===s?void 0:s.join(" ").toLowerCase().includes(T.toLowerCase()))||(null===(a=e.journal)||void 0===a?void 0:a.toLowerCase().includes(T.toLowerCase()))})),"all"!==F&&(e=e.filter(e=>e.type===F)),e},[W,T,F]),Z=[{id:"overview",label:"Overview",icon:u.A},{id:"pdf",label:"PDF Viewer",icon:c.A},{id:"notes",label:"Notes",icon:h.A},{id:"related",label:"Related",icon:x.A,badge:W.length}];return t?(0,v.jsx)(l.N,{mode:"wait",onExitComplete:()=>_(!1),children:I&&(0,v.jsx)(r.P.div,{initial:"hidden",animate:"visible",exit:"hidden",variants:j,className:"fixed inset-0 bg-black flex items-center justify-center z-50 p-4",onClick:Y,children:(0,v.jsxs)(r.P.div,{initial:"hidden",animate:"visible",exit:"hidden",variants:f,className:"bg-white rounded-2xl shadow-2xl w-full max-w-5xl max-h-[90vh] overflow-hidden",onClick:e=>e.stopPropagation(),onAnimationStart:()=>{_(!0),P&&P()},onAnimationComplete:()=>{_(!1),L&&L()},children:[(0,v.jsxs)("div",{className:"bg-gradient-to-br from-slate-900 to-slate-800 text-white p-6",children:[(0,v.jsxs)("div",{className:"flex items-start justify-between",children:[(0,v.jsxs)("div",{className:"flex-1",children:[R?(0,v.jsx)("input",{type:"text",value:q.title,onChange:e=>K("title",e.target.value),className:"text-2xl font-bold mb-2 bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-white w-full focus:ring-2 focus:ring-blue-400 focus:border-blue-400",placeholder:"Literature title..."}):(0,v.jsx)("h2",{className:"text-2xl font-bold mb-2",children:q.title||"Literature Item"}),(0,v.jsx)("div",{className:"flex items-center gap-4 text-slate-300",children:R?(0,v.jsxs)("div",{className:"flex flex-wrap gap-4",children:[(0,v.jsx)("input",{type:"text",value:q.authors.join(", "),onChange:e=>(e=>{const t=e.split(",").map(e=>e.trim()).filter(Boolean);B(e=>({...e,authors:t}))})(e.target.value),className:"bg-slate-700 border border-slate-600 rounded px-2 py-1 text-sm text-white focus:ring-2 focus:ring-blue-400 focus:border-blue-400",placeholder:"Authors (comma separated)..."}),(0,v.jsx)("input",{type:"number",value:q.year,onChange:e=>K("year",e.target.value),className:"bg-slate-700 border border-slate-600 rounded px-2 py-1 text-sm text-white w-20 focus:ring-2 focus:ring-blue-400 focus:border-blue-400",placeholder:"Year"}),(0,v.jsx)("input",{type:"text",value:q.journal,onChange:e=>K("journal",e.target.value),className:"bg-slate-700 border border-slate-600 rounded px-2 py-1 text-sm text-white focus:ring-2 focus:ring-blue-400 focus:border-blue-400",placeholder:"Journal..."})]}):(0,v.jsxs)(v.Fragment,{children:[q.authors.length>0&&(0,v.jsxs)("div",{className:"flex items-center gap-1",children:[(0,v.jsx)(b.A,{size:16}),(0,v.jsxs)("span",{children:[q.authors.slice(0,3).join(", "),q.authors.length>3?" et al.":""]})]}),q.year&&(0,v.jsxs)("div",{className:"flex items-center gap-1",children:[(0,v.jsx)(n.A,{size:16}),(0,v.jsx)("span",{children:q.year})]}),q.journal&&(0,v.jsxs)("div",{className:"flex items-center gap-1",children:[(0,v.jsx)(o.A,{size:16}),(0,v.jsx)("span",{children:q.journal})]})]})})]}),(0,v.jsxs)("div",{className:"flex items-center gap-2",children:[R?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(r.P.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:J,className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-700 rounded-lg transition-colors",children:[(0,v.jsx)(m.A,{size:16}),"Save"]}),(0,v.jsxs)(r.P.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>V(!1),className:"flex items-center gap-2 px-4 py-2 bg-slate-600 hover:bg-slate-700 rounded-lg transition-colors",children:[(0,v.jsx)(g.A,{size:16}),"Cancel"]})]}):(0,v.jsxs)(r.P.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>V(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors",children:[(0,v.jsx)(i.A,{size:16}),"Edit"]}),(0,v.jsx)(r.P.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:Y,className:"p-2 hover:bg-slate-700 rounded-lg transition-colors",children:(0,v.jsx)(g.A,{size:24})})]})]}),(null===N||void 0===N?void 0:N.type)&&(0,v.jsx)("div",{className:"mt-4",children:(0,v.jsx)("div",{className:"inline-flex items-center px-3 py-1 bg-slate-700 text-slate-200 rounded-full text-sm",children:N.type.toUpperCase()})})]}),(0,v.jsx)("div",{className:"border-b border-slate-200 bg-gradient-to-r from-slate-100 to-slate-50",children:(0,v.jsx)("nav",{className:"flex space-x-8 px-6",children:Z.map(e=>{const t=e.icon;return(0,v.jsxs)(r.P.button,{whileHover:{scale:1.05,y:-2},whileTap:{scale:.95},onClick:()=>{var t;(t=e.id)===z||O||(_(!0),P&&P(),setTimeout(()=>{E(t),setTimeout(()=>{_(!1),L&&L()},350)},50))},disabled:O,className:"flex items-center gap-2 px-4 py-4 border-b-2 font-medium text-sm transition-all duration-300 "+(z===e.id?"text-slate-900 border-slate-900 bg-white shadow-sm":"text-slate-600 border-transparent hover:text-slate-900 hover:border-slate-300"),children:[(0,v.jsx)(t,{size:16,className:z===e.id?"text-slate-900":"text-slate-500"}),e.label,void 0!==e.badge&&e.badge>0&&(0,v.jsx)("span",{className:"ml-1 bg-slate-700 text-white text-xs px-2 py-0.5 rounded-full",children:e.badge})]},e.id)})})}),(0,v.jsx)("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:(0,v.jsx)(l.N,{mode:"wait",children:(0,v.jsxs)(r.P.div,{initial:"hidden",animate:"visible",exit:"exit",variants:y,layout:"position",layoutId:"tabContent",children:["overview"===z&&(0,v.jsxs)("div",{className:"space-y-6",children:[(0,v.jsxs)("div",{children:[(0,v.jsx)("h3",{className:"text-lg font-semibold text-slate-900 mb-3",children:"Abstract"}),R?(0,v.jsx)("textarea",{value:q.abstract,onChange:e=>K("abstract",e.target.value),className:"w-full p-3 bg-slate-50 border border-slate-300 rounded-lg text-slate-800 focus:ring-2 focus:ring-blue-400 focus:border-blue-400 resize-none",rows:6,placeholder:"Enter abstract..."}):(0,v.jsx)("p",{className:"text-slate-700 leading-relaxed bg-slate-50 p-4 rounded-lg",children:q.abstract||"No abstract provided"})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)("h3",{className:"text-lg font-semibold text-slate-900 mb-3",children:"Keywords"}),R?(0,v.jsx)("input",{type:"text",value:q.keywords,onChange:e=>K("keywords",e.target.value),className:"w-full p-3 bg-slate-50 border border-slate-300 rounded-lg text-slate-800 focus:ring-2 focus:ring-blue-400 focus:border-blue-400",placeholder:"Enter keywords (comma separated)..."}):(0,v.jsx)("div",{className:"flex flex-wrap gap-2",children:q.keywords?q.keywords.split(",").map((e,t)=>(0,v.jsx)("span",{className:"bg-slate-700 text-white px-3 py-1 rounded-full text-sm",children:e.trim()},t)):(0,v.jsx)("span",{className:"text-slate-500 italic",children:"No keywords provided"})})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)("h3",{className:"text-lg font-semibold text-slate-900 mb-3",children:"Publication Details"}),R?(0,v.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"DOI"}),(0,v.jsx)("input",{type:"text",value:q.doi,onChange:e=>K("doi",e.target.value),className:"w-full p-2 bg-slate-50 border border-slate-300 rounded text-sm focus:ring-2 focus:ring-blue-400 focus:border-blue-400",placeholder:"DOI..."})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Volume"}),(0,v.jsx)("input",{type:"text",value:q.volume,onChange:e=>K("volume",e.target.value),className:"w-full p-2 bg-slate-50 border border-slate-300 rounded text-sm focus:ring-2 focus:ring-blue-400 focus:border-blue-400",placeholder:"Volume..."})]}),(0,v.jsxs)("div",{className:"col-span-2",children:[(0,v.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Pages"}),(0,v.jsx)("input",{type:"text",value:q.pages,onChange:e=>K("pages",e.target.value),className:"w-full p-2 bg-slate-50 border border-slate-300 rounded text-sm focus:ring-2 focus:ring-blue-400 focus:border-blue-400",placeholder:"Pages..."})]})]}):(0,v.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm bg-slate-50 p-4 rounded-lg",children:[q.doi&&(0,v.jsxs)("div",{children:[(0,v.jsx)("span",{className:"font-medium text-slate-600",children:"DOI:"}),(0,v.jsx)("span",{className:"ml-2 text-slate-900",children:q.doi})]}),q.volume&&(0,v.jsxs)("div",{children:[(0,v.jsx)("span",{className:"font-medium text-slate-600",children:"Volume:"}),(0,v.jsx)("span",{className:"ml-2 text-slate-900",children:q.volume})]}),q.pages&&(0,v.jsxs)("div",{className:"col-span-2",children:[(0,v.jsx)("span",{className:"font-medium text-slate-600",children:"Pages:"}),(0,v.jsx)("span",{className:"ml-2 text-slate-900",children:q.pages})]})]})]}),G.length>0&&(0,v.jsxs)("div",{children:[(0,v.jsx)("h3",{className:"text-lg font-semibold text-slate-900 mb-3",children:"Connected To"}),(0,v.jsx)("div",{className:"grid grid-cols-2 gap-3",children:G.map(e=>(0,v.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-slate-50 rounded-lg border border-slate-200 hover:bg-slate-100 transition-colors",children:[(0,v.jsx)("div",{className:"w-3 h-3 rounded-full "+("case"===e.type?"bg-indigo-500":"topic"===e.type?"bg-blue-500":"task"===e.type?"bg-amber-500":"bg-purple-500")}),(0,v.jsxs)("div",{children:[(0,v.jsx)("div",{className:"font-medium text-sm text-slate-900",children:e.data.label||e.data.title}),(0,v.jsx)("div",{className:"text-xs text-slate-500 capitalize",children:e.type})]})]},e.id))})]})]}),"notes"===z&&(0,v.jsxs)("div",{children:[(0,v.jsx)("h3",{className:"text-lg font-semibold text-slate-900 mb-3",children:"Personal Notes"}),R?(0,v.jsx)("textarea",{value:q.notes,onChange:e=>K("notes",e.target.value),className:"w-full p-3 bg-slate-50 border border-slate-300 rounded-lg text-slate-800 focus:ring-2 focus:ring-blue-400 focus:border-blue-400 resize-none",rows:12,placeholder:"Add your personal notes about this literature..."}):(0,v.jsx)("div",{className:"bg-slate-50 p-4 rounded-lg min-h-64",children:q.notes?(0,v.jsx)("p",{className:"text-slate-700 leading-relaxed whitespace-pre-wrap",children:q.notes}):(0,v.jsx)("p",{className:"text-slate-500 italic",children:"No notes yet. Click Edit to add your thoughts about this literature."})})]}),"pdf"===z&&(0,v.jsxs)("div",{className:"text-center py-8",children:[(0,v.jsx)(c.A,{size:48,className:"mx-auto text-slate-400 mb-4"}),(0,v.jsx)("h3",{className:"text-lg font-medium text-slate-900 mb-2",children:"PDF Viewer"}),(0,v.jsx)("p",{className:"text-slate-600 mb-4",children:"PDF viewing functionality will be implemented here"}),(null===N||void 0===N?void 0:N.pdf_url)&&(0,v.jsxs)("a",{href:N.pdf_url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,v.jsx)(d.A,{size:16}),"Open PDF"]})]}),"related"===z&&(0,v.jsxs)("div",{className:"space-y-4",children:[(0,v.jsxs)("div",{className:"flex gap-4 mb-6",children:[(0,v.jsxs)("div",{className:"flex-1 relative",children:[(0,v.jsx)(p.A,{size:18,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400"}),(0,v.jsx)("input",{type:"text",placeholder:"Search related literature...",value:T,onChange:e=>D(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-blue-400"})]}),(0,v.jsxs)("select",{value:F,onChange:e=>M(e.target.value),className:"px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-blue-400",children:[(0,v.jsx)("option",{value:"all",children:"All Types"}),(0,v.jsx)("option",{value:"rct",children:"RCT"}),(0,v.jsx)("option",{value:"review",children:"Review"}),(0,v.jsx)("option",{value:"meta-analysis",children:"Meta-Analysis"}),(0,v.jsx)("option",{value:"case-study",children:"Case Study"})]})]}),X.length>0?(0,v.jsx)("div",{className:"grid grid-cols-1 gap-4",children:X.map((e,t)=>{return(0,v.jsxs)(r.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*t},className:"p-4 border border-slate-200 rounded-lg hover:shadow-md transition-all duration-200 bg-white",children:[(0,v.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,v.jsx)("h4",{className:"font-medium text-slate-900 flex-1",children:e.title}),e.type&&(0,v.jsx)("span",{className:`ml-2 px-2 py-1 text-xs rounded border ${s=e.type,{"clinical-trial":"bg-blue-100 text-blue-800 border-blue-200",rct:"bg-green-100 text-green-800 border-green-200",review:"bg-purple-100 text-purple-800 border-purple-200","meta-analysis":"bg-indigo-100 text-indigo-800 border-indigo-200","case-study":"bg-yellow-100 text-yellow-800 border-yellow-200"}[null===s||void 0===s?void 0:s.toLowerCase()]||"bg-gray-100 text-gray-800 border-gray-200"}`,children:e.type.toUpperCase()})]}),(0,v.jsxs)("div",{className:"text-sm text-slate-600 mb-2",children:[Array.isArray(e.authors)?e.authors.slice(0,3).join(", "):e.authors,e.year&&` (${e.year})`]}),e.journal&&(0,v.jsx)("div",{className:"text-sm text-slate-500 italic mb-2",children:e.journal}),(0,v.jsx)("div",{className:"flex items-center justify-between",children:(0,v.jsx)("div",{className:"flex items-center gap-2",children:(0,v.jsxs)("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded",children:["Relevance: ",e.relevanceScore]})})})]},`${e.id}-${t}`);var s})}):(0,v.jsxs)("div",{className:"text-center py-8",children:[(0,v.jsx)(o.A,{size:48,className:"mx-auto text-slate-400 mb-4"}),(0,v.jsx)("h3",{className:"text-lg font-medium text-slate-900 mb-2",children:"No Related Literature"}),(0,v.jsx)("p",{className:"text-slate-600",children:0===Q.length?"Connect this literature to cases or topics to find related content":"No literature matches the current search criteria"})]})]})]},z)})})]})},`modal-${(null===N||void 0===N?void 0:N.id)||"default"}`)}):null}}}]);
//# sourceMappingURL=213.953ef4c7.chunk.js.map