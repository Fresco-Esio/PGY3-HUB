{"version":3,"file":"static/js/main.564995f0.js","mappings":"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","sources":["components/LazyComponents.js","components/CaseModal.js","components/TopicModal.js","components/TaskModal.js","utils/floatingEdgeUtils.js","components/FloatingEdge.js","components/EnhancedEdge.js","components/ConnectionLine.js","components/OptimizedLoadingScreen.js","utils/performanceUtils.js","data/sampleLiteratureData.js","utils/sampleDataUtils.js","App.js","index.js","../webpack/bootstrap","../webpack/runtime/chunk loaded","../webpack/runtime/create fake namespace object","../webpack/runtime/define property getters","../webpack/runtime/ensure chunk","../webpack/runtime/get javascript chunk filename","../webpack/runtime/get mini-css chunk filename","../webpack/runtime/global","../webpack/runtime/hasOwnProperty shorthand","../webpack/runtime/load script","../webpack/runtime/make namespace object","../webpack/runtime/node module decorator","../webpack/runtime/publicPath","../webpack/runtime/jsonp chunk loading","../webpack/startup"],"sourcesContent":["// Lazy loading component wrapper for performance optimization\nimport React, { Suspense, lazy } from 'react';\nimport { Loader2 } from 'lucide-react';\n\n// Loading fallback component\nconst LoadingSpinner = ({ message = \"Loading...\" }) => (\n  <div className=\"flex items-center justify-center p-8\">\n    <div className=\"flex flex-col items-center gap-2\">\n      <Loader2 className=\"w-6 h-6 animate-spin text-blue-600\" />\n      <span className=\"text-sm text-gray-600\">{message}</span>\n    </div>\n  </div>\n);\n\n// Lazy load components that aren't needed immediately\nexport const LazyRichTextEditor = lazy(() => import('./RichTextEditor'));\nexport const LazyTemplateManager = lazy(() => import('./TemplateManager'));\nexport const LazyLiteratureModal = lazy(() => import('./LiteratureModal'));\n\n// HOC for wrapping lazy components with suspense\nexport const withLazyLoading = (LazyComponent, fallbackMessage) => (props) => (\n  <Suspense fallback={<LoadingSpinner message={fallbackMessage} />}>\n    <LazyComponent {...props} />\n  </Suspense>\n);\n\n// Pre-wrapped components ready to use\nexport const RichTextEditor = withLazyLoading(LazyRichTextEditor, \"Loading editor...\");\nexport const TemplateManager = withLazyLoading(LazyTemplateManager, \"Loading templates...\");\nexport const LiteratureModal = withLazyLoading(LazyLiteratureModal, \"Loading literature viewer...\");\n","// Enhanced Case Modal with tabbed interface and advanced animations\nimport React, { useState, useEffect, useMemo, useCallback, useRef } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { \n  X, \n  Users, \n  FileText, \n  Clipboard, \n  Heart, \n  Clock, \n  Sparkles, \n  Target,\n  Edit3,\n  Trash2,\n  Save,\n  Loader2,\n  AlertCircle,\n  StickyNote,\n  Eye,\n  BookOpen,\n  ChevronDown,\n  ArrowDown,\n  Calendar,\n  Brain\n} from 'lucide-react';\n\n// Animation variants for Framer Motion\nconst modalVariants = {\n  hidden: {\n    opacity: 0,\n    scale: 0.3,\n    y: 50,\n    rotate: -5,\n  },\n  visible: {\n    opacity: 1,\n    scale: 1,\n    y: 0,\n    rotate: 0,\n    transition: {\n      type: \"spring\",\n      damping: 25,\n      stiffness: 300,\n      duration: 0.6,\n    }\n  },\n  exit: {\n    opacity: 0,\n    scale: 0.7,\n    y: 30,\n    rotate: -3,\n    transition: {\n      type: \"easeInOut\",\n      duration: 0.4,\n    }\n  }\n};\n\nconst backdropVariants = {\n  hidden: { \n    opacity: 0,\n    backdropFilter: 'blur(0px)'\n  },\n  visible: { \n    opacity: 1,\n    backdropFilter: 'blur(8px)',\n    transition: {\n      duration: 0.4,\n      ease: \"easeOut\"\n    }\n  },\n  exit: { \n    opacity: 0,\n    backdropFilter: 'blur(0px)',\n    transition: {\n      duration: 0.3,\n      ease: \"easeIn\"\n    }\n  }\n};\n\nconst contentVariants = {\n  hidden: {\n    opacity: 0,\n    y: 20,\n    scale: 0.95,\n  },\n  visible: {\n    opacity: 1,\n    y: 0,\n    scale: 1,\n    transition: {\n      type: \"easeOut\",\n      duration: 0.3,\n      delay: 0.1,\n    }\n  },\n  exit: {\n    opacity: 0,\n    y: -10,\n    scale: 1.02,\n    transition: {\n      type: \"easeIn\",\n      duration: 0.2,\n    }\n  }\n};\n\nconst CaseModal = ({ \n  isOpen, \n  data, \n  onClose,\n  onAnimationStart,\n  onAnimationEnd,\n  setMindMapData,\n  autoSaveMindMapData,\n  addToast\n}) => {\n  const [isAnimating, setIsAnimating] = useState(false);\n  const [isVisible, setIsVisible] = useState(false);\n  const [isClosing, setIsClosing] = useState(false);\n  const [isEditing, setIsEditing] = useState(false);\n  const [editData, setEditData] = useState({});\n  const [isLoading, setIsLoading] = useState(false);\n  const [hasInitialized, setHasInitialized] = useState(false);\n  const [activeTab, setActiveTab] = useState('overview');\n  const [isTabTransitioning, setIsTabTransitioning] = useState(false);\n  const [expandedTimelineEntry, setExpandedTimelineEntry] = useState(null);\n  const timelineScrollRef = useRef(null);\n\n  useEffect(() => {\n    if (isOpen && data && !hasInitialized) {\n      setIsVisible(true);\n      setEditData({ ...data });\n      setHasInitialized(true);\n      setIsAnimating(true);\n      if (onAnimationStart) onAnimationStart();\n      \n      setTimeout(() => {\n        setIsAnimating(false);\n        if (onAnimationEnd) onAnimationEnd();\n      }, 600);\n    } else if (!isOpen && hasInitialized) {\n      setHasInitialized(false);\n    }\n  }, [isOpen, hasInitialized, onAnimationStart, onAnimationEnd]);\n\n  // Separate effect for data updates when modal is already open\n  useEffect(() => {\n    if (isOpen && data && hasInitialized && !isEditing && !isLoading && !isTabTransitioning && !isAnimating) {\n      setEditData({ ...data });\n    }\n  }, [data?.id, isOpen, hasInitialized, isEditing, isLoading, isTabTransitioning, isAnimating]);\n\n  // Mock timeline data - in real app this would come from data\n  const timelineEntries = useMemo(() => [\n    {\n      id: 1,\n      date: '2024-01-15',\n      time: '09:30 AM',\n      type: 'assessment',\n      title: 'Initial Assessment',\n      summary: 'Patient presented with symptoms of anxiety and depression.',\n      details: 'Comprehensive psychiatric evaluation completed. Patient reports increased anxiety over the past 3 months, difficulty sleeping, and decreased appetite. MSE reveals anxious mood, intact cognition, no psychotic features. PHQ-9 score: 14 (moderate depression). GAD-7 score: 12 (moderate anxiety).',\n      author: 'Dr. Smith',\n      isNew: false\n    },\n    {\n      id: 2,\n      date: '2024-01-22',\n      time: '02:15 PM',\n      type: 'medication',\n      title: 'Medication Adjustment',\n      summary: 'Started on Sertraline 50mg daily.',\n      details: 'After discussion of treatment options, patient agreed to trial of SSRI. Started Sertraline 50mg daily. Reviewed potential side effects including initial activation, GI upset. Plan to follow up in 2 weeks. Provided crisis resources and encouraged to call if any concerns.',\n      author: 'Dr. Smith',\n      isNew: false\n    },\n    {\n      id: 3,\n      date: '2024-02-05',\n      time: '11:00 AM',\n      type: 'followup',\n      title: 'Follow-up Visit',\n      summary: 'Patient reports mild improvement in mood.',\n      details: 'Patient tolerated medication well with minimal side effects. Reports improved energy and slightly better sleep. Still experiencing some anxiety symptoms. PHQ-9 score decreased to 10. Continue current medication, discussed therapy referral.',\n      author: 'Dr. Smith',\n      isNew: false\n    },\n    {\n      id: 4,\n      date: '2024-02-19',\n      time: '03:45 PM',\n      type: 'therapy',\n      title: 'Therapy Session',\n      summary: 'First CBT session completed.',\n      details: 'Initial therapy session with focus on psychoeducation about anxiety and depression. Introduced basic CBT concepts and breathing exercises. Patient engaged well and expressed motivation for therapy. Homework assigned: daily mood tracking and breathing practice.',\n      author: 'Sarah Johnson, LCSW',\n      isNew: true\n    }\n  ], []);\n\n  const scrollToLatest = useCallback(() => {\n    if (timelineScrollRef.current) {\n      timelineScrollRef.current.scrollTop = timelineScrollRef.current.scrollHeight;\n    }\n  }, []);\n\n  const toggleTimelineEntry = useCallback((entryId) => {\n    setExpandedTimelineEntry(prev => prev === entryId ? null : entryId);\n  }, []);\n\n  const handleClose = useCallback(() => {\n    if (isAnimating || isClosing) return;\n    \n    setIsAnimating(true);\n    setIsClosing(true);\n    if (onAnimationStart) onAnimationStart();\n    \n    // Set visibility to false to trigger exit animation\n    setIsVisible(false);\n  }, [onAnimationStart, isAnimating, isClosing]);\n\n  const handleSave = useCallback(async () => {\n    if (isLoading) return;\n    \n    setIsLoading(true);\n    try {\n      setMindMapData(prevData => {\n        const updatedCases = prevData.cases.map(caseItem =>\n          String(caseItem.id) === String(data?.id) ? { ...caseItem, ...editData } : caseItem\n        );\n        const newData = { ...prevData, cases: updatedCases };\n        autoSaveMindMapData(newData);\n        return newData;\n      });\n      \n      setIsEditing(false);\n      addToast('Case updated successfully', 'success');\n    } catch (error) {\n      console.error('Error saving case:', error);\n      addToast('Failed to save case', 'error');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [data?.id, editData, setMindMapData, autoSaveMindMapData, addToast, isLoading]);\n\n  const handleDelete = useCallback(async () => {\n    if (isLoading) return;\n    \n    if (!window.confirm('Are you sure you want to delete this case?')) return;\n    \n    setIsLoading(true);\n    try {\n      setMindMapData(prevData => {\n        const updatedCases = prevData.cases.filter(caseItem => String(caseItem.id) !== String(data?.id));\n        const newData = { ...prevData, cases: updatedCases };\n        autoSaveMindMapData(newData);\n        return newData;\n      });\n      \n      addToast('Case deleted successfully', 'success');\n      handleClose();\n    } catch (error) {\n      console.error('Error deleting case:', error);\n      addToast('Failed to delete case', 'error');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [data?.id, setMindMapData, autoSaveMindMapData, addToast, handleClose, isLoading]);\n\n  const updateField = useCallback((field, value) => {\n    setEditData(prev => ({ ...prev, [field]: value }));\n  }, []);\n\n  const renderField = (label, field, type = 'text', options = {}) => {\n    const value = editData[field] || '';\n    \n    if (!isEditing) {\n      if (type === 'textarea') {\n        return (\n          <div className=\"space-y-2\">\n            <label className=\"block text-sm font-medium text-gray-700\">{label}</label>\n            <div className=\"p-3 bg-gray-50 rounded-lg border min-h-[2.5rem] text-gray-800\">\n              {value || <span className=\"text-gray-400 italic\">Not specified</span>}\n            </div>\n          </div>\n        );\n      }\n      \n      if (type === 'select') {\n        return (\n          <div className=\"space-y-2\">\n            <label className=\"block text-sm font-medium text-gray-700\">{label}</label>\n            <div className=\"p-3 bg-gray-50 rounded-lg border text-gray-800\">\n              {value || <span className=\"text-gray-400 italic\">Not specified</span>}\n            </div>\n          </div>\n        );\n      }\n      \n      return (\n        <div className=\"space-y-2\">\n          <label className=\"block text-sm font-medium text-gray-700\">{label}</label>\n          <div className=\"p-3 bg-gray-50 rounded-lg border text-gray-800\">\n            {value || <span className=\"text-gray-400 italic\">Not specified</span>}\n          </div>\n        </div>\n      );\n    }\n\n    // Editing mode\n    if (type === 'textarea') {\n      return (\n        <div className=\"space-y-2\">\n          <label className=\"block text-sm font-medium text-gray-700\">{label}</label>\n          <textarea\n            value={value}\n            onChange={(e) => updateField(field, e.target.value)}\n            className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors\"\n            rows={options.rows || 3}\n            placeholder={`Enter ${label.toLowerCase()}...`}\n          />\n        </div>\n      );\n    }\n\n    if (type === 'select' && options.choices) {\n      return (\n        <div className=\"space-y-2\">\n          <label className=\"block text-sm font-medium text-gray-700\">{label}</label>\n          <select\n            value={value}\n            onChange={(e) => updateField(field, e.target.value)}\n            className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors\"\n          >\n            <option value=\"\">Select {label.toLowerCase()}...</option>\n            {options.choices.map(choice => (\n              <option key={choice} value={choice}>{choice}</option>\n            ))}\n          </select>\n        </div>\n      );\n    }\n\n    return (\n      <div className=\"space-y-2\">\n        <label className=\"block text-sm font-medium text-gray-700\">{label}</label>\n        <input\n          type={type}\n          value={value}\n          onChange={(e) => updateField(field, type === 'number' ? Number(e.target.value) : e.target.value)}\n          className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors\"\n          placeholder={`Enter ${label.toLowerCase()}...`}\n        />\n      </div>\n    );\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <AnimatePresence mode=\"wait\" onExitComplete={() => {\n      setIsAnimating(false);\n      setIsClosing(false);\n      setHasInitialized(false);\n      onClose();\n      if (onAnimationEnd) onAnimationEnd();\n    }}>\n      {isVisible && (\n        <motion.div\n          key={`case-modal-${data?.id || 'default'}`}\n          initial=\"hidden\"\n          animate=\"visible\"\n          exit=\"exit\"\n          variants={backdropVariants}\n          className=\"fixed inset-0 bg-black flex items-center justify-center z-50\"\n          style={{ \n            willChange: 'backdrop-filter, opacity',\n            backfaceVisibility: 'hidden',\n            transform: 'translate3d(0, 0, 0)'\n          }}\n          onClick={(e) => e.target === e.currentTarget && handleClose()}\n        >\n          <motion.div\n            initial=\"hidden\"\n            animate=\"visible\"\n            exit=\"exit\"\n            variants={modalVariants}\n            className=\"bg-white rounded-2xl shadow-2xl max-w-4xl w-full mx-4 max-h-[85vh] overflow-hidden\"\n            style={{ \n              willChange: 'transform, opacity, scale',\n              backfaceVisibility: 'hidden'\n            }}\n            onClick={(e) => e.stopPropagation()}\n            onAnimationStart={() => {\n              setIsAnimating(true);\n              if (onAnimationStart) onAnimationStart();\n            }}\n            onAnimationComplete={() => {\n              setIsAnimating(false);\n              if (onAnimationEnd) onAnimationEnd();\n            }}\n          >\n            <motion.div \n              initial=\"hidden\"\n              animate=\"visible\"\n              exit=\"exit\"\n              variants={contentVariants}\n              className=\"bg-gradient-to-r from-indigo-600 to-blue-600 text-white px-6 py-4 flex items-center justify-between\"\n            >\n              <div className=\"flex items-center gap-3\">\n                <Users size={24} />\n                <h2 className=\"text-xl font-semibold\">Case Details</h2>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                {!isEditing && !isLoading && (\n                  <>\n                    <button\n                      onClick={() => setIsEditing(true)}\n                      className=\"text-white hover:text-gray-200 p-2 rounded-full hover:bg-white hover:bg-opacity-20 transition-all\"\n                      title=\"Edit\"\n                    >\n                      <Edit3 size={20} />\n                    </button>\n                    <button\n                      onClick={handleDelete}\n                      className=\"text-white hover:text-red-200 p-2 rounded-full hover:bg-red-500 hover:bg-opacity-30 transition-all\"\n                      title=\"Delete\"\n                    >\n                      <Trash2 size={20} />\n                    </button>\n                  </>\n                )}\n                <button onClick={handleClose} className=\"text-white hover:text-gray-200 p-2 rounded-full hover:bg-white hover:bg-opacity-20 transition-all\">\n                  <X size={20} />\n                </button>\n              </div>\n            </motion.div>\n\n            {/* Tab Navigation */}\n            <div className=\"bg-gradient-to-r from-slate-900 via-slate-800 to-slate-900 border-b border-slate-600\">\n              <nav className=\"flex flex-wrap gap-2 px-6 py-4\">\n                {[\n                  { key: 'overview', label: 'Overview', icon: Users },\n                  { key: 'narrative', label: 'Narrative', icon: FileText },\n                  { key: 'medications', label: 'Medications', icon: Clipboard },\n                  { key: 'therapy', label: 'Therapy', icon: Heart },\n                  { key: 'timeline', label: 'Timeline', icon: Clock },\n                  { key: 'insights', label: 'Insights', icon: Sparkles },\n                  { key: 'related', label: 'Related', icon: Target }\n                ].map(({ key, label, icon: Icon }) => (\n                  <motion.button\n                    key={key}\n                    onClick={() => {\n                      if (isTabTransitioning) return;\n                      setIsTabTransitioning(true);\n                      setActiveTab(key);\n                      setTimeout(() => setIsTabTransitioning(false), 300);\n                    }}\n                    className={`relative flex items-center gap-2 px-4 py-3 rounded-xl font-medium text-sm transition-all duration-300 ${\n                      activeTab === key\n                        ? 'bg-gradient-to-r from-blue-500 to-indigo-600 text-white shadow-lg shadow-blue-500/25'\n                        : 'text-slate-300 hover:text-white hover:bg-slate-700/50 hover:shadow-md'\n                    }`}\n                    whileHover={{ scale: activeTab === key ? 1 : 1.02 }}\n                    whileTap={{ scale: 0.98 }}\n                    initial={false}\n                    animate={{\n                      scale: activeTab === key ? 1.05 : 1,\n                      boxShadow: activeTab === key \n                        ? '0 8px 25px rgba(59, 130, 246, 0.3), 0 0 20px rgba(99, 102, 241, 0.2)' \n                        : '0 2px 8px rgba(0, 0, 0, 0.1)'\n                    }}\n                    transition={{ duration: 0.3, ease: \"easeOut\" }}\n                  >\n                    <Icon size={16} className={activeTab === key ? 'drop-shadow-sm' : ''} />\n                    {label}\n                    {/* Timeline notification badge */}\n                    {key === 'timeline' && timelineEntries.some(entry => entry.isNew) && (\n                      <span className=\"absolute -top-1 -right-1 inline-flex items-center justify-center w-4 h-4 text-xs font-bold text-white bg-red-500 rounded-full animate-pulse\">\n                        !\n                      </span>\n                    )}\n                    \n                    {activeTab === key && (\n                      <motion.div\n                        layoutId=\"tabGlow\"\n                        className=\"absolute inset-0 bg-gradient-to-r from-blue-400/20 to-indigo-500/20 rounded-xl blur-sm\"\n                        initial={false}\n                        transition={{ type: \"spring\", bounce: 0.2, duration: 0.6 }}\n                      />\n                    )}\n                  </motion.button>\n                ))}\n              </nav>\n            </div>\n            \n            {/* Tab Content */}\n            <motion.div \n              className=\"relative overflow-hidden bg-gradient-to-br from-slate-50 to-slate-100\"\n              layout=\"position\"\n              layoutRoot\n              transition={{ \n                layout: { duration: 0.4, ease: \"easeInOut\" },\n                height: { duration: 0.4, ease: \"easeInOut\" }\n              }}\n            >\n              <AnimatePresence mode=\"wait\" initial={false} onExitComplete={() => setIsTabTransitioning(false)}>\n                {/* Overview Tab */}\n                {activeTab === 'overview' && (\n                  <motion.div\n                    key=\"overview\"\n                    initial={{ opacity: 0, x: -30 }}\n                    animate={{ opacity: 1, x: 0 }}\n                    exit={{ opacity: 0, x: 30 }}\n                    transition={{ duration: 0.4, ease: \"easeOut\" }}\n                    layout=\"position\"\n                    layoutId=\"tabContent\"\n                    className=\"p-6 overflow-y-auto max-h-[calc(85vh-200px)] scrollbar-thin scrollbar-thumb-slate-400 scrollbar-track-slate-200\"\n                  >\n                    <div className=\"space-y-6\">\n                      <div className=\"bg-white rounded-xl p-6 shadow-lg border border-slate-200\">\n                        <h3 className=\"text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2\">\n                          <Users size={20} className=\"text-blue-600\" />\n                          Demographics & Basic Info\n                        </h3>\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                          {renderField('Case ID', 'case_id')}\n                          {renderField('Primary Diagnosis', 'primary_diagnosis')}\n                          {renderField('Age', 'age', 'number')}\n                          {renderField('Gender', 'gender', 'select', {\n                            choices: ['Male', 'Female', 'Non-binary', 'Other']\n                          })}\n                        </div>\n                      </div>\n                      \n                      <div className=\"bg-white rounded-xl p-6 shadow-lg border border-slate-200\">\n                        <h3 className=\"text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2\">\n                          <AlertCircle size={20} className=\"text-amber-600\" />\n                          Initial Impressions\n                        </h3>\n                        <div className=\"space-y-4\">\n                          {renderField('Chief Complaint', 'chiefComplaint', 'textarea', { rows: 3 })}\n                          {renderField('Initial Presentation', 'initialPresentation', 'textarea', { rows: 4 })}\n                        </div>\n                      </div>\n                    </div>\n                  </motion.div>\n                )}\n\n                {/* Narrative Tab */}\n                {activeTab === 'narrative' && (\n                  <motion.div\n                    key=\"narrative\"\n                    initial={{ opacity: 0, x: -30 }}\n                    animate={{ opacity: 1, x: 0 }}\n                    exit={{ opacity: 0, x: 30 }}\n                    transition={{ duration: 0.4, ease: \"easeOut\" }}\n                    layout=\"position\"\n                    layoutId=\"tabContent\"\n                    className=\"p-6 overflow-y-auto max-h-[calc(85vh-200px)] scrollbar-thin scrollbar-thumb-slate-400 scrollbar-track-slate-200\"\n                  >\n                    <div className=\"bg-white rounded-xl p-6 shadow-lg border border-slate-200\">\n                      <h3 className=\"text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2\">\n                        <FileText size={20} className=\"text-green-600\" />\n                        Patient Story & Narrative\n                      </h3>\n                      <div className=\"space-y-6\">\n                        {renderField('Current Presentation', 'currentPresentation', 'textarea', { rows: 8 })}\n                        <div className=\"text-sm text-slate-600 bg-slate-50 p-4 rounded-lg\">\n                          <p className=\"italic\">Use this space to tell the patient's story in your own words. Include context, progression, and your narrative understanding of their journey.</p>\n                        </div>\n                      </div>\n                    </div>\n                  </motion.div>\n                )}\n\n                {/* Other tabs would continue here following the same pattern... */}\n                {/* For brevity, I'll include key tabs. The full implementation would include all tabs */}\n                \n                {/* Timeline Tab */}\n                {activeTab === 'timeline' && (\n                  <motion.div\n                    key=\"timeline\"\n                    initial={{ opacity: 0, x: -30 }}\n                    animate={{ opacity: 1, x: 0 }}\n                    exit={{ opacity: 0, x: 30 }}\n                    transition={{ duration: 0.4, ease: \"easeOut\" }}\n                    layout=\"position\"\n                    layoutId=\"tabContent\"\n                    className=\"p-6 h-[calc(85vh-200px)]\"\n                  >\n                    <div className=\"flex justify-between items-center mb-4\">\n                      <h3 className=\"text-lg font-semibold text-gray-800\">Case Timeline</h3>\n                      <motion.button\n                        whileHover={{ scale: 1.05 }}\n                        whileTap={{ scale: 0.95 }}\n                        onClick={scrollToLatest}\n                        className=\"flex items-center gap-2 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm\"\n                      >\n                        <ArrowDown size={16} />\n                        Scroll to Latest\n                      </motion.button>\n                    </div>\n                    \n                    {/* Timeline implementation */}\n                    <div className=\"relative\">\n                      <div className=\"absolute top-0 left-0 right-0 h-6 bg-gradient-to-b from-white to-transparent z-10 pointer-events-none\" />\n                      \n                      <div\n                        ref={timelineScrollRef}\n                        className=\"max-h-96 overflow-y-auto bg-gradient-to-br from-slate-900 to-slate-800 rounded-xl p-4 space-y-4 scrollbar-thin scrollbar-thumb-slate-600 scrollbar-track-slate-800\"\n                        style={{\n                          scrollbarWidth: 'thin',\n                          scrollbarColor: '#475569 #1e293b'\n                        }}\n                      >\n                        {timelineEntries.map((entry, index) => (\n                          <motion.div\n                            key={entry.id}\n                            initial={{ opacity: 0, y: 20 }}\n                            animate={{ opacity: 1, y: 0 }}\n                            exit={{ opacity: 0, y: -20 }}\n                            transition={{ delay: index * 0.1, duration: 0.4 }}\n                            className={`relative ${entry.isNew ? 'animate-pulse' : ''}`}\n                          >\n                            {index < timelineEntries.length - 1 && (\n                              <div className=\"absolute left-6 top-12 w-0.5 h-16 bg-gradient-to-b from-blue-400 to-purple-500\" />\n                            )}\n                            \n                            <motion.div\n                              whileHover={{ \n                                scale: 1.02,\n                                boxShadow: '0 10px 25px rgba(59, 130, 246, 0.15)'\n                              }}\n                              whileTap={{ scale: 0.98 }}\n                              onClick={() => toggleTimelineEntry(entry.id)}\n                              className={`relative bg-gradient-to-r from-slate-800 to-slate-700 rounded-lg p-4 cursor-pointer border-l-4 transition-all duration-300 ${\n                                entry.type === 'assessment' ? 'border-green-400' :\n                                entry.type === 'medication' ? 'border-blue-400' :\n                                entry.type === 'therapy' ? 'border-purple-400' :\n                                'border-orange-400'\n                              } ${entry.isNew ? 'ring-2 ring-blue-400 ring-opacity-50' : ''}`}\n                            >\n                              <div className=\"flex items-start justify-between\">\n                                <div className=\"flex items-start gap-3\">\n                                  <div className={`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center ${\n                                    entry.type === 'assessment' ? 'bg-green-500' :\n                                    entry.type === 'medication' ? 'bg-blue-500' :\n                                    entry.type === 'therapy' ? 'bg-purple-500' :\n                                    'bg-orange-500'\n                                  }`}>\n                                    {entry.type === 'assessment' && <Clipboard size={16} className=\"text-white\" />}\n                                    {entry.type === 'medication' && <Heart size={16} className=\"text-white\" />}\n                                    {entry.type === 'therapy' && <Brain size={16} className=\"text-white\" />}\n                                    {entry.type === 'followup' && <Calendar size={16} className=\"text-white\" />}\n                                  </div>\n                                  \n                                  <div className=\"flex-1\">\n                                    <div className=\"flex items-center gap-2 mb-1\">\n                                      <h4 className=\"text-white font-semibold text-sm\">{entry.title}</h4>\n                                      {entry.isNew && (\n                                        <motion.span\n                                          animate={{ \n                                            scale: [1, 1.2, 1],\n                                            opacity: [0.7, 1, 0.7]\n                                          }}\n                                          transition={{ \n                                            duration: 2, \n                                            repeat: Infinity,\n                                            ease: \"easeInOut\"\n                                          }}\n                                          className=\"inline-flex items-center px-2 py-1 text-xs font-medium bg-blue-500 text-white rounded-full\"\n                                        >\n                                          New\n                                        </motion.span>\n                                      )}\n                                    </div>\n                                    <div className=\"flex items-center gap-4 text-xs text-slate-300 mb-2\">\n                                      <span className=\"flex items-center gap-1\">\n                                        <Calendar size={12} />\n                                        {entry.date}\n                                      </span>\n                                      <span className=\"flex items-center gap-1\">\n                                        <Clock size={12} />\n                                        {entry.time}\n                                      </span>\n                                      <span>by {entry.author}</span>\n                                    </div>\n                                    <p className=\"text-slate-200 text-sm\">{entry.summary}</p>\n                                  </div>\n                                </div>\n                                \n                                <motion.div\n                                  animate={{ rotate: expandedTimelineEntry === entry.id ? 180 : 0 }}\n                                  transition={{ duration: 0.2 }}\n                                >\n                                  <ChevronDown size={20} className=\"text-slate-400\" />\n                                </motion.div>\n                              </div>\n                              \n                              <AnimatePresence>\n                                {expandedTimelineEntry === entry.id && (\n                                  <motion.div\n                                    initial={{ height: 0, opacity: 0 }}\n                                    animate={{ height: \"auto\", opacity: 1 }}\n                                    exit={{ height: 0, opacity: 0 }}\n                                    transition={{ duration: 0.3, ease: \"easeInOut\" }}\n                                    className=\"overflow-hidden\"\n                                  >\n                                    <div className=\"mt-4 pt-4 border-t border-slate-600\">\n                                      <h5 className=\"text-white font-medium text-sm mb-2\">Detailed Notes:</h5>\n                                      <p className=\"text-slate-300 text-sm leading-relaxed\">{entry.details}</p>\n                                    </div>\n                                  </motion.div>\n                                )}\n                              </AnimatePresence>\n                            </motion.div>\n                          </motion.div>\n                        ))}\n                      </div>\n                      \n                      <div className=\"absolute bottom-0 left-0 right-0 h-6 bg-gradient-to-t from-white to-transparent z-10 pointer-events-none\" />\n                    </div>\n                  </motion.div>\n                )}\n              </AnimatePresence>\n            </motion.div>\n\n            {isEditing && (\n              <div className=\"sticky bottom-0 bg-gray-50 border-t border-gray-200 px-6 py-4 flex items-center justify-between\">\n                <div className=\"text-sm text-gray-500\">\n                  Changes will be auto-saved\n                </div>\n                <div className=\"flex items-center gap-3\">\n                  <button\n                    onClick={() => {\n                      setIsEditing(false);\n                      setEditData({ ...data });\n                    }}\n                    disabled={isLoading}\n                    className=\"px-4 py-2 text-gray-600 hover:text-gray-800 border border-gray-300 rounded-lg hover:bg-gray-100 transition-colors\"\n                  >\n                    Cancel\n                  </button>\n                  <button\n                    onClick={handleSave}\n                    disabled={isLoading}\n                    className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2\"\n                  >\n                    {isLoading ? <Loader2 size={16} className=\"animate-spin\" /> : <Save size={16} />}\n                    {isLoading ? 'Saving...' : 'Save Changes'}\n                  </button>\n                </div>\n              </div>\n            )}\n          </motion.div>\n        </motion.div>\n      )}\n    </AnimatePresence>\n  );\n};\n\nexport default React.memo(CaseModal, (prevProps, nextProps) => {\n  return (\n    prevProps.isOpen === nextProps.isOpen &&\n    prevProps.data?.id === nextProps.data?.id &&\n    prevProps.data?.updated_at === nextProps.data?.updated_at\n  );\n});\n","// Enhanced Topic Modal with tabbed interface and advanced animations\nimport React, { useState, useEffect, useMemo, useCallback, useRef } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { \n  X, \n  BookOpen, \n  Brain, \n  Target, \n  Award, \n  Clock, \n  Sparkles, \n  Link2,\n  Edit3,\n  Trash2,\n  Save,\n  Loader2,\n  Star,\n  Plus,\n  Check,\n  RotateCcw,\n  TrendingUp,\n  Lightbulb,\n  FileText,\n  Layers\n} from 'lucide-react';\n\n// Animation variants for Framer Motion\nconst modalVariants = {\n  hidden: {\n    opacity: 0,\n    scale: 0.3,\n    y: 50,\n    rotate: -5,\n  },\n  visible: {\n    opacity: 1,\n    scale: 1,\n    y: 0,\n    rotate: 0,\n    transition: {\n      type: \"spring\",\n      damping: 25,\n      stiffness: 300,\n      duration: 0.6,\n    }\n  },\n  exit: {\n    opacity: 0,\n    scale: 0.7,\n    y: 30,\n    rotate: -3,\n    transition: {\n      type: \"easeInOut\",\n      duration: 0.4,\n    }\n  }\n};\n\nconst backdropVariants = {\n  hidden: { \n    opacity: 0,\n    backdropFilter: 'blur(0px)'\n  },\n  visible: { \n    opacity: 1,\n    backdropFilter: 'blur(8px)',\n    transition: {\n      duration: 0.4,\n      ease: \"easeOut\"\n    }\n  },\n  exit: { \n    opacity: 0,\n    backdropFilter: 'blur(0px)',\n    transition: {\n      duration: 0.3,\n      ease: \"easeIn\"\n    }\n  }\n};\n\nconst contentVariants = {\n  hidden: {\n    opacity: 0,\n    y: 20,\n    scale: 0.95,\n  },\n  visible: {\n    opacity: 1,\n    y: 0,\n    scale: 1,\n    transition: {\n      type: \"easeOut\",\n      duration: 0.3,\n      delay: 0.1,\n    }\n  },\n  exit: {\n    opacity: 0,\n    y: -10,\n    scale: 1.02,\n    transition: {\n      type: \"easeIn\",\n      duration: 0.2,\n    }\n  }\n};\n\nconst TopicModal = ({ \n  isOpen, \n  data, \n  onClose,\n  onAnimationStart,\n  onAnimationEnd,\n  setMindMapData,\n  autoSaveMindMapData,\n  addToast\n}) => {\n  const [isAnimating, setIsAnimating] = useState(false);\n  const [isVisible, setIsVisible] = useState(false);\n  const [isClosing, setIsClosing] = useState(false);\n  const [isEditing, setIsEditing] = useState(false);\n  const [editData, setEditData] = useState({});\n  const [isLoading, setIsLoading] = useState(false);\n  const [hasInitialized, setHasInitialized] = useState(false);\n  const [activeTab, setActiveTab] = useState('overview');\n  const [isTabTransitioning, setIsTabTransitioning] = useState(false);\n  const [newResource, setNewResource] = useState('');\n  const [showResourceForm, setShowResourceForm] = useState(false);\n\n  useEffect(() => {\n    if (isOpen && data && !hasInitialized) {\n      setIsVisible(true);\n      setEditData({ \n        ...data,\n        resources: data.resources || [],\n        flashcard_count: data.flashcard_count || 0,\n        completed_flashcards: data.completed_flashcards || 0\n      });\n      setHasInitialized(true);\n      setIsAnimating(true);\n      if (onAnimationStart) onAnimationStart();\n      \n      setTimeout(() => {\n        setIsAnimating(false);\n        if (onAnimationEnd) onAnimationEnd();\n      }, 600);\n    } else if (!isOpen && hasInitialized) {\n      setHasInitialized(false);\n    }\n  }, [isOpen, hasInitialized, onAnimationStart, onAnimationEnd]);\n\n  // Separate effect for data updates when modal is already open\n  useEffect(() => {\n    if (isOpen && data && hasInitialized && !isEditing && !isLoading && !isTabTransitioning && !isAnimating) {\n      setEditData({ \n        ...data,\n        resources: data.resources || [],\n        flashcard_count: data.flashcard_count || 0,\n        completed_flashcards: data.completed_flashcards || 0\n      });\n    }\n  }, [data?.id, isOpen, hasInitialized, isEditing, isLoading, isTabTransitioning, isAnimating]);\n\n  const progressPercentage = useMemo(() => {\n    const total = editData.flashcard_count || 0;\n    const completed = editData.completed_flashcards || 0;\n    return total > 0 ? Math.round((completed / total) * 100) : 0;\n  }, [editData.flashcard_count, editData.completed_flashcards]);\n\n  const handleClose = useCallback(() => {\n    if (isAnimating || isClosing) return;\n    \n    setIsAnimating(true);\n    setIsClosing(true);\n    if (onAnimationStart) onAnimationStart();\n    \n    // Set visibility to false to trigger exit animation\n    setIsVisible(false);\n  }, [onAnimationStart, isAnimating, isClosing]);\n\n  const handleSave = useCallback(async () => {\n    if (isLoading) return;\n    \n    setIsLoading(true);\n    try {\n      setMindMapData(prevData => {\n        const updatedTopics = prevData.topics.map(topic =>\n          String(topic.id) === String(data?.id) ? { ...topic, ...editData } : topic\n        );\n        const newData = { ...prevData, topics: updatedTopics };\n        autoSaveMindMapData(newData);\n        return newData;\n      });\n      \n      setIsEditing(false);\n      addToast('Topic updated successfully', 'success');\n    } catch (error) {\n      console.error('Error saving topic:', error);\n      addToast('Failed to save topic', 'error');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [data?.id, editData, setMindMapData, autoSaveMindMapData, addToast, isLoading]);\n\n  const handleDelete = useCallback(async () => {\n    if (isLoading) return;\n    \n    if (!window.confirm('Are you sure you want to delete this topic?')) return;\n    \n    setIsLoading(true);\n    try {\n      setMindMapData(prevData => {\n        const updatedTopics = prevData.topics.filter(topic => String(topic.id) !== String(data?.id));\n        const newData = { ...prevData, topics: updatedTopics };\n        autoSaveMindMapData(newData);\n        return newData;\n      });\n      \n      addToast('Topic deleted successfully', 'success');\n      handleClose();\n    } catch (error) {\n      console.error('Error deleting topic:', error);\n      addToast('Failed to delete topic', 'error');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [data?.id, setMindMapData, autoSaveMindMapData, addToast, handleClose, isLoading]);\n\n  const updateField = useCallback((field, value) => {\n    setEditData(prev => ({ ...prev, [field]: value }));\n  }, []);\n\n  const addResource = useCallback(() => {\n    if (!newResource.trim()) return;\n    \n    const updatedResources = [...(editData.resources || []), newResource.trim()];\n    updateField('resources', updatedResources);\n    setNewResource('');\n    setShowResourceForm(false);\n  }, [newResource, editData.resources, updateField]);\n\n  const removeResource = useCallback((index) => {\n    const updatedResources = editData.resources.filter((_, i) => i !== index);\n    updateField('resources', updatedResources);\n  }, [editData.resources, updateField]);\n\n  const renderField = (label, field, type = 'text', options = {}) => {\n    const value = editData[field] || '';\n    \n    if (!isEditing) {\n      if (type === 'textarea') {\n        return (\n          <div className=\"space-y-2\">\n            <label className=\"block text-sm font-medium text-gray-700\">{label}</label>\n            <div className=\"p-3 bg-gray-50 rounded-lg border min-h-[2.5rem] text-gray-800\">\n              {value || <span className=\"text-gray-400 italic\">Not specified</span>}\n            </div>\n          </div>\n        );\n      }\n      \n      if (type === 'select') {\n        return (\n          <div className=\"space-y-2\">\n            <label className=\"block text-sm font-medium text-gray-700\">{label}</label>\n            <div className=\"p-3 bg-gray-50 rounded-lg border text-gray-800\">\n              {value || <span className=\"text-gray-400 italic\">Not specified</span>}\n            </div>\n          </div>\n        );\n      }\n      \n      return (\n        <div className=\"space-y-2\">\n          <label className=\"block text-sm font-medium text-gray-700\">{label}</label>\n          <div className=\"p-3 bg-gray-50 rounded-lg border text-gray-800\">\n            {value || <span className=\"text-gray-400 italic\">Not specified</span>}\n          </div>\n        </div>\n      );\n    }\n\n    // Editing mode\n    if (type === 'textarea') {\n      return (\n        <div className=\"space-y-2\">\n          <label className=\"block text-sm font-medium text-gray-700\">{label}</label>\n          <textarea\n            value={value}\n            onChange={(e) => updateField(field, e.target.value)}\n            className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors\"\n            rows={options.rows || 3}\n            placeholder={`Enter ${label.toLowerCase()}...`}\n          />\n        </div>\n      );\n    }\n\n    if (type === 'select' && options.choices) {\n      return (\n        <div className=\"space-y-2\">\n          <label className=\"block text-sm font-medium text-gray-700\">{label}</label>\n          <select\n            value={value}\n            onChange={(e) => updateField(field, e.target.value)}\n            className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors\"\n          >\n            <option value=\"\">Select {label.toLowerCase()}...</option>\n            {options.choices.map(choice => (\n              <option key={choice} value={choice}>{choice}</option>\n            ))}\n          </select>\n        </div>\n      );\n    }\n\n    return (\n      <div className=\"space-y-2\">\n        <label className=\"block text-sm font-medium text-gray-700\">{label}</label>\n        <input\n          type={type}\n          value={value}\n          onChange={(e) => updateField(field, type === 'number' ? Number(e.target.value) : e.target.value)}\n          className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors\"\n          placeholder={`Enter ${label.toLowerCase()}...`}\n        />\n      </div>\n    );\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <AnimatePresence mode=\"wait\" onExitComplete={() => {\n      setIsAnimating(false);\n      setIsClosing(false);\n      setHasInitialized(false);\n      onClose();\n      if (onAnimationEnd) onAnimationEnd();\n    }}>\n      {isVisible && (\n        <motion.div\n          key={`topic-modal-${data?.id || 'default'}`}\n          initial=\"hidden\"\n          animate=\"visible\"\n          exit=\"exit\"\n          variants={backdropVariants}\n          className=\"fixed inset-0 bg-black flex items-center justify-center z-50\"\n          style={{ \n            willChange: 'backdrop-filter, opacity',\n            backfaceVisibility: 'hidden',\n            transform: 'translate3d(0, 0, 0)'\n          }}\n          onClick={(e) => e.target === e.currentTarget && handleClose()}\n        >\n          <motion.div\n            initial=\"hidden\"\n            animate=\"visible\"\n            exit=\"exit\"\n            variants={modalVariants}\n            className=\"bg-white rounded-2xl shadow-2xl max-w-4xl w-full mx-4 max-h-[85vh] overflow-hidden\"\n            style={{ \n              willChange: 'transform, opacity, scale',\n              backfaceVisibility: 'hidden'\n            }}\n            onClick={(e) => e.stopPropagation()}\n            onAnimationStart={() => {\n              setIsAnimating(true);\n              if (onAnimationStart) onAnimationStart();\n            }}\n            onAnimationComplete={() => {\n              setIsAnimating(false);\n              if (onAnimationEnd) onAnimationEnd();\n            }}\n          >\n            <motion.div \n              initial=\"hidden\"\n              animate=\"visible\"\n              exit=\"exit\"\n              variants={contentVariants}\n              className=\"bg-gradient-to-br from-slate-900 to-slate-800 text-white px-6 py-4 flex items-center justify-between\"\n            >\n              <div className=\"flex items-center gap-3\">\n                <BookOpen size={24} />\n                <h2 className=\"text-xl font-semibold\">Topic Details</h2>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                {!isEditing && !isLoading && (\n                  <>\n                    <button\n                      onClick={() => setIsEditing(true)}\n                      className=\"text-white hover:text-gray-200 p-2 rounded-full hover:bg-white hover:bg-opacity-20 transition-all\"\n                      title=\"Edit\"\n                    >\n                      <Edit3 size={20} />\n                    </button>\n                    <button\n                      onClick={handleDelete}\n                      className=\"text-white hover:text-red-200 p-2 rounded-full hover:bg-red-500 hover:bg-opacity-30 transition-all\"\n                      title=\"Delete\"\n                    >\n                      <Trash2 size={20} />\n                    </button>\n                  </>\n                )}\n                <button onClick={handleClose} className=\"text-white hover:text-gray-200 p-2 rounded-full hover:bg-white hover:bg-opacity-20 transition-all\">\n                  <X size={20} />\n                </button>\n              </div>\n            </motion.div>\n\n            {/* Tab Navigation */}\n            <div className=\"bg-gradient-to-r from-slate-900 via-slate-800 to-slate-900 border-b border-slate-600\">\n              <nav className=\"flex flex-wrap gap-2 px-6 py-4\">\n                {[\n                  { key: 'overview', label: 'Overview', icon: BookOpen },\n                  { key: 'progress', label: 'Progress', icon: TrendingUp },\n                  { key: 'resources', label: 'Resources', icon: FileText },\n                  { key: 'insights', label: 'Insights', icon: Lightbulb },\n                  { key: 'connections', label: 'Connections', icon: Link2 }\n                ].map(({ key, label, icon: Icon }) => (\n                  <motion.button\n                    key={key}\n                    onClick={() => {\n                      if (isTabTransitioning) return;\n                      setIsTabTransitioning(true);\n                      setActiveTab(key);\n                      setTimeout(() => setIsTabTransitioning(false), 300);\n                    }}\n                    className={`relative flex items-center gap-2 px-4 py-3 rounded-xl font-medium text-sm transition-all duration-300 ${\n                      activeTab === key\n                        ? 'bg-gradient-to-r from-purple-500 to-indigo-600 text-white shadow-lg shadow-purple-500/25'\n                        : 'text-slate-300 hover:text-white hover:bg-slate-700/50 hover:shadow-md'\n                    }`}\n                    whileHover={{ scale: activeTab === key ? 1 : 1.02 }}\n                    whileTap={{ scale: 0.98 }}\n                    initial={false}\n                    animate={{\n                      scale: activeTab === key ? 1.05 : 1,\n                      boxShadow: activeTab === key \n                        ? '0 8px 25px rgba(147, 51, 234, 0.3), 0 0 20px rgba(99, 102, 241, 0.2)' \n                        : '0 2px 8px rgba(0, 0, 0, 0.1)'\n                    }}\n                    transition={{ duration: 0.3, ease: \"easeOut\" }}\n                  >\n                    <Icon size={16} className={activeTab === key ? 'drop-shadow-sm' : ''} />\n                    {label}\n                    \n                    {activeTab === key && (\n                      <motion.div\n                        layoutId=\"topicTabGlow\"\n                        className=\"absolute inset-0 bg-gradient-to-r from-purple-400/20 to-indigo-500/20 rounded-xl blur-sm\"\n                        initial={false}\n                        transition={{ type: \"spring\", bounce: 0.2, duration: 0.6 }}\n                      />\n                    )}\n                  </motion.button>\n                ))}\n              </nav>\n            </div>\n            \n            {/* Tab Content */}\n            <motion.div \n              className=\"relative overflow-hidden bg-gradient-to-br from-slate-50 to-slate-100\"\n              layout=\"position\"\n              layoutRoot\n              transition={{ \n                layout: { duration: 0.4, ease: \"easeInOut\" },\n                height: { duration: 0.4, ease: \"easeInOut\" }\n              }}\n            >\n              <AnimatePresence mode=\"wait\" initial={false} onExitComplete={() => setIsTabTransitioning(false)}>\n                {/* Overview Tab */}\n                {activeTab === 'overview' && (\n                  <motion.div\n                    key=\"overview\"\n                    initial={{ opacity: 0, x: -30 }}\n                    animate={{ opacity: 1, x: 0 }}\n                    exit={{ opacity: 0, x: 30 }}\n                    transition={{ duration: 0.4, ease: \"easeOut\" }}\n                    layout=\"position\"\n                    layoutId=\"tabContent\"\n                    className=\"p-6 overflow-y-auto max-h-[calc(85vh-200px)] scrollbar-thin scrollbar-thumb-slate-400 scrollbar-track-slate-200\"\n                  >\n                    <div className=\"space-y-6\">\n                      <div className=\"bg-white rounded-xl p-6 shadow-lg border border-slate-200\">\n                        <h3 className=\"text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2\">\n                          <Brain size={20} className=\"text-purple-600\" />\n                          Topic Information\n                        </h3>\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                          {renderField('Title', 'title')}\n                          {renderField('Category', 'category', 'select', {\n                            choices: [\n                              'Mood Disorders',\n                              'Anxiety Disorders', \n                              'Psychotic Disorders',\n                              'Personality Disorders',\n                              'Substance Use Disorders',\n                              'Neurodevelopmental Disorders',\n                              'Trauma-Related Disorders',\n                              'Eating Disorders',\n                              'Sleep Disorders',\n                              'Neurocognitive Disorders',\n                              'Other'\n                            ]\n                          })}\n                        </div>\n                        <div className=\"mt-6\">\n                          {renderField('Description', 'description', 'textarea', { rows: 4 })}\n                        </div>\n                      </div>\n                      \n                      <div className=\"bg-white rounded-xl p-6 shadow-lg border border-slate-200\">\n                        <h3 className=\"text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2\">\n                          <Target size={20} className=\"text-green-600\" />\n                          Learning Progress\n                        </h3>\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                          {renderField('Total Flashcards', 'flashcard_count', 'number')}\n                          {renderField('Completed Flashcards', 'completed_flashcards', 'number')}\n                        </div>\n                        \n                        {/* Progress Visualization */}\n                        <div className=\"mt-6\">\n                          <div className=\"flex items-center justify-between mb-2\">\n                            <span className=\"text-sm font-medium text-gray-700\">Progress</span>\n                            <span className=\"text-sm text-gray-500\">{progressPercentage}%</span>\n                          </div>\n                          <div className=\"w-full bg-gray-200 rounded-full h-2\">\n                            <motion.div\n                              className=\"bg-gradient-to-r from-purple-500 to-indigo-600 h-2 rounded-full\"\n                              initial={{ width: 0 }}\n                              animate={{ width: `${progressPercentage}%` }}\n                              transition={{ duration: 0.8, ease: \"easeOut\" }}\n                            />\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  </motion.div>\n                )}\n\n                {/* Progress Tab */}\n                {activeTab === 'progress' && (\n                  <motion.div\n                    key=\"progress\"\n                    initial={{ opacity: 0, x: -30 }}\n                    animate={{ opacity: 1, x: 0 }}\n                    exit={{ opacity: 0, x: 30 }}\n                    transition={{ duration: 0.4, ease: \"easeOut\" }}\n                    layout=\"position\"\n                    layoutId=\"tabContent\"\n                    className=\"p-6 overflow-y-auto max-h-[calc(85vh-200px)] scrollbar-thin scrollbar-thumb-slate-400 scrollbar-track-slate-200\"\n                  >\n                    <div className=\"bg-white rounded-xl p-6 shadow-lg border border-slate-200\">\n                      <h3 className=\"text-lg font-semibold text-slate-800 mb-6 flex items-center gap-2\">\n                        <TrendingUp size={20} className=\"text-blue-600\" />\n                        Learning Analytics\n                      </h3>\n                      \n                      {/* Progress Cards */}\n                      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8\">\n                        <motion.div\n                          whileHover={{ scale: 1.02 }}\n                          className=\"bg-gradient-to-br from-green-50 to-emerald-50 p-4 rounded-lg border border-green-200\"\n                        >\n                          <div className=\"flex items-center gap-3 mb-2\">\n                            <Check size={20} className=\"text-green-600\" />\n                            <span className=\"font-medium text-green-800\">Completed</span>\n                          </div>\n                          <div className=\"text-2xl font-bold text-green-700\">\n                            {editData.completed_flashcards || 0}\n                          </div>\n                          <div className=\"text-sm text-green-600\">flashcards mastered</div>\n                        </motion.div>\n                        \n                        <motion.div\n                          whileHover={{ scale: 1.02 }}\n                          className=\"bg-gradient-to-br from-blue-50 to-indigo-50 p-4 rounded-lg border border-blue-200\"\n                        >\n                          <div className=\"flex items-center gap-3 mb-2\">\n                            <Clock size={20} className=\"text-blue-600\" />\n                            <span className=\"font-medium text-blue-800\">Remaining</span>\n                          </div>\n                          <div className=\"text-2xl font-bold text-blue-700\">\n                            {Math.max(0, (editData.flashcard_count || 0) - (editData.completed_flashcards || 0))}\n                          </div>\n                          <div className=\"text-sm text-blue-600\">flashcards to review</div>\n                        </motion.div>\n                        \n                        <motion.div\n                          whileHover={{ scale: 1.02 }}\n                          className=\"bg-gradient-to-br from-purple-50 to-violet-50 p-4 rounded-lg border border-purple-200\"\n                        >\n                          <div className=\"flex items-center gap-3 mb-2\">\n                            <Award size={20} className=\"text-purple-600\" />\n                            <span className=\"font-medium text-purple-800\">Progress</span>\n                          </div>\n                          <div className=\"text-2xl font-bold text-purple-700\">\n                            {progressPercentage}%\n                          </div>\n                          <div className=\"text-sm text-purple-600\">completion rate</div>\n                        </motion.div>\n                      </div>\n                      \n                      {/* Visual Progress Bar */}\n                      <div className=\"mb-6\">\n                        <div className=\"flex items-center justify-between mb-3\">\n                          <span className=\"text-lg font-medium text-gray-800\">Overall Progress</span>\n                          <span className=\"text-sm text-gray-500\">\n                            {editData.completed_flashcards || 0} / {editData.flashcard_count || 0}\n                          </span>\n                        </div>\n                        <div className=\"relative\">\n                          <div className=\"w-full bg-gray-200 rounded-full h-4\">\n                            <motion.div\n                              className=\"bg-gradient-to-r from-purple-500 via-blue-500 to-indigo-600 h-4 rounded-full flex items-center justify-end pr-2\"\n                              initial={{ width: 0 }}\n                              animate={{ width: `${progressPercentage}%` }}\n                              transition={{ duration: 1.2, ease: \"easeOut\" }}\n                            >\n                              {progressPercentage > 10 && (\n                                <span className=\"text-xs font-bold text-white drop-shadow-sm\">\n                                  {progressPercentage}%\n                                </span>\n                              )}\n                            </motion.div>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  </motion.div>\n                )}\n\n                {/* Resources Tab */}\n                {activeTab === 'resources' && (\n                  <motion.div\n                    key=\"resources\"\n                    initial={{ opacity: 0, x: -30 }}\n                    animate={{ opacity: 1, x: 0 }}\n                    exit={{ opacity: 0, x: 30 }}\n                    transition={{ duration: 0.4, ease: \"easeOut\" }}\n                    layout=\"position\"\n                    layoutId=\"tabContent\"\n                    className=\"p-6 overflow-y-auto max-h-[calc(85vh-200px)] scrollbar-thin scrollbar-thumb-slate-400 scrollbar-track-slate-200\"\n                  >\n                    <div className=\"bg-white rounded-xl p-6 shadow-lg border border-slate-200\">\n                      <div className=\"flex items-center justify-between mb-6\">\n                        <h3 className=\"text-lg font-semibold text-slate-800 flex items-center gap-2\">\n                          <FileText size={20} className=\"text-orange-600\" />\n                          Learning Resources\n                        </h3>\n                        {isEditing && (\n                          <button\n                            onClick={() => setShowResourceForm(!showResourceForm)}\n                            className=\"flex items-center gap-2 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm\"\n                          >\n                            <Plus size={16} />\n                            Add Resource\n                          </button>\n                        )}\n                      </div>\n                      \n                      {/* Add Resource Form */}\n                      {isEditing && showResourceForm && (\n                        <motion.div\n                          initial={{ opacity: 0, height: 0 }}\n                          animate={{ opacity: 1, height: \"auto\" }}\n                          exit={{ opacity: 0, height: 0 }}\n                          className=\"mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200\"\n                        >\n                          <div className=\"flex gap-3\">\n                            <input\n                              type=\"text\"\n                              value={newResource}\n                              onChange={(e) => setNewResource(e.target.value)}\n                              placeholder=\"Enter resource URL or description...\"\n                              className=\"flex-1 p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                              onKeyPress={(e) => e.key === 'Enter' && addResource()}\n                            />\n                            <button\n                              onClick={addResource}\n                              className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors\"\n                            >\n                              Add\n                            </button>\n                          </div>\n                        </motion.div>\n                      )}\n                      \n                      {/* Resources List */}\n                      <div className=\"space-y-3\">\n                        {editData.resources && editData.resources.length > 0 ? (\n                          editData.resources.map((resource, index) => (\n                            <motion.div\n                              key={index}\n                              initial={{ opacity: 0, y: 10 }}\n                              animate={{ opacity: 1, y: 0 }}\n                              transition={{ delay: index * 0.1 }}\n                              className=\"flex items-center justify-between p-3 bg-gray-50 rounded-lg border\"\n                            >\n                              <span className=\"text-gray-700\">{resource}</span>\n                              {isEditing && (\n                                <button\n                                  onClick={() => removeResource(index)}\n                                  className=\"text-red-500 hover:text-red-700 p-1 rounded\"\n                                >\n                                  <X size={16} />\n                                </button>\n                              )}\n                            </motion.div>\n                          ))\n                        ) : (\n                          <div className=\"text-center py-8 text-gray-500\">\n                            <FileText size={48} className=\"mx-auto mb-3 text-gray-300\" />\n                            <p>No resources added yet</p>\n                            {isEditing && (\n                              <p className=\"text-sm mt-1\">Click \"Add Resource\" to get started</p>\n                            )}\n                          </div>\n                        )}\n                      </div>\n                    </div>\n                  </motion.div>\n                )}\n\n                {/* Insights Tab */}\n                {activeTab === 'insights' && (\n                  <motion.div\n                    key=\"insights\"\n                    initial={{ opacity: 0, x: -30 }}\n                    animate={{ opacity: 1, x: 0 }}\n                    exit={{ opacity: 0, x: 30 }}\n                    transition={{ duration: 0.4, ease: \"easeOut\" }}\n                    layout=\"position\"\n                    layoutId=\"tabContent\"\n                    className=\"p-6 overflow-y-auto max-h-[calc(85vh-200px)] scrollbar-thin scrollbar-thumb-slate-400 scrollbar-track-slate-200\"\n                  >\n                    <div className=\"bg-white rounded-xl p-6 shadow-lg border border-slate-200\">\n                      <h3 className=\"text-lg font-semibold text-slate-800 mb-6 flex items-center gap-2\">\n                        <Lightbulb size={20} className=\"text-yellow-600\" />\n                        Learning Insights\n                      </h3>\n                      \n                      {/* Insights Cards */}\n                      <div className=\"space-y-4\">\n                        <motion.div\n                          whileHover={{ scale: 1.01 }}\n                          className=\"p-4 bg-gradient-to-r from-yellow-50 to-amber-50 rounded-lg border border-yellow-200\"\n                        >\n                          <div className=\"flex items-start gap-3\">\n                            <Sparkles size={20} className=\"text-yellow-600 mt-1\" />\n                            <div>\n                              <h4 className=\"font-medium text-yellow-800 mb-1\">Study Recommendation</h4>\n                              <p className=\"text-yellow-700 text-sm\">\n                                Based on your progress, consider reviewing foundational concepts before advancing to complex topics.\n                              </p>\n                            </div>\n                          </div>\n                        </motion.div>\n                        \n                        <motion.div\n                          whileHover={{ scale: 1.01 }}\n                          className=\"p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg border border-blue-200\"\n                        >\n                          <div className=\"flex items-start gap-3\">\n                            <Brain size={20} className=\"text-blue-600 mt-1\" />\n                            <div>\n                              <h4 className=\"font-medium text-blue-800 mb-1\">Learning Pattern</h4>\n                              <p className=\"text-blue-700 text-sm\">\n                                You tend to perform better with visual learning materials. Consider adding more diagrams and charts.\n                              </p>\n                            </div>\n                          </div>\n                        </motion.div>\n                        \n                        <motion.div\n                          whileHover={{ scale: 1.01 }}\n                          className=\"p-4 bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg border border-green-200\"\n                        >\n                          <div className=\"flex items-start gap-3\">\n                            <Target size={20} className=\"text-green-600 mt-1\" />\n                            <div>\n                              <h4 className=\"font-medium text-green-800 mb-1\">Next Steps</h4>\n                              <p className=\"text-green-700 text-sm\">\n                                Focus on completing the remaining flashcards to solidify your understanding of this topic.\n                              </p>\n                            </div>\n                          </div>\n                        </motion.div>\n                      </div>\n                    </div>\n                  </motion.div>\n                )}\n\n                {/* Connections Tab */}\n                {activeTab === 'connections' && (\n                  <motion.div\n                    key=\"connections\"\n                    initial={{ opacity: 0, x: -30 }}\n                    animate={{ opacity: 1, x: 0 }}\n                    exit={{ opacity: 0, x: 30 }}\n                    transition={{ duration: 0.4, ease: \"easeOut\" }}\n                    layout=\"position\"\n                    layoutId=\"tabContent\"\n                    className=\"p-6 overflow-y-auto max-h-[calc(85vh-200px)] scrollbar-thin scrollbar-thumb-slate-400 scrollbar-track-slate-200\"\n                  >\n                    <div className=\"bg-white rounded-xl p-6 shadow-lg border border-slate-200\">\n                      <h3 className=\"text-lg font-semibold text-slate-800 mb-6 flex items-center gap-2\">\n                        <Link2 size={20} className=\"text-indigo-600\" />\n                        Related Content\n                      </h3>\n                      \n                      <div className=\"text-center py-8 text-gray-500\">\n                        <Layers size={48} className=\"mx-auto mb-3 text-gray-300\" />\n                        <p>No connections found</p>\n                        <p className=\"text-sm mt-1\">Create connections by linking this topic to cases, tasks, or literature</p>\n                      </div>\n                    </div>\n                  </motion.div>\n                )}\n              </AnimatePresence>\n            </motion.div>\n\n            {isEditing && (\n              <div className=\"sticky bottom-0 bg-gray-50 border-t border-gray-200 px-6 py-4 flex items-center justify-between\">\n                <div className=\"text-sm text-gray-500\">\n                  Changes will be auto-saved\n                </div>\n                <div className=\"flex items-center gap-3\">\n                  <button\n                    onClick={() => {\n                      setIsEditing(false);\n                      setEditData({ ...data });\n                      setShowResourceForm(false);\n                    }}\n                    disabled={isLoading}\n                    className=\"px-4 py-2 text-gray-600 hover:text-gray-800 border border-gray-300 rounded-lg hover:bg-gray-100 transition-colors\"\n                  >\n                    Cancel\n                  </button>\n                  <button\n                    onClick={handleSave}\n                    disabled={isLoading}\n                    className=\"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors flex items-center gap-2\"\n                  >\n                    {isLoading ? <Loader2 size={16} className=\"animate-spin\" /> : <Save size={16} />}\n                    {isLoading ? 'Saving...' : 'Save Changes'}\n                  </button>\n                </div>\n              </div>\n            )}\n          </motion.div>\n        </motion.div>\n      )}\n    </AnimatePresence>\n  );\n};\n\nexport default React.memo(TopicModal, (prevProps, nextProps) => {\n  return (\n    prevProps.isOpen === nextProps.isOpen &&\n    prevProps.data?.id === nextProps.data?.id &&\n    prevProps.data?.updated_at === nextProps.data?.updated_at\n  );\n});\n","// Enhanced Task Modal with tabbed interface and advanced animations\nimport React, { useState, useEffect, useMemo, useCallback, useRef } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { \n  X, \n  CheckSquare, \n  Clock, \n  AlertTriangle, \n  Flag, \n  Calendar, \n  Link2, \n  Target,\n  Edit3,\n  Trash2,\n  Save,\n  Loader2,\n  Star,\n  Play,\n  Pause,\n  RotateCcw,\n  TrendingUp,\n  Users,\n  BookOpen,\n  FileText,\n  Tag\n} from 'lucide-react';\n\n// Animation variants for Framer Motion\nconst modalVariants = {\n  hidden: {\n    opacity: 0,\n    scale: 0.3,\n    y: 50,\n    rotate: -5,\n  },\n  visible: {\n    opacity: 1,\n    scale: 1,\n    y: 0,\n    rotate: 0,\n    transition: {\n      type: \"spring\",\n      damping: 25,\n      stiffness: 300,\n      duration: 0.6,\n    }\n  },\n  exit: {\n    opacity: 0,\n    scale: 0.7,\n    y: 30,\n    rotate: -3,\n    transition: {\n      type: \"easeInOut\",\n      duration: 0.4,\n    }\n  }\n};\n\nconst backdropVariants = {\n  hidden: { \n    opacity: 0,\n    backdropFilter: 'blur(0px)'\n  },\n  visible: { \n    opacity: 1,\n    backdropFilter: 'blur(8px)',\n    transition: {\n      duration: 0.4,\n      ease: \"easeOut\"\n    }\n  },\n  exit: { \n    opacity: 0,\n    backdropFilter: 'blur(0px)',\n    transition: {\n      duration: 0.3,\n      ease: \"easeIn\"\n    }\n  }\n};\n\nconst contentVariants = {\n  hidden: {\n    opacity: 0,\n    y: 20,\n    scale: 0.95,\n  },\n  visible: {\n    opacity: 1,\n    y: 0,\n    scale: 1,\n    transition: {\n      type: \"easeOut\",\n      duration: 0.3,\n      delay: 0.1,\n    }\n  },\n  exit: {\n    opacity: 0,\n    y: -10,\n    scale: 1.02,\n    transition: {\n      type: \"easeIn\",\n      duration: 0.2,\n    }\n  }\n};\n\nconst TaskModal = ({ \n  isOpen, \n  data, \n  onClose,\n  onAnimationStart,\n  onAnimationEnd,\n  setMindMapData,\n  autoSaveMindMapData,\n  addToast\n}) => {\n  const [isAnimating, setIsAnimating] = useState(false);\n  const [isVisible, setIsVisible] = useState(false);\n  const [isClosing, setIsClosing] = useState(false);\n  const [isEditing, setIsEditing] = useState(false);\n  const [editData, setEditData] = useState({});\n  const [isLoading, setIsLoading] = useState(false);\n  const [hasInitialized, setHasInitialized] = useState(false);\n  const [activeTab, setActiveTab] = useState('overview');\n  const [isTabTransitioning, setIsTabTransitioning] = useState(false);\n\n  useEffect(() => {\n    if (isOpen && data && !hasInitialized) {\n      setIsVisible(true);\n      setEditData({ \n        ...data,\n        status: data.status || 'pending',\n        priority: data.priority || 'medium'\n      });\n      setHasInitialized(true);\n      setIsAnimating(true);\n      if (onAnimationStart) onAnimationStart();\n      \n      setTimeout(() => {\n        setIsAnimating(false);\n        if (onAnimationEnd) onAnimationEnd();\n      }, 600);\n    } else if (!isOpen && hasInitialized) {\n      setHasInitialized(false);\n    }\n  }, [isOpen, hasInitialized, onAnimationStart, onAnimationEnd]);\n\n  // Separate effect for data updates when modal is already open\n  useEffect(() => {\n    if (isOpen && data && hasInitialized && !isEditing && !isLoading && !isTabTransitioning && !isAnimating) {\n      setEditData({ \n        ...data,\n        status: data.status || 'pending',\n        priority: data.priority || 'medium'\n      });\n    }\n  }, [data?.id, isOpen, hasInitialized, isEditing, isLoading, isTabTransitioning, isAnimating]);\n\n  const priorityConfig = useMemo(() => ({\n    low: { color: 'green', label: 'Low Priority', icon: Flag },\n    medium: { color: 'yellow', label: 'Medium Priority', icon: Flag },\n    high: { color: 'red', label: 'High Priority', icon: Flag },\n    urgent: { color: 'purple', label: 'Urgent', icon: AlertTriangle }\n  }), []);\n\n  const statusConfig = useMemo(() => ({\n    pending: { color: 'gray', label: 'Pending', icon: Clock },\n    in_progress: { color: 'blue', label: 'In Progress', icon: Play },\n    completed: { color: 'green', label: 'Completed', icon: CheckSquare },\n    paused: { color: 'orange', label: 'Paused', icon: Pause }\n  }), []);\n\n  const isOverdue = useMemo(() => {\n    if (!editData.due_date) return false;\n    const dueDate = new Date(editData.due_date);\n    const today = new Date();\n    return dueDate < today && editData.status !== 'completed';\n  }, [editData.due_date, editData.status]);\n\n  const handleClose = useCallback(() => {\n    if (isAnimating || isClosing) return;\n    \n    setIsAnimating(true);\n    setIsClosing(true);\n    if (onAnimationStart) onAnimationStart();\n    \n    // Set visibility to false to trigger exit animation\n    setIsVisible(false);\n  }, [onAnimationStart, isAnimating, isClosing]);\n\n  const handleSave = useCallback(async () => {\n    if (isLoading) return;\n    \n    setIsLoading(true);\n    try {\n      setMindMapData(prevData => {\n        const updatedTasks = prevData.tasks.map(task =>\n          String(task.id) === String(data?.id) ? { ...task, ...editData } : task\n        );\n        const newData = { ...prevData, tasks: updatedTasks };\n        autoSaveMindMapData(newData);\n        return newData;\n      });\n      \n      setIsEditing(false);\n      addToast('Task updated successfully', 'success');\n    } catch (error) {\n      console.error('Error saving task:', error);\n      addToast('Failed to save task', 'error');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [data?.id, editData, setMindMapData, autoSaveMindMapData, addToast, isLoading]);\n\n  const handleDelete = useCallback(async () => {\n    if (isLoading) return;\n    \n    if (!window.confirm('Are you sure you want to delete this task?')) return;\n    \n    setIsLoading(true);\n    try {\n      setMindMapData(prevData => {\n        const updatedTasks = prevData.tasks.filter(task => String(task.id) !== String(data?.id));\n        const newData = { ...prevData, tasks: updatedTasks };\n        autoSaveMindMapData(newData);\n        return newData;\n      });\n      \n      addToast('Task deleted successfully', 'success');\n      handleClose();\n    } catch (error) {\n      console.error('Error deleting task:', error);\n      addToast('Failed to delete task', 'error');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [data?.id, setMindMapData, autoSaveMindMapData, addToast, handleClose, isLoading]);\n\n  const handleStatusChange = useCallback((newStatus) => {\n    setEditData(prev => ({ ...prev, status: newStatus }));\n  }, []);\n\n  const updateField = useCallback((field, value) => {\n    setEditData(prev => ({ ...prev, [field]: value }));\n  }, []);\n\n  const renderField = (label, field, type = 'text', options = {}) => {\n    const value = editData[field] || '';\n    \n    if (!isEditing) {\n      if (type === 'textarea') {\n        return (\n          <div className=\"space-y-2\">\n            <label className=\"block text-sm font-medium text-gray-700\">{label}</label>\n            <div className=\"p-3 bg-gray-50 rounded-lg border min-h-[2.5rem] text-gray-800\">\n              {value || <span className=\"text-gray-400 italic\">Not specified</span>}\n            </div>\n          </div>\n        );\n      }\n      \n      if (type === 'select') {\n        return (\n          <div className=\"space-y-2\">\n            <label className=\"block text-sm font-medium text-gray-700\">{label}</label>\n            <div className=\"p-3 bg-gray-50 rounded-lg border text-gray-800\">\n              {value || <span className=\"text-gray-400 italic\">Not specified</span>}\n            </div>\n          </div>\n        );\n      }\n      \n      if (type === 'date') {\n        return (\n          <div className=\"space-y-2\">\n            <label className=\"block text-sm font-medium text-gray-700\">{label}</label>\n            <div className=\"p-3 bg-gray-50 rounded-lg border text-gray-800\">\n              {value ? new Date(value).toLocaleDateString() : <span className=\"text-gray-400 italic\">Not set</span>}\n            </div>\n          </div>\n        );\n      }\n      \n      return (\n        <div className=\"space-y-2\">\n          <label className=\"block text-sm font-medium text-gray-700\">{label}</label>\n          <div className=\"p-3 bg-gray-50 rounded-lg border text-gray-800\">\n            {value || <span className=\"text-gray-400 italic\">Not specified</span>}\n          </div>\n        </div>\n      );\n    }\n\n    // Editing mode\n    if (type === 'textarea') {\n      return (\n        <div className=\"space-y-2\">\n          <label className=\"block text-sm font-medium text-gray-700\">{label}</label>\n          <textarea\n            value={value}\n            onChange={(e) => updateField(field, e.target.value)}\n            className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors\"\n            rows={options.rows || 3}\n            placeholder={`Enter ${label.toLowerCase()}...`}\n          />\n        </div>\n      );\n    }\n\n    if (type === 'select' && options.choices) {\n      return (\n        <div className=\"space-y-2\">\n          <label className=\"block text-sm font-medium text-gray-700\">{label}</label>\n          <select\n            value={value}\n            onChange={(e) => updateField(field, e.target.value)}\n            className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors\"\n          >\n            <option value=\"\">Select {label.toLowerCase()}...</option>\n            {options.choices.map(choice => (\n              <option key={choice.value} value={choice.value}>{choice.label}</option>\n            ))}\n          </select>\n        </div>\n      );\n    }\n\n    if (type === 'date') {\n      return (\n        <div className=\"space-y-2\">\n          <label className=\"block text-sm font-medium text-gray-700\">{label}</label>\n          <input\n            type=\"date\"\n            value={value}\n            onChange={(e) => updateField(field, e.target.value)}\n            className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors\"\n          />\n        </div>\n      );\n    }\n\n    return (\n      <div className=\"space-y-2\">\n        <label className=\"block text-sm font-medium text-gray-700\">{label}</label>\n        <input\n          type={type}\n          value={value}\n          onChange={(e) => updateField(field, type === 'number' ? Number(e.target.value) : e.target.value)}\n          className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors\"\n          placeholder={`Enter ${label.toLowerCase()}...`}\n        />\n      </div>\n    );\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <AnimatePresence mode=\"wait\" onExitComplete={() => {\n      setIsAnimating(false);\n      setIsClosing(false);\n      setHasInitialized(false);\n      onClose();\n      if (onAnimationEnd) onAnimationEnd();\n    }}>\n      {isVisible && (\n        <motion.div\n          key={`task-modal-${data?.id || 'default'}`}\n          initial=\"hidden\"\n          animate=\"visible\"\n          exit=\"exit\"\n          variants={backdropVariants}\n          className=\"fixed inset-0 bg-black flex items-center justify-center z-50\"\n          style={{ \n            willChange: 'backdrop-filter, opacity',\n            backfaceVisibility: 'hidden',\n            transform: 'translate3d(0, 0, 0)'\n          }}\n          onClick={(e) => e.target === e.currentTarget && handleClose()}\n        >\n          <motion.div\n            initial=\"hidden\"\n            animate=\"visible\"\n            exit=\"exit\"\n            variants={modalVariants}\n            className=\"bg-white rounded-2xl shadow-2xl max-w-4xl w-full mx-4 max-h-[85vh] overflow-hidden\"\n            style={{ \n              willChange: 'transform, opacity, scale',\n              backfaceVisibility: 'hidden'\n            }}\n            onClick={(e) => e.stopPropagation()}\n            onAnimationStart={() => {\n              setIsAnimating(true);\n              if (onAnimationStart) onAnimationStart();\n            }}\n            onAnimationComplete={() => {\n              setIsAnimating(false);\n              if (onAnimationEnd) onAnimationEnd();\n            }}\n          >\n            <motion.div \n              initial=\"hidden\"\n              animate=\"visible\"\n              exit=\"exit\"\n              variants={contentVariants}\n              className=\"bg-gradient-to-br from-slate-900 to-slate-800 text-white px-6 py-4 flex items-center justify-between\"\n            >\n              <div className=\"flex items-center gap-3\">\n                <CheckSquare size={24} />\n                <h2 className=\"text-xl font-semibold\">Task Details</h2>\n                {isOverdue && (\n                  <motion.div\n                    animate={{ scale: [1, 1.1, 1] }}\n                    transition={{ duration: 1, repeat: Infinity }}\n                    className=\"flex items-center gap-1 px-2 py-1 bg-red-500 rounded-full text-xs font-medium\"\n                  >\n                    <AlertTriangle size={12} />\n                    Overdue\n                  </motion.div>\n                )}\n              </div>\n              <div className=\"flex items-center gap-2\">\n                {!isEditing && !isLoading && (\n                  <>\n                    <button\n                      onClick={() => setIsEditing(true)}\n                      className=\"text-white hover:text-gray-200 p-2 rounded-full hover:bg-white hover:bg-opacity-20 transition-all\"\n                      title=\"Edit\"\n                    >\n                      <Edit3 size={20} />\n                    </button>\n                    <button\n                      onClick={handleDelete}\n                      className=\"text-white hover:text-red-200 p-2 rounded-full hover:bg-red-500 hover:bg-opacity-30 transition-all\"\n                      title=\"Delete\"\n                    >\n                      <Trash2 size={20} />\n                    </button>\n                  </>\n                )}\n                <button onClick={handleClose} className=\"text-white hover:text-gray-200 p-2 rounded-full hover:bg-white hover:bg-opacity-20 transition-all\">\n                  <X size={20} />\n                </button>\n              </div>\n            </motion.div>\n\n            {/* Tab Navigation */}\n            <div className=\"bg-gradient-to-r from-slate-900 via-slate-800 to-slate-900 border-b border-slate-600\">\n              <nav className=\"flex flex-wrap gap-2 px-6 py-4\">\n                {[\n                  { key: 'overview', label: 'Overview', icon: CheckSquare },\n                  { key: 'progress', label: 'Progress', icon: TrendingUp },\n                  { key: 'connections', label: 'Connections', icon: Link2 },\n                  { key: 'details', label: 'Details', icon: FileText }\n                ].map(({ key, label, icon: Icon }) => (\n                  <motion.button\n                    key={key}\n                    onClick={() => {\n                      if (isTabTransitioning) return;\n                      setIsTabTransitioning(true);\n                      setActiveTab(key);\n                      setTimeout(() => setIsTabTransitioning(false), 300);\n                    }}\n                    className={`relative flex items-center gap-2 px-4 py-3 rounded-xl font-medium text-sm transition-all duration-300 ${\n                      activeTab === key\n                        ? 'bg-gradient-to-r from-emerald-500 to-teal-600 text-white shadow-lg shadow-emerald-500/25'\n                        : 'text-slate-300 hover:text-white hover:bg-slate-700/50 hover:shadow-md'\n                    }`}\n                    whileHover={{ scale: activeTab === key ? 1 : 1.02 }}\n                    whileTap={{ scale: 0.98 }}\n                    initial={false}\n                    animate={{\n                      scale: activeTab === key ? 1.05 : 1,\n                      boxShadow: activeTab === key \n                        ? '0 8px 25px rgba(16, 185, 129, 0.3), 0 0 20px rgba(20, 184, 166, 0.2)' \n                        : '0 2px 8px rgba(0, 0, 0, 0.1)'\n                    }}\n                    transition={{ duration: 0.3, ease: \"easeOut\" }}\n                  >\n                    <Icon size={16} className={activeTab === key ? 'drop-shadow-sm' : ''} />\n                    {label}\n                    \n                    {activeTab === key && (\n                      <motion.div\n                        layoutId=\"taskTabGlow\"\n                        className=\"absolute inset-0 bg-gradient-to-r from-emerald-400/20 to-teal-500/20 rounded-xl blur-sm\"\n                        initial={false}\n                        transition={{ type: \"spring\", bounce: 0.2, duration: 0.6 }}\n                      />\n                    )}\n                  </motion.button>\n                ))}\n              </nav>\n            </div>\n            \n            {/* Tab Content */}\n            <motion.div \n              className=\"relative overflow-hidden bg-gradient-to-br from-slate-50 to-slate-100\"\n              layout=\"position\"\n              layoutRoot\n              transition={{ \n                layout: { duration: 0.4, ease: \"easeInOut\" },\n                height: { duration: 0.4, ease: \"easeInOut\" }\n              }}\n            >\n              <AnimatePresence mode=\"wait\" initial={false} onExitComplete={() => setIsTabTransitioning(false)}>\n                {/* Overview Tab */}\n                {activeTab === 'overview' && (\n                  <motion.div\n                    key=\"overview\"\n                    initial={{ opacity: 0, x: -30 }}\n                    animate={{ opacity: 1, x: 0 }}\n                    exit={{ opacity: 0, x: 30 }}\n                    transition={{ duration: 0.4, ease: \"easeOut\" }}\n                    layout=\"position\"\n                    layoutId=\"tabContent\"\n                    className=\"p-6 overflow-y-auto max-h-[calc(85vh-200px)] scrollbar-thin scrollbar-thumb-slate-400 scrollbar-track-slate-200\"\n                  >\n                    <div className=\"space-y-6\">\n                      <div className=\"bg-white rounded-xl p-6 shadow-lg border border-slate-200\">\n                        <h3 className=\"text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2\">\n                          <Target size={20} className=\"text-emerald-600\" />\n                          Task Information\n                        </h3>\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                          {renderField('Title', 'title')}\n                          {renderField('Priority', 'priority', 'select', {\n                            choices: [\n                              { value: 'low', label: 'Low Priority' },\n                              { value: 'medium', label: 'Medium Priority' },\n                              { value: 'high', label: 'High Priority' },\n                              { value: 'urgent', label: 'Urgent' }\n                            ]\n                          })}\n                        </div>\n                        <div className=\"mt-6\">\n                          {renderField('Description', 'description', 'textarea', { rows: 4 })}\n                        </div>\n                      </div>\n                      \n                      <div className=\"bg-white rounded-xl p-6 shadow-lg border border-slate-200\">\n                        <h3 className=\"text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2\">\n                          <Clock size={20} className=\"text-blue-600\" />\n                          Status & Timeline\n                        </h3>\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                          {renderField('Status', 'status', 'select', {\n                            choices: [\n                              { value: 'pending', label: 'Pending' },\n                              { value: 'in_progress', label: 'In Progress' },\n                              { value: 'completed', label: 'Completed' },\n                              { value: 'paused', label: 'Paused' }\n                            ]\n                          })}\n                          {renderField('Due Date', 'due_date', 'date')}\n                        </div>\n                        \n                        {/* Status Change Buttons */}\n                        <div className=\"mt-6\">\n                          <label className=\"block text-sm font-medium text-gray-700 mb-3\">Quick Status Update</label>\n                          <div className=\"flex flex-wrap gap-3\">\n                            {Object.entries(statusConfig).map(([status, config]) => {\n                              const Icon = config.icon;\n                              const isActive = editData.status === status;\n                              return (\n                                <motion.button\n                                  key={status}\n                                  onClick={() => handleStatusChange(status)}\n                                  disabled={!isEditing}\n                                  whileHover={isEditing ? { scale: 1.05 } : {}}\n                                  whileTap={isEditing ? { scale: 0.95 } : {}}\n                                  className={`flex items-center gap-2 px-4 py-2 rounded-lg font-medium text-sm transition-all ${\n                                    isActive\n                                      ? `bg-${config.color}-100 text-${config.color}-800 border-2 border-${config.color}-300`\n                                      : `bg-gray-100 text-gray-600 border-2 border-gray-200 ${isEditing ? 'hover:bg-gray-200' : 'cursor-not-allowed opacity-50'}`\n                                  }`}\n                                >\n                                  <Icon size={16} />\n                                  {config.label}\n                                </motion.button>\n                              );\n                            })}\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  </motion.div>\n                )}\n\n                {/* Progress Tab */}\n                {activeTab === 'progress' && (\n                  <motion.div\n                    key=\"progress\"\n                    initial={{ opacity: 0, x: -30 }}\n                    animate={{ opacity: 1, x: 0 }}\n                    exit={{ opacity: 0, x: 30 }}\n                    transition={{ duration: 0.4, ease: \"easeOut\" }}\n                    layout=\"position\"\n                    layoutId=\"tabContent\"\n                    className=\"p-6 overflow-y-auto max-h-[calc(85vh-200px)] scrollbar-thin scrollbar-thumb-slate-400 scrollbar-track-slate-200\"\n                  >\n                    <div className=\"bg-white rounded-xl p-6 shadow-lg border border-slate-200\">\n                      <h3 className=\"text-lg font-semibold text-slate-800 mb-6 flex items-center gap-2\">\n                        <TrendingUp size={20} className=\"text-blue-600\" />\n                        Task Progress\n                      </h3>\n                      \n                      {/* Status Overview */}\n                      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8\">\n                        <motion.div\n                          whileHover={{ scale: 1.02 }}\n                          className={`p-4 rounded-lg border-2 ${\n                            editData.status === 'completed' \n                              ? 'bg-green-50 border-green-200' \n                              : 'bg-gray-50 border-gray-200'\n                          }`}\n                        >\n                          <div className=\"flex items-center gap-3 mb-2\">\n                            <CheckSquare size={20} className={editData.status === 'completed' ? 'text-green-600' : 'text-gray-400'} />\n                            <span className={`font-medium ${editData.status === 'completed' ? 'text-green-800' : 'text-gray-600'}`}>\n                              Completion\n                            </span>\n                          </div>\n                          <div className={`text-2xl font-bold ${editData.status === 'completed' ? 'text-green-700' : 'text-gray-700'}`}>\n                            {editData.status === 'completed' ? '100%' : '0%'}\n                          </div>\n                        </motion.div>\n                        \n                        <motion.div\n                          whileHover={{ scale: 1.02 }}\n                          className={`p-4 rounded-lg border-2 ${\n                            isOverdue \n                              ? 'bg-red-50 border-red-200' \n                              : 'bg-blue-50 border-blue-200'\n                          }`}\n                        >\n                          <div className=\"flex items-center gap-3 mb-2\">\n                            <Calendar size={20} className={isOverdue ? 'text-red-600' : 'text-blue-600'} />\n                            <span className={`font-medium ${isOverdue ? 'text-red-800' : 'text-blue-800'}`}>\n                              Due Date\n                            </span>\n                          </div>\n                          <div className={`text-lg font-bold ${isOverdue ? 'text-red-700' : 'text-blue-700'}`}>\n                            {editData.due_date ? new Date(editData.due_date).toLocaleDateString() : 'Not set'}\n                          </div>\n                          {isOverdue && (\n                            <div className=\"text-sm text-red-600 mt-1\">Overdue</div>\n                          )}\n                        </motion.div>\n                        \n                        <motion.div\n                          whileHover={{ scale: 1.02 }}\n                          className={`p-4 rounded-lg border-2 ${\n                            editData.priority === 'urgent' || editData.priority === 'high'\n                              ? 'bg-orange-50 border-orange-200'\n                              : 'bg-gray-50 border-gray-200'\n                          }`}\n                        >\n                          <div className=\"flex items-center gap-3 mb-2\">\n                            <Flag size={20} className={\n                              editData.priority === 'urgent' || editData.priority === 'high' \n                                ? 'text-orange-600' \n                                : 'text-gray-600'\n                            } />\n                            <span className={`font-medium ${\n                              editData.priority === 'urgent' || editData.priority === 'high' \n                                ? 'text-orange-800' \n                                : 'text-gray-800'\n                            }`}>\n                              Priority\n                            </span>\n                          </div>\n                          <div className={`text-lg font-bold ${\n                            editData.priority === 'urgent' || editData.priority === 'high' \n                              ? 'text-orange-700' \n                              : 'text-gray-700'\n                          }`}>\n                            {priorityConfig[editData.priority]?.label || 'Not set'}\n                          </div>\n                        </motion.div>\n                      </div>\n                    </div>\n                  </motion.div>\n                )}\n\n                {/* Connections Tab */}\n                {activeTab === 'connections' && (\n                  <motion.div\n                    key=\"connections\"\n                    initial={{ opacity: 0, x: -30 }}\n                    animate={{ opacity: 1, x: 0 }}\n                    exit={{ opacity: 0, x: 30 }}\n                    transition={{ duration: 0.4, ease: \"easeOut\" }}\n                    layout=\"position\"\n                    layoutId=\"tabContent\"\n                    className=\"p-6 overflow-y-auto max-h-[calc(85vh-200px)] scrollbar-thin scrollbar-thumb-slate-400 scrollbar-track-slate-200\"\n                  >\n                    <div className=\"bg-white rounded-xl p-6 shadow-lg border border-slate-200\">\n                      <h3 className=\"text-lg font-semibold text-slate-800 mb-6 flex items-center gap-2\">\n                        <Link2 size={20} className=\"text-indigo-600\" />\n                        Related Content\n                      </h3>\n                      \n                      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                        {renderField('Linked Case ID', 'linked_case_id')}\n                        {renderField('Linked Topic ID', 'linked_topic_id')}\n                      </div>\n                      \n                      <div className=\"mt-8 text-center py-8 text-gray-500\">\n                        <Link2 size={48} className=\"mx-auto mb-3 text-gray-300\" />\n                        <p>No connections found</p>\n                        <p className=\"text-sm mt-1\">Link this task to cases or topics to create connections</p>\n                      </div>\n                    </div>\n                  </motion.div>\n                )}\n\n                {/* Details Tab */}\n                {activeTab === 'details' && (\n                  <motion.div\n                    key=\"details\"\n                    initial={{ opacity: 0, x: -30 }}\n                    animate={{ opacity: 1, x: 0 }}\n                    exit={{ opacity: 0, x: 30 }}\n                    transition={{ duration: 0.4, ease: \"easeOut\" }}\n                    layout=\"position\"\n                    layoutId=\"tabContent\"\n                    className=\"p-6 overflow-y-auto max-h-[calc(85vh-200px)] scrollbar-thin scrollbar-thumb-slate-400 scrollbar-track-slate-200\"\n                  >\n                    <div className=\"bg-white rounded-xl p-6 shadow-lg border border-slate-200\">\n                      <h3 className=\"text-lg font-semibold text-slate-800 mb-6 flex items-center gap-2\">\n                        <FileText size={20} className=\"text-gray-600\" />\n                        Additional Details\n                      </h3>\n                      \n                      <div className=\"space-y-6\">\n                        <div className=\"text-sm text-gray-600 bg-slate-50 p-4 rounded-lg\">\n                          <p className=\"font-medium mb-2\">Task Details</p>\n                          <div className=\"space-y-2\">\n                            <p><span className=\"font-medium\">Created:</span> {data?.created_at ? new Date(data.created_at).toLocaleString() : 'Unknown'}</p>\n                            <p><span className=\"font-medium\">Last Updated:</span> {data?.updated_at ? new Date(data.updated_at).toLocaleString() : 'Unknown'}</p>\n                            <p><span className=\"font-medium\">Task ID:</span> {data?.id || 'Unknown'}</p>\n                          </div>\n                        </div>\n                        \n                        <div className=\"p-4 bg-blue-50 rounded-lg border border-blue-200\">\n                          <h4 className=\"font-medium text-blue-800 mb-2\">Task Management Tips</h4>\n                          <ul className=\"text-blue-700 text-sm space-y-1\">\n                            <li>• Break large tasks into smaller, manageable subtasks</li>\n                            <li>• Set realistic due dates to maintain accountability</li>\n                            <li>• Link tasks to relevant cases or topics for better organization</li>\n                            <li>• Update status regularly to track progress</li>\n                          </ul>\n                        </div>\n                      </div>\n                    </div>\n                  </motion.div>\n                )}\n              </AnimatePresence>\n            </motion.div>\n\n            {isEditing && (\n              <div className=\"sticky bottom-0 bg-gray-50 border-t border-gray-200 px-6 py-4 flex items-center justify-between\">\n                <div className=\"text-sm text-gray-500\">\n                  Changes will be auto-saved\n                </div>\n                <div className=\"flex items-center gap-3\">\n                  <button\n                    onClick={() => {\n                      setIsEditing(false);\n                      setEditData({ ...data });\n                    }}\n                    disabled={isLoading}\n                    className=\"px-4 py-2 text-gray-600 hover:text-gray-800 border border-gray-300 rounded-lg hover:bg-gray-100 transition-colors\"\n                  >\n                    Cancel\n                  </button>\n                  <button\n                    onClick={handleSave}\n                    disabled={isLoading}\n                    className=\"px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors flex items-center gap-2\"\n                  >\n                    {isLoading ? <Loader2 size={16} className=\"animate-spin\" /> : <Save size={16} />}\n                    {isLoading ? 'Saving...' : 'Save Changes'}\n                  </button>\n                </div>\n              </div>\n            )}\n          </motion.div>\n        </motion.div>\n      )}\n    </AnimatePresence>\n  );\n};\n\nexport default React.memo(TaskModal, (prevProps, nextProps) => {\n  return (\n    prevProps.isOpen === nextProps.isOpen &&\n    prevProps.data?.id === nextProps.data?.id &&\n    prevProps.data?.updated_at === nextProps.data?.updated_at\n  );\n});\n","// Floating Edge Utilities for React Flow\n// Calculates intersection points between nodes for custom floating edges\n\n/**\n * Calculate the intersection point of a line with a rectangle\n * @param {Object} rect - Rectangle with x, y, width, height\n * @param {Object} center - Center point with x, y\n * @param {Object} point - External point with x, y\n * @returns {Object} Intersection point with x, y coordinates\n */\nfunction getIntersectionPoint(rect, center, point) {\n  const { x: rectX, y: rectY, width, height } = rect;\n  const { x: centerX, y: centerY } = center;\n  const { x: pointX, y: pointY } = point;\n\n  // Calculate rectangle bounds - no buffer as we want exact edges\n  const left = rectX;\n  const right = rectX + width;\n  const top = rectY;\n  const bottom = rectY + height;\n\n  // Direction vector from center to point\n  const dx = pointX - centerX;\n  const dy = pointY - centerY;\n\n  // Handle edge cases where the line is vertical or horizontal\n  if (Math.abs(dx) < 0.001) {\n    // Vertical line\n    return {\n      x: centerX,\n      y: dy > 0 ? bottom : top,\n      side: dy > 0 ? 'bottom' : 'top'\n    };\n  }\n\n  if (Math.abs(dy) < 0.001) {\n    // Horizontal line\n    return {\n      x: dx > 0 ? right : left,\n      y: centerY,\n      side: dx > 0 ? 'right' : 'left'\n    };\n  }\n\n  // Calculate slope and y-intercept\n  const slope = dy / dx;\n  const yIntercept = centerY - slope * centerX;\n\n  // Calculate intersection points with all four sides\n  const intersections = [];\n\n  // Left side (x = left)\n  const leftY = slope * left + yIntercept;\n  if (leftY >= top && leftY <= bottom) {\n    intersections.push({ x: left, y: leftY, side: 'left', distance: Math.hypot(left - centerX, leftY - centerY) });\n  }\n\n  // Right side (x = right)\n  const rightY = slope * right + yIntercept;\n  if (rightY >= top && rightY <= bottom) {\n    intersections.push({ x: right, y: rightY, side: 'right', distance: Math.hypot(right - centerX, rightY - centerY) });\n  }\n\n  // Top side (y = top)\n  const topX = (top - yIntercept) / slope;\n  if (topX >= left && topX <= right) {\n    intersections.push({ x: topX, y: top, side: 'top', distance: Math.hypot(topX - centerX, top - centerY) });\n  }\n\n  // Bottom side (y = bottom)\n  const bottomX = (bottom - yIntercept) / slope;\n  if (bottomX >= left && bottomX <= right) {\n    intersections.push({ x: bottomX, y: bottom, side: 'bottom', distance: Math.hypot(bottomX - centerX, bottom - centerY) });\n  }\n\n  // Find the intersection point that's in the correct direction\n  // and is closest to the center (to avoid picking the wrong side)\n  const validIntersections = intersections.filter(intersection => {\n    const intersectionDx = intersection.x - centerX;\n    const intersectionDy = intersection.y - centerY;\n    \n    // Check if the intersection is in the same direction as the target point\n    return (\n      (dx > 0 && intersectionDx >= 0) || (dx < 0 && intersectionDx <= 0)\n    ) && (\n      (dy > 0 && intersectionDy >= 0) || (dy < 0 && intersectionDy <= 0)\n    );\n  });\n\n  // Sort by distance and take the closest valid intersection\n  validIntersections.sort((a, b) => a.distance - b.distance);\n  return validIntersections[0] || { x: centerX, y: centerY, side: 'center' };\n}\n\n/**\n * Calculate the floating edge path between two nodes\n * @param {Object} sourceNode - Source node with position and measured dimensions\n * @param {Object} targetNode - Target node with position and measured dimensions\n * @param {Object} options - Optional configuration\n * @returns {Object} Edge path data with sourceX, sourceY, targetX, targetY\n */\nexport function getFloatingEdgePath(sourceNode, targetNode, options = {}) {\n  const {\n    sourcePosition = { x: 0, y: 0 },\n    targetPosition = { x: 0, y: 0 },\n    sourceWidth = 200,\n    sourceHeight = 100,\n    targetWidth = 200,\n    targetHeight = 100,\n    // Direct coordinates from React Flow (fallback)\n    sourceX,\n    sourceY,\n    targetX,\n    targetY,\n    offset = 0 // Default to zero offset to ensure edges connect to borders\n  } = options;\n  \n  // Use direct coordinates if provided and dimensions appear invalid\n  if (sourceX !== undefined && sourceY !== undefined && \n      targetX !== undefined && targetY !== undefined &&\n      (sourceWidth <= 10 || targetWidth <= 10)) {\n    return {\n      sourceX, \n      sourceY, \n      targetX, \n      targetY,\n      sourceSide: 'direct',\n      targetSide: 'direct'\n    };\n  }\n\n  // Calculate node centers\n  const sourceCenter = {\n    x: sourcePosition.x + sourceWidth / 2,\n    y: sourcePosition.y + sourceHeight / 2\n  };\n\n  const targetCenter = {\n    x: targetPosition.x + targetWidth / 2,\n    y: targetPosition.y + targetHeight / 2\n  };\n\n  // Create rectangle objects for intersection calculation\n  const sourceRect = {\n    x: sourcePosition.x,\n    y: sourcePosition.y,\n    width: sourceWidth,\n    height: sourceHeight\n  };\n\n  const targetRect = {\n    x: targetPosition.x,\n    y: targetPosition.y,\n    width: targetWidth,\n    height: targetHeight\n  };\n\n  // Calculate intersection points\n  const sourceIntersection = getIntersectionPoint(sourceRect, sourceCenter, targetCenter);\n  const targetIntersection = getIntersectionPoint(targetRect, targetCenter, sourceCenter);\n\n  // Calculate vector from source to target center\n  const dx = targetCenter.x - sourceCenter.x;\n  const dy = targetCenter.y - sourceCenter.y;\n  const distance = Math.sqrt(dx * dx + dy * dy);\n\n  // Add a stronger extension to ensure visual connection with the node borders\n  // This is done by extending the line in both directions\n  if (distance > 0) {\n    const unitX = dx / distance;\n    const unitY = dy / distance;\n    \n    // Extend lines by 3 pixels to ensure visual connection\n    // Using a larger value for more reliability across different node types\n    const extensionAmount = 3;\n\n    // Extend the line outward from the source node\n    sourceIntersection.x -= unitX * extensionAmount;\n    sourceIntersection.y -= unitY * extensionAmount;\n    \n    // Extend the line outward from the target node\n    targetIntersection.x += unitX * extensionAmount;\n    targetIntersection.y += unitY * extensionAmount;\n    \n    // Apply additional offset if needed\n    if (offset > 0) {\n      sourceIntersection.x += unitX * offset;\n      sourceIntersection.y += unitY * offset;\n      targetIntersection.x -= unitX * offset;\n      targetIntersection.y -= unitY * offset;\n    }\n  }\n\n  // Debug flag to help diagnose intersection issues\n  const debug = options.debug || false;\n  if (debug) {\n    console.log('Source Node:', sourceNode);\n    console.log('Target Node:', targetNode);\n    console.log('Source Intersection:', sourceIntersection);\n    console.log('Target Intersection:', targetIntersection);\n  }\n\n  return {\n    sourceX: sourceIntersection.x,\n    sourceY: sourceIntersection.y,\n    targetX: targetIntersection.x,\n    targetY: targetIntersection.y,\n    sourceSide: sourceIntersection.side,\n    targetSide: targetIntersection.side\n  };\n}\n\n/**\n * Generate SVG path string for a bezier curve between two points\n * @param {number} sourceX - Source X coordinate\n * @param {number} sourceY - Source Y coordinate\n * @param {number} targetX - Target X coordinate\n * @param {number} targetY - Target Y coordinate\n * @param {number} curvature - Curve intensity (0-1)\n * @returns {string} SVG path string\n */\nexport function getBezierPath(sourceX, sourceY, targetX, targetY, curvature = 0.25) {\n  const dx = targetX - sourceX;\n  const dy = targetY - sourceY;\n  \n  // Calculate control points for a smooth bezier curve\n  const controlOffset = Math.sqrt(dx * dx + dy * dy) * curvature;\n  \n  const controlX1 = sourceX + dx * 0.5 + dy * controlOffset * 0.5;\n  const controlY1 = sourceY + dy * 0.5 - dx * controlOffset * 0.5;\n  \n  const controlX2 = sourceX + dx * 0.5 - dy * controlOffset * 0.5;\n  const controlY2 = sourceY + dy * 0.5 + dx * controlOffset * 0.5;\n  \n  return `M ${sourceX},${sourceY} C ${controlX1},${controlY1} ${controlX2},${controlY2} ${targetX},${targetY}`;\n}\n\n/**\n * Calculate the center point of an edge path\n * @param {number} sourceX - Source X coordinate\n * @param {number} sourceY - Source Y coordinate\n * @param {number} targetX - Target X coordinate\n * @param {number} targetY - Target Y coordinate\n * @returns {Object} Center point with x, y coordinates\n */\nexport function getEdgeCenter(sourceX, sourceY, targetX, targetY) {\n  return {\n    x: (sourceX + targetX) / 2,\n    y: (sourceY + targetY) / 2\n  };\n}\n\n/**\n * Calculate marker end position for arrow heads\n * @param {number} sourceX - Source X coordinate\n * @param {number} sourceY - Source Y coordinate\n * @param {number} targetX - Target X coordinate\n * @param {number} targetY - Target Y coordinate\n * @returns {string} Transform string for marker positioning\n */\nexport function getMarkerEnd(sourceX, sourceY, targetX, targetY) {\n  const dx = targetX - sourceX;\n  const dy = targetY - sourceY;\n  const angle = Math.atan2(dy, dx) * (180 / Math.PI);\n  \n  return `url(#arrowhead) rotate(${angle} ${targetX} ${targetY})`;\n}\n","import React, { memo, useMemo, useEffect } from 'react';\nimport { BaseEdge, useReactFlow } from '@xyflow/react';\nimport { getFloatingEdgePath } from '../utils/floatingEdgeUtils';\n\n/**\n * High-Performance Floating Edge Component\n * \n * This is an optimized edge component that calculates intersection points\n * between nodes and renders a direct straight line between them. It's \n * specifically designed for immediate visual feedback during node dragging.\n * \n * Features:\n * - Direct path calculation using geometry\n * - Memoized path computation for performance\n * - No transition delays or animations\n * - Minimal re-rendering\n */\nconst FloatingEdge = memo(({\n  id,\n  source,\n  target,\n  sourceX,\n  sourceY,\n  targetX,\n  targetY,\n  sourcePosition,\n  targetPosition,\n  style = {},\n  markerEnd,\n  markerStart,\n  data,\n  ...props\n}) => {\n  const { getNode } = useReactFlow();\n  \n  // Safely get nodes outside of useMemo to avoid scope issues\n  let sourceNode, targetNode;\n  try {\n    sourceNode = getNode(source);\n    targetNode = getNode(target);\n  } catch (error) {\n    // Nodes not available, will use fallback\n    sourceNode = null;\n    targetNode = null;\n  }\n  \n  // Memoize the edge path calculation for better performance\n  const { edgePath, labelX, labelY } = useMemo(() => {\n    // During animations or rapid updates, use simple direct paths\n    if (data?.__isAnimating || data?.__forceUpdate) {\n      return {\n        edgePath: `M${sourceX},${sourceY} L${targetX},${targetY}`,\n        labelX: (sourceX + targetX) / 2,\n        labelY: (sourceY + targetY) / 2\n      };\n    }\n\n    // Default fallback if nodes aren't available\n    if (!sourceNode || !targetNode) {\n      return {\n        edgePath: `M${sourceX},${sourceY} L${targetX},${targetY}`,\n        labelX: (sourceX + targetX) / 2,\n        labelY: (sourceY + targetY) / 2\n      };\n    }\n\n    try {\n      // Safely check if we have enough information to calculate an accurate path\n      const sourceHasDimensions = Boolean(\n        sourceNode.width || \n        sourceNode.dimensions?.width || \n        sourceNode.data?.width || \n        sourceNode.style?.width\n      );\n      \n      const targetHasDimensions = Boolean(\n        targetNode.width || \n        targetNode.dimensions?.width || \n        targetNode.data?.width || \n        targetNode.style?.width\n      );\n      \n      // If we don't have dimensions, use the provided coordinates directly\n      if (!sourceHasDimensions || !targetHasDimensions) {\n        return {\n          edgePath: `M${sourceX},${sourceY} L${targetX},${targetY}`,\n          labelX: (sourceX + targetX) / 2,\n          labelY: (sourceY + targetY) / 2\n        };\n      }\n\n      // Safe dimension extraction with fallbacks\n      const getNodeDimensions = (node) => {\n        const defaultWidth = node.type === 'topic' ? 180 : 200;\n        const defaultHeight = node.type === 'topic' ? 50 : 100;\n        \n        return {\n          width: node.width || \n                 node.dimensions?.width || \n                 node.data?.width || \n                 defaultWidth,\n          height: node.height || \n                  node.dimensions?.height || \n                  node.data?.height || \n                  defaultHeight\n        };\n      };\n      \n      const sourceDims = getNodeDimensions(sourceNode);\n      const targetDims = getNodeDimensions(targetNode);\n\n      // Calculate floating edge with proper intersections\n      const floatingEdgeData = getFloatingEdgePath(\n        sourceNode,\n        targetNode,\n        {\n          // Use React Flow's sourceX/Y and targetX/Y if available\n          sourcePosition: {\n            x: sourceNode.positionAbsolute?.x || sourceNode.position.x,\n            y: sourceNode.positionAbsolute?.y || sourceNode.position.y\n          },\n          targetPosition: {\n            x: targetNode.positionAbsolute?.x || targetNode.position.x,\n            y: targetNode.positionAbsolute?.y || targetNode.position.y\n          },\n          // Fallback coordinates - use the direct ones provided by React Flow\n          sourceX: sourceX,\n          sourceY: sourceY,\n          targetX: targetX,\n          targetY: targetY,\n          sourceWidth: sourceDims.width,\n          sourceHeight: sourceDims.height,\n          targetWidth: targetDims.width,\n          targetHeight: targetDims.height,\n          debug: false // Set to true to debug connection issues\n        }\n      );\n\n      const { \n        sourceX: sx, \n        sourceY: sy, \n        targetX: tx, \n        targetY: ty \n      } = floatingEdgeData;\n      \n      // Return direct line path\n      return {\n        edgePath: `M ${sx},${sy} L ${tx},${ty}`,\n        labelX: (sx + tx) / 2,\n        labelY: (sy + ty) / 2\n      };\n    } catch (error) {\n      console.warn('FloatingEdge calculation error:', error);\n      return {\n        edgePath: `M${sourceX},${sourceY} L${targetX},${targetY}`,\n        labelX: (sourceX + targetX) / 2,\n        labelY: (sourceY + targetY) / 2\n      };\n    }\n  }, [\n    source,\n    target,\n    sourceX, \n    sourceY, \n    targetX, \n    targetY,\n    data?.__forceUpdate,\n    data?.__isAnimating,\n    // Safe node dimension tracking\n    sourceNode?.id,\n    targetNode?.id,\n    sourceNode?.width,\n    sourceNode?.height,\n    targetNode?.width,\n    targetNode?.height\n  ]);\n\n  return (\n    <BaseEdge\n      id={id}\n      path={edgePath}\n      labelX={labelX}\n      labelY={labelY}\n      style={{\n        stroke: '#64748b',\n        strokeWidth: 3, // Thicker line for better visibility\n        strokeLinecap: 'round', // Round ends for smoother appearance\n        strokeOpacity: 0.95, // Slightly more opaque\n        transition: 'none', // Critical: disable all CSS transitions\n        ...style\n      }}\n      markerEnd={markerEnd}\n      markerStart={markerStart}\n      // Remove {...props} to prevent React Flow-specific props from reaching DOM\n    />\n  );\n}, (prevProps, nextProps) => {\n  // Optimize re-rendering with precise dependency checking\n  return (\n    prevProps.sourceX === nextProps.sourceX &&\n    prevProps.sourceY === nextProps.sourceY &&\n    prevProps.targetX === nextProps.targetX &&\n    prevProps.targetY === nextProps.targetY &&\n    prevProps.source === nextProps.source &&\n    prevProps.target === nextProps.target &&\n    prevProps.data?.__forceUpdate === nextProps.data?.__forceUpdate\n  );\n});\n\nexport default FloatingEdge;\n\n\n","import React, { memo } from 'react';\nimport { BaseEdge, getBezierPath, EdgeLabelRenderer } from '@xyflow/react';\n\n/**\n * Enhanced Edge Component with Label Support\n * \n * This edge component supports labels and uses proper prop destructuring\n * to prevent React Flow-specific props from reaching DOM elements.\n */\nconst EnhancedEdge = memo(({\n  id,\n  source,\n  target,\n  sourceX,\n  sourceY,\n  targetX,\n  targetY,\n  sourcePosition,\n  targetPosition,\n  style = {},\n  markerEnd,\n  markerStart,\n  label,\n  // Destructure React Flow-specific props to prevent them from reaching DOM\n  sourceHandleId,\n  targetHandleId,\n  data,\n  selected,\n  animated,\n  // Don't pass any other props to BaseEdge\n}) => {\n  const [edgePath, labelX, labelY] = getBezierPath({\n    sourceX,\n    sourceY,\n    sourcePosition,\n    targetX,\n    targetY,\n    targetPosition,\n  });\n\n  return (\n    <>\n      <BaseEdge\n        id={id}\n        path={edgePath}\n        style={style}\n        markerEnd={markerEnd}\n        markerStart={markerStart}\n        // Only pass valid BaseEdge props, no React Flow-specific props\n      />\n      {label && (\n        <EdgeLabelRenderer>\n          <div\n            style={{\n              position: 'absolute',\n              transform: `translate(-50%, -50%) translate(${labelX}px,${labelY}px)`,\n              fontSize: 12,\n              pointerEvents: 'all',\n            }}\n            className=\"nodrag nopan bg-white px-2 py-1 rounded shadow border text-xs\"\n          >\n            {label}\n          </div>\n        </EdgeLabelRenderer>\n      )}\n    </>\n  );\n});\n\nEnhancedEdge.displayName = 'EnhancedEdge';\n\nexport default EnhancedEdge;\n","import React from 'react';\n\n/**\n * Custom connection line component for React Flow.\n * Shows a preview of the connection as the user drags to create a new edge.\n * Styled to match our floating edge appearance but with enhanced visual feedback.\n */\nconst ConnectionLine = ({\n  fromX,\n  fromY,\n  toX,\n  toY,\n  connectionLineStyle,\n}) => {\n  // Create a straight path from source to target\n  const path = `M ${fromX},${fromY} L ${toX},${toY}`;\n  \n  // Apply our custom styling combined with any passed styling\n  const defaultStyle = {\n    stroke: '#3b82f6', // Bright blue for visibility\n    strokeWidth: 3.5,\n    strokeLinecap: 'round',\n    strokeDasharray: '5,3', \n    filter: 'drop-shadow(0 0 6px rgba(59, 130, 246, 0.6))',\n    animation: 'flowingDash 1s linear infinite',\n  };\n\n  // Merge the default style with any props passed in\n  const style = { ...defaultStyle, ...connectionLineStyle };\n\n  return (\n    <g>\n      {/* Main visible connection line */}\n      <path\n        d={path}\n        fill=\"none\"\n        style={style}\n      />\n      \n      {/* Larger invisible path for easier interaction */}\n      <path\n        d={path}\n        fill=\"none\"\n        stroke=\"transparent\"\n        strokeWidth={15}\n        style={{ pointerEvents: 'stroke' }}\n      />\n    </g>\n  );\n};\n\nexport default ConnectionLine;\n","// Optimized loading screen component\nimport React from 'react';\nimport { Loader2, Brain, Sparkles } from 'lucide-react';\n\nconst OptimizedLoadingScreen = ({ message = \"Loading your mind map...\", progress = null }) => {\n  return (\n    <div className=\"fixed inset-0 bg-gradient-to-br from-blue-50 to-purple-50 flex items-center justify-center z-50\">\n      <div className=\"text-center\">\n        {/* Animated brain icon */}\n        <div className=\"relative mb-6\">\n          <Brain className=\"w-16 h-16 text-blue-600 mx-auto animate-pulse\" />\n          <Sparkles className=\"w-6 h-6 text-purple-500 absolute -top-2 -right-2 animate-bounce\" />\n        </div>\n        \n        {/* Loading spinner */}\n        <div className=\"flex items-center justify-center gap-3 mb-4\">\n          <Loader2 className=\"w-6 h-6 animate-spin text-blue-600\" />\n          <span className=\"text-lg font-medium text-gray-700\">{message}</span>\n        </div>\n        \n        {/* Progress bar if provided */}\n        {progress !== null && (\n          <div className=\"w-64 bg-gray-200 rounded-full h-2 mx-auto mb-2\">\n            <div \n              className=\"bg-blue-600 h-2 rounded-full transition-all duration-300 ease-out\" \n              style={{ width: `${Math.max(0, Math.min(100, progress))}%` }}\n            />\n          </div>\n        )}\n        \n        {/* Helpful tips during loading */}\n        <div className=\"text-sm text-gray-500 max-w-md mx-auto mt-4\">\n          <p>💡 Tip: Use the force layout button to auto-arrange your nodes</p>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default OptimizedLoadingScreen;\n","// Performance optimizations for mind map rendering\nimport { useMemo, useCallback } from 'react';\n\n// Memoized node data to prevent unnecessary re-renders\nexport const useMemoizedNodeData = (data, dependencies = []) => {\n  return useMemo(() => data, dependencies);\n};\n\n// Throttled layout calculation to prevent excessive computations\nexport const useThrottledLayout = (layoutFunction, delay = 100) => {\n  return useCallback(\n    throttle(layoutFunction, delay),\n    [layoutFunction, delay]\n  );\n};\n\n// Throttle function implementation\nfunction throttle(func, delay) {\n  let timeoutId;\n  let lastExecTime = 0;\n  \n  return function (...args) {\n    const currentTime = Date.now();\n    \n    if (currentTime - lastExecTime > delay) {\n      func.apply(this, args);\n      lastExecTime = currentTime;\n    } else {\n      clearTimeout(timeoutId);\n      timeoutId = setTimeout(() => {\n        func.apply(this, args);\n        lastExecTime = Date.now();\n      }, delay - (currentTime - lastExecTime));\n    }\n  };\n}\n\n// Optimized data conversion with chunking for large datasets\nexport const convertDataInChunks = (data, chunkSize = 50) => {\n  return new Promise((resolve) => {\n    const chunks = [];\n    const allItems = [\n      ...data.topics.map(item => ({ ...item, type: 'topic' })),\n      ...data.cases.map(item => ({ ...item, type: 'case' })),\n      ...data.tasks.map(item => ({ ...item, type: 'task' })),\n      ...data.literature.map(item => ({ ...item, type: 'literature' }))\n    ];\n    \n    for (let i = 0; i < allItems.length; i += chunkSize) {\n      chunks.push(allItems.slice(i, i + chunkSize));\n    }\n    \n    resolve(chunks);\n  });\n};\n\n// Fast initial layout without force simulation\nexport const getQuickLayout = (nodes) => {\n  const gridSize = Math.ceil(Math.sqrt(nodes.length));\n  const nodeSpacing = 200;\n  \n  return nodes.map((node, index) => ({\n    ...node,\n    position: {\n      x: (index % gridSize) * nodeSpacing,\n      y: Math.floor(index / gridSize) * nodeSpacing\n    }\n  }));\n};\n\n// Memory-efficient edge creation\nexport const createOptimizedEdges = (connections, nodeIds) => {\n  const nodeIdSet = new Set(nodeIds);\n  \n  return connections\n    .filter(conn => nodeIdSet.has(conn.source) && nodeIdSet.has(conn.target))\n    .map(conn => ({\n      id: conn.id,\n      source: conn.source,\n      target: conn.target,\n      label: conn.label,\n      type: 'floating',\n      style: {\n        strokeWidth: 2,\n        stroke: '#64748b',\n        opacity: 0.85\n      },\n      animated: false,\n      updatable: true\n    }));\n};\n","// Sample literature data for testing the enhanced Literature modal\nexport const sampleLiteratureData = [\n  {\n    id: 1,\n    title: \"Efficacy of Cognitive Behavioral Therapy for Depression: A Meta-Analysis\",\n    authors: \"Smith, J.A., Johnson, B.K., Williams, C.D.\",\n    year: \"2023\",\n    type: \"meta-analysis\",\n    journal: \"Journal of Clinical Psychology\",\n    volume: \"79\",\n    pages: \"234-251\",\n    doi: \"10.1002/jclp.23456\",\n    abstract: \"This meta-analysis examines the efficacy of cognitive behavioral therapy (CBT) for treating major depressive disorder across 45 randomized controlled trials involving 3,242 participants. Results indicate that CBT shows significant effectiveness with a large effect size (d = 0.85) compared to control conditions. The analysis also reveals that individual CBT may be more effective than group CBT for severe depression cases.\",\n    keywords: \"cognitive behavioral therapy, depression, meta-analysis, psychotherapy, mental health\",\n    notes: \"\",\n    pdf_url: \"https://example.com/sample-cbt-meta-analysis.pdf\",\n    position: { x: 300, y: 100 }\n  },\n  {\n    id: 2,\n    title: \"DSM-5-TR Clinical Cases\",\n    authors: \"American Psychiatric Association\",\n    year: \"2022\",\n    type: \"guideline\",\n    journal: \"American Psychiatric Publishing\",\n    abstract: \"A comprehensive collection of clinical cases that illustrate the diagnostic criteria and clinical features of mental disorders as defined in the DSM-5-TR. Each case includes detailed patient presentations, differential diagnoses, and treatment considerations.\",\n    keywords: \"DSM-5, diagnosis, clinical cases, psychiatric disorders, differential diagnosis\",\n    notes: \"Essential reference for diagnostic clarity\",\n    position: { x: 500, y: 200 }\n  },\n  {\n    id: 3,\n    title: \"Pharmacological Treatment of Bipolar Disorder: Current Evidence\",\n    authors: \"Rodriguez, M.L., Chen, K.H., Anderson, P.R.\",\n    year: \"2023\",\n    type: \"review\",\n    journal: \"Bipolar Disorders\",\n    volume: \"25\",\n    pages: \"123-145\",\n    doi: \"10.1111/bdi.13289\",\n    abstract: \"This comprehensive review examines current evidence for pharmacological treatments of bipolar disorder, including mood stabilizers, antipsychotics, and adjunctive therapies. The review covers efficacy, safety profiles, and treatment-resistant cases.\",\n    keywords: \"bipolar disorder, pharmacotherapy, mood stabilizers, lithium, antipsychotics\",\n    notes: \"Important for medication management decisions\",\n    position: { x: 700, y: 150 }\n  },\n  {\n    id: 4,\n    title: \"Mindfulness-Based Interventions for Anxiety Disorders: A Systematic Review\",\n    authors: \"Taylor, S.M., Brown, A.J., Davis, L.K.\",\n    year: \"2023\",\n    type: \"review\",\n    journal: \"Clinical Psychology Review\",\n    volume: \"88\",\n    pages: \"102-118\",\n    abstract: \"Systematic review of mindfulness-based interventions for treating various anxiety disorders. Analysis of 28 studies shows moderate to large effect sizes for reducing anxiety symptoms, with particular effectiveness for generalized anxiety disorder.\",\n    keywords: \"mindfulness, anxiety disorders, meditation, systematic review, GAD\",\n    notes: \"Good evidence for mindfulness approaches\",\n    position: { x: 400, y: 300 }\n  },\n  {\n    id: 5,\n    title: \"Case Study: Treatment-Resistant Schizophrenia with Clozapine\",\n    authors: \"Wilson, K.R., Martinez, E.S.\",\n    year: \"2022\",\n    type: \"case-study\",\n    journal: \"Schizophrenia Bulletin\",\n    volume: \"48\",\n    pages: \"567-572\",\n    abstract: \"Detailed case study of a 28-year-old male with treatment-resistant schizophrenia who showed significant improvement after clozapine initiation. The case discusses monitoring protocols, side effect management, and long-term outcomes.\",\n    keywords: \"schizophrenia, clozapine, treatment-resistant, case study, antipsychotics\",\n    notes: \"Useful for understanding clozapine protocols\",\n    position: { x: 600, y: 400 }\n  }\n];\n\n// Sample connections between literature and other nodes\nexport const sampleConnections = [\n  {\n    id: \"conn-1\",\n    source: \"literature-1\",\n    target: \"case-101\", // Depression case\n    label: \"Treatment approach\"\n  },\n  {\n    id: \"conn-2\", \n    source: \"literature-2\",\n    target: \"topic-201\", // Diagnostic criteria topic\n    label: \"Reference guide\"\n  },\n  {\n    id: \"conn-3\",\n    source: \"literature-3\",\n    target: \"case-102\", // Bipolar case\n    label: \"Medication guidance\"\n  },\n  {\n    id: \"conn-4\",\n    source: \"literature-4\",\n    target: \"case-103\", // Anxiety case\n    label: \"Treatment option\"\n  },\n  {\n    id: \"conn-5\",\n    source: \"literature-5\",\n    target: \"case-104\", // Schizophrenia case\n    label: \"Treatment protocol\"\n  }\n];\n\n// Enhanced literature node factory\nexport const createLiteratureNode = (data) => ({\n  ...data,\n  label: data.title || 'Literature Item',\n  created_at: new Date().toISOString(),\n  updated_at: new Date().toISOString()\n});\n","// Utility to populate sample literature data for testing\nimport { sampleLiteratureData, sampleConnections } from '../data/sampleLiteratureData';\n\nexport const populateSampleLiteratureData = (setMindMapData, autoSaveMindMapData, addToast) => {\n  setMindMapData(prevData => {\n    // Add sample literature items if they don't already exist\n    const existingIds = new Set(prevData.literature.map(item => item.id));\n    const newLiterature = sampleLiteratureData.filter(item => !existingIds.has(item.id));\n    \n    if (newLiterature.length === 0) {\n      addToast('Sample literature data already exists', 'info');\n      return prevData;\n    }\n\n    // Create sample case and topic nodes to connect with literature\n    const sampleCases = [\n      {\n        id: 101,\n        label: 'Major Depression Case',\n        primary_diagnosis: 'Major Depressive Disorder',\n        chief_complaint: 'Persistent sadness and loss of interest',\n        secondary_diagnoses: ['Anxiety', 'Insomnia'],\n        position: { x: 100, y: 100 }\n      },\n      {\n        id: 102,\n        label: 'Bipolar Disorder Case', \n        primary_diagnosis: 'Bipolar I Disorder',\n        chief_complaint: 'Mood swings and impulsivity',\n        position: { x: 200, y: 200 }\n      },\n      {\n        id: 103,\n        label: 'Generalized Anxiety Case',\n        primary_diagnosis: 'Generalized Anxiety Disorder',\n        chief_complaint: 'Excessive worry and restlessness',\n        position: { x: 300, y: 300 }\n      },\n      {\n        id: 104,\n        label: 'Schizophrenia Case',\n        primary_diagnosis: 'Schizophrenia',\n        chief_complaint: 'Auditory hallucinations and delusions',\n        position: { x: 400, y: 400 }\n      }\n    ];\n\n    const sampleTopics = [\n      {\n        id: 201,\n        title: 'Diagnostic Criteria',\n        category: 'Assessment',\n        tags: ['DSM-5', 'diagnosis', 'criteria'],\n        position: { x: 150, y: 50 }\n      }\n    ];\n\n    // Filter out existing cases and topics\n    const existingCaseIds = new Set(prevData.cases.map(item => item.id));\n    const existingTopicIds = new Set(prevData.topics.map(item => item.id));\n    \n    const newCases = sampleCases.filter(item => !existingCaseIds.has(item.id));\n    const newTopics = sampleTopics.filter(item => !existingTopicIds.has(item.id));\n\n    // Add sample connections\n    const existingConnectionIds = new Set(prevData.connections.map(conn => conn.id));\n    const newConnections = sampleConnections.filter(conn => !existingConnectionIds.has(conn.id));\n\n    const updatedData = {\n      ...prevData,\n      literature: [...prevData.literature, ...newLiterature],\n      cases: [...prevData.cases, ...newCases],\n      topics: [...prevData.topics, ...newTopics],\n      connections: [...prevData.connections, ...newConnections]\n    };\n\n    // Save the updated data\n    autoSaveMindMapData(updatedData);\n    addToast(`Added ${newLiterature.length} literature items, ${newCases.length} cases, and ${newTopics.length} topics`, 'success');\n    \n    return updatedData;\n  });\n};\n\nexport const clearSampleData = (setMindMapData, autoSaveMindMapData, addToast) => {\n  setMindMapData(prevData => {\n    // Remove sample data based on IDs\n    const sampleLiteratureIds = new Set(sampleLiteratureData.map(item => item.id));\n    const sampleConnectionIds = new Set(sampleConnections.map(conn => conn.id));\n    const sampleCaseIds = new Set([101, 102, 103, 104]);\n    const sampleTopicIds = new Set([201]);\n\n    const updatedData = {\n      ...prevData,\n      literature: prevData.literature.filter(item => !sampleLiteratureIds.has(item.id)),\n      cases: prevData.cases.filter(item => !sampleCaseIds.has(item.id)),\n      topics: prevData.topics.filter(item => !sampleTopicIds.has(item.id)),\n      connections: prevData.connections.filter(conn => !sampleConnectionIds.has(conn.id))\n    };\n\n    autoSaveMindMapData(updatedData);\n    addToast('Sample literature data cleared', 'success');\n    \n    return updatedData;\n  });\n};\n","import React, { useState, useEffect, useCallback, useRef, useMemo, Suspense, lazy } from 'react';\nimport '@xyflow/react/dist/style.css';\nimport './App.css';\nimport axios from 'axios';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport {\n  ReactFlow,\n  addEdge,\n  Background,\n  Controls,\n  MiniMap,\n  useNodesState,\n  useEdgesState,\n  ReactFlowProvider,\n  Panel,\n  Handle,\n  Position,\n  useReactFlow,\n} from '@xyflow/react';\n\n// Lazy load heavy D3 dependencies\nconst loadD3Force = () => import('d3-force');\nconst loadDagre = () => import('dagre');\n\nimport {\n  Plus,\n  Brain,\n  Users,\n  CheckSquare,\n  Edit3,\n  Save,\n  ArrowLeft,\n  FileText,\n  Calendar,\n  Target,\n  BookOpen,\n  Trash2,\n  X,\n  Shuffle,\n  Download,\n  Cloud,\n  CheckCircle,\n  Tag,\n  Clock,\n  AlertCircle,\n  Info,\n  Star,\n  Zap,\n  Settings,\n  Eye,\n  Upload,\n  Bell,\n  CheckCircle2,\n  Loader2,\n  Sparkles,\n  Search, // Added for global search functionality\n  Heart,\n  Bookmark,\n  User,\n  Clipboard,\n  StickyNote,\n  Paperclip,\n  ChevronDown,\n  ChevronUp,\n  ArrowDown\n} from 'lucide-react';\n\n// Lazy load components for better initial load time\nimport { RichTextEditor, TemplateManager, LiteratureModal } from './components/LazyComponents';\nimport CaseModal from './components/CaseModal';\nimport TopicModal from './components/TopicModal';\nimport TaskModal from './components/TaskModal';\nimport FloatingEdge from './components/FloatingEdge'; // Import the custom FloatingEdge component\nimport EnhancedEdge from './components/EnhancedEdge'; // Import the enhanced edge component\nimport ConnectionLine from './components/ConnectionLine'; // Import the custom connection line for previews\nimport OptimizedLoadingScreen from './components/OptimizedLoadingScreen';\n\n// Import performance utilities\nimport { \n  useMemoizedNodeData, \n  convertDataInChunks, \n  getQuickLayout, \n  createOptimizedEdges \n} from './utils/performanceUtils';\nimport { populateSampleLiteratureData, clearSampleData } from './utils/sampleDataUtils';\n\n// Use the environment variable for the backend URL, but provide a fallback\n// to the local server for development. This is a more robust pattern.\n// The .replace() call removes any trailing slashes to prevent \"404 Not Found\"\n// errors caused by double slashes in the request path (e.g., \"//api/\").\nconst BACKEND_URL = (process.env.REACT_APP_BACKEND_URL || 'http://localhost:8000').replace(/\\/$/, '');\nconst API = `${BACKEND_URL}/api`;\n\n// Fix ResizeObserver error that prevents React Flow from working\nconst debounce = (func, wait) => {\n  let timeout;\n  return function executedFunction(...args) {\n    const later = () => {\n      clearTimeout(timeout);\n      func(...args);\n    };\n    clearTimeout(timeout);\n    timeout = setTimeout(later, wait);\n  };\n};\n\n// Suppress ResizeObserver errors that don't affect functionality\nconst originalError = console.error;\nconsole.error = (...args) => {\n  if (args[0] && args[0].includes && args[0].includes('ResizeObserver loop')) {\n    return;\n  }\n  originalError(...args);\n};\n\n// Toast Notification System\nconst Toast = ({ message, type = 'success', onClose, duration = 3000 }) => {\n  useEffect(() => {\n    const timer = setTimeout(onClose, duration);\n    return () => clearTimeout(timer);\n  }, [onClose, duration]);\n\n  const getToastStyles = () => {\n    const baseStyles = \"fixed top-4 right-4 z-50 px-6 py-3 rounded-lg shadow-lg transition-all duration-500 transform\";\n    const typeStyles = {\n      success: \"bg-green-600 text-white border-l-4 border-green-400\",\n      error: \"bg-red-600 text-white border-l-4 border-red-400\",\n      info: \"bg-blue-600 text-white border-l-4 border-blue-400\",\n      saving: \"bg-purple-600 text-white border-l-4 border-purple-400\"\n    };\n    return `${baseStyles} ${typeStyles[type]}`;\n  };\n\n  const getIcon = () => {\n    switch (type) {\n      case 'success': return <CheckCircle2 size={16} className=\"mr-2\" />;\n      case 'error': return <AlertCircle size={16} className=\"mr-2\" />;\n      case 'info': return <Info size={16} className=\"mr-2\" />;\n      case 'saving': return <Loader2 size={16} className=\"mr-2 animate-spin\" />;\n      default: return <CheckCircle2 size={16} className=\"mr-2\" />;\n    }\n  };\n\n  return (\n    <div className={getToastStyles()}>\n      <div className=\"flex items-center\">\n        {getIcon()}\n        <span className=\"text-sm font-medium\">{message}</span>\n        <button\n          onClick={onClose}\n          className=\"ml-4 text-white hover:text-gray-200 transition-colors\"\n        >\n          <X size={14} />\n        </button>\n      </div>\n    </div>\n  );\n};\n\n// Enhanced Loading Button Component\nconst LoadingButton = ({ onClick, loading, disabled, children, className, icon: Icon, ...props }) => {\n  return (\n    <button\n      onClick={onClick}\n      disabled={disabled || loading}\n      className={`${className} transform transition-all duration-200 hover:scale-105 active:scale-95 ${disabled || loading ? 'cursor-not-allowed opacity-50' : 'hover:shadow-lg'\n        }`}\n      {...props}\n    >\n      <div className=\"flex items-center gap-2\">\n        {loading ? (\n          <Loader2 size={16} className=\"animate-spin\" />\n        ) : Icon ? (\n          <Icon size={16} />\n        ) : null}\n        {children}\n      </div>\n    </button>\n  );\n};\n\n// localStorage utilities with enhanced feedback\nconst STORAGE_KEY = 'pgy3_mindmap_data';\nconst STORAGE_VERSION = '1.1';\n\nconst localStorageUtils = {\n  // Save data to localStorage with debouncing and callback for UI feedback\n  save: (() => {\n    let timeoutId;\n    return (data, onSaveStart, onSaveComplete, isAnimating = false) => {\n      clearTimeout(timeoutId);\n\n      if (onSaveStart) onSaveStart();\n\n      // Increase debounce delay during animations\n      const debounceDelay = isAnimating ? 1200 : 800;\n\n      timeoutId = setTimeout(() => {\n        try {\n          const storageData = {\n            version: STORAGE_VERSION,\n            timestamp: new Date().toISOString(),\n            data: data\n          };\n          localStorage.setItem(STORAGE_KEY, JSON.stringify(storageData));\n          console.log('Mind map data auto-saved to localStorage');\n          if (onSaveComplete) onSaveComplete(true);\n        } catch (error) {\n          console.error('Error saving to localStorage:', error);\n          if (onSaveComplete) onSaveComplete(false, error);\n\n          if (error.name === 'QuotaExceededError') {\n            console.warn('localStorage quota exceeded, clearing old data...');\n            try {\n              localStorage.removeItem(STORAGE_KEY);\n            } catch (clearError) {\n              console.error('Error clearing localStorage:', clearError);\n            }\n          }\n        }\n      }, debounceDelay); // Variable debounce delay\n    };\n  })(),\n\n  // Load data from localStorage\n  load: () => {\n    try {\n      const stored = localStorage.getItem(STORAGE_KEY);\n      if (!stored) {\n        console.log('No localStorage data found');\n        return null;\n      }\n\n      const storageData = JSON.parse(stored);\n\n      // Version check\n      if (storageData.version !== STORAGE_VERSION) {\n        console.log('localStorage version mismatch, clearing old data');\n        localStorage.removeItem(STORAGE_KEY);\n        return null;\n      }\n\n      console.log('Mind map data loaded from localStorage', storageData.timestamp);\n      return storageData.data;\n    } catch (error) {\n      console.error('Error loading from localStorage:', error);\n      // Clear corrupted data\n      try {\n        localStorage.removeItem(STORAGE_KEY);\n      } catch (clearError) {\n        console.error('Error clearing corrupted localStorage:', clearError);\n      }\n      return null;\n    }\n  },\n\n  // Clear stored data\n  clear: () => {\n    try {\n      localStorage.removeItem(STORAGE_KEY);\n      console.log('localStorage data cleared');\n    } catch (error) {\n      console.error('Error clearing localStorage:', error);\n    }\n  },\n\n  // Get storage info\n  getStorageInfo: () => {\n    try {\n      const stored = localStorage.getItem(STORAGE_KEY);\n      if (!stored) return null;\n\n      const data = JSON.parse(stored);\n      return {\n        version: data.version,\n        timestamp: data.timestamp,\n        size: new Blob([stored]).size\n      };\n    } catch (error) {\n      return null;\n    }\n  }\n};\n\n// Enhanced CSV export utilities\nconst csvUtils = {\n  generatePatientCasesCSV: (cases, onProgress) => {\n    if (!cases || cases.length === 0) {\n      return '';\n    }\n\n    if (onProgress) onProgress(10, 'Preparing headers...');\n\n    // Enhanced CSV headers with more detailed information\n    const headers = [\n      'Case ID',\n      'Encounter Date',\n      'Primary Diagnosis',\n      'Secondary Diagnoses',\n      'Age',\n      'Gender',\n      'Chief Complaint',\n      'History of Present Illness',\n      'Medical History',\n      'Medications',\n      'Mental Status Exam',\n      'Assessment & Plan',\n      'Status',\n      'Notes',\n      'Created Date',\n      'Updated Date',\n      'Linked Topics Count',\n      'Last Modified By'\n    ];\n\n    if (onProgress) onProgress(30, 'Processing case data...');\n\n    // Convert cases to CSV rows with enhanced data\n    const rows = cases.map((caseItem, index) => {\n      if (onProgress) onProgress(30 + (index / cases.length) * 50, `Processing case ${index + 1}/${cases.length}...`);\n\n      return [\n        caseItem.case_id || '',\n        caseItem.encounter_date ? new Date(caseItem.encounter_date).toLocaleDateString() : '',\n        caseItem.primary_diagnosis || '',\n        Array.isArray(caseItem.secondary_diagnoses) ? caseItem.secondary_diagnoses.join('; ') : '',\n        caseItem.age || '',\n        caseItem.gender || '',\n        caseItem.chief_complaint || '',\n        caseItem.history_present_illness || '',\n        caseItem.medical_history || '',\n        Array.isArray(caseItem.medications) ? caseItem.medications.join('; ') : '',\n        caseItem.mental_status_exam || '',\n        caseItem.assessment_plan || '',\n        caseItem.status || '',\n        caseItem.notes || '',\n        caseItem.created_at ? new Date(caseItem.created_at).toLocaleDateString() : '',\n        caseItem.updated_at ? new Date(caseItem.updated_at).toLocaleDateString() : '',\n        Array.isArray(caseItem.linked_topics) ? caseItem.linked_topics.length : '0',\n        'PGY-3 System'\n      ];\n    });\n\n    if (onProgress) onProgress(85, 'Formatting CSV content...');\n\n    // Escape CSV values and join\n    const escapeCsvValue = (value) => {\n      const stringValue = String(value);\n      if (stringValue.includes(',') || stringValue.includes('\"') || stringValue.includes('\\n')) {\n        return `\"${stringValue.replace(/\"/g, '\"\"')}\"`;\n      }\n      return stringValue;\n    };\n\n    const csvContent = [\n      headers.map(escapeCsvValue).join(','),\n      ...rows.map(row => row.map(escapeCsvValue).join(','))\n    ].join('\\n');\n\n    if (onProgress) onProgress(100, 'CSV generation complete!');\n\n    return csvContent;\n  },\n\n  downloadCSV: (csvContent, filename = 'patient_cases.csv') => {\n    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\n    const link = document.createElement('a');\n    const url = URL.createObjectURL(blob);\n\n    link.setAttribute('href', url);\n    link.setAttribute('download', filename);\n    link.style.visibility = 'hidden';\n\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n\n    URL.revokeObjectURL(url);\n  },\n\n  // Generate summary statistics\n  generateCasesSummary: (cases) => {\n    if (!cases || cases.length === 0) return null;\n\n    const diagnoses = {};\n    const statuses = {};\n    const ageGroups = { '18-30': 0, '31-50': 0, '51-70': 0, '70+': 0, 'Unknown': 0 };\n    const genders = {};\n\n    cases.forEach(caseItem => {\n      // Diagnoses\n      if (caseItem.primary_diagnosis) {\n        diagnoses[caseItem.primary_diagnosis] = (diagnoses[caseItem.primary_diagnosis] || 0) + 1;\n      }\n\n      // Status\n      if (caseItem.status) {\n        statuses[caseItem.status] = (statuses[caseItem.status] || 0) + 1;\n      }\n\n      // Age groups\n      if (caseItem.age) {\n        if (caseItem.age <= 30) ageGroups['18-30']++;\n        else if (caseItem.age <= 50) ageGroups['31-50']++;\n        else if (caseItem.age <= 70) ageGroups['51-70']++;\n        else ageGroups['70+']++;\n      } else {\n        ageGroups['Unknown']++;\n      }\n\n      // Gender\n      if (caseItem.gender) {\n        genders[caseItem.gender] = (genders[caseItem.gender] || 0) + 1;\n      }\n    });\n\n    return {\n      totalCases: cases.length,\n      diagnoses,\n      statuses,\n      ageGroups,\n      genders\n    };\n  }\n};\n\n// Enhanced Custom Node Components with better visual effects and data\nconst TopicNode = ({ data, selected }) => {\n  const [isVisible, setIsVisible] = useState(data.skipAnimation || false);\n  \n  // Entry animation - only if not skipping animations\n  useEffect(() => {\n    if (!data.skipAnimation) {\n      const timer = setTimeout(() => setIsVisible(true), 100);\n      return () => clearTimeout(timer);\n    }\n  }, [data.skipAnimation]);\n\n  const completionPercentage = data.flashcard_count > 0\n    ? ((data.completed_flashcards || 0) / data.flashcard_count) * 100\n    : 0;\n\n  return (\n    <div\n      className={`group px-4 py-3 rounded-xl shadow-lg border-2 transition-all duration-700 min-w-[220px] relative hover:shadow-2xl transform hover:scale-105 backdrop-blur-sm ${selected\n          ? 'border-teal-400 shadow-xl scale-105 ring-4 ring-teal-200 animate-pulse'\n          : 'border-transparent hover:border-teal-300 hover:ring-2 hover:ring-teal-100'\n        } ${isVisible ? 'opacity-100 scale-100 translate-y-0' : 'opacity-0 scale-75 translate-y-8'}`}\n      style={{\n        backgroundColor: data.color || '#3B82F6',\n        color: 'white',\n        boxShadow: selected\n          ? `0 0 20px ${data.color || '#3B82F6'}40`\n          : `0 4px 20px ${data.color || '#3B82F6'}20`,\n        transition: 'all 0.7s cubic-bezier(0.34, 1.56, 0.64, 1), transform 0.3s ease'\n      }}\n    >\n      {/* Connection Hotspots - Stacked source and target handles for all four sides */}\n      {/* Top handles */}\n      <Handle\n        id=\"top\"\n        type=\"source\"\n        position={Position.Top}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          left: '50%',\n          transform: 'translateX(-50%)',\n          zIndex: 2\n        }}\n        isConnectable={true}\n      />\n      <Handle\n        id=\"top\"\n        type=\"target\"\n        position={Position.Top}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          left: '50%',\n          transform: 'translateX(-50%)',\n          zIndex: 1\n        }}\n        isConnectable={true}\n      />\n\n      {/* Right handles */}\n      <Handle\n        id=\"right\"\n        type=\"source\"\n        position={Position.Right}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          top: '50%',\n          transform: 'translateY(-50%)',\n          zIndex: 2\n        }}\n        isConnectable={true}\n      />\n      <Handle\n        id=\"right\"\n        type=\"target\"\n        position={Position.Right}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          top: '50%',\n          transform: 'translateY(-50%)',\n          zIndex: 1\n        }}\n        isConnectable={true}\n      />\n\n      {/* Bottom handles */}\n      <Handle\n        id=\"bottom\"\n        type=\"source\"\n        position={Position.Bottom}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          left: '50%',\n          transform: 'translateX(-50%)',\n          zIndex: 2\n        }}\n        isConnectable={true}\n      />\n      <Handle\n        id=\"bottom\"\n        type=\"target\"\n        position={Position.Bottom}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          left: '50%',\n          transform: 'translateX(-50%)',\n          zIndex: 1\n        }}\n        isConnectable={true}\n      />\n\n      {/* Left handles */}\n      <Handle\n        id=\"left\"\n        type=\"source\"\n        position={Position.Left}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          top: '50%',\n          transform: 'translateY(-50%)',\n          zIndex: 2\n        }}\n        isConnectable={true}\n      />\n      <Handle\n        id=\"left\"\n        type=\"target\"\n        position={Position.Left}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          top: '50%',\n          transform: 'translateY(-50%)',\n          zIndex: 1\n        }}\n        isConnectable={true}\n      />\n\n      {/* Priority indicator */}\n      {data.priority && (\n        <div className=\"absolute -top-2 -right-2\">\n          <div className={`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold border-2 border-white ${data.priority === 'high' ? 'bg-red-500' :\n              data.priority === 'medium' ? 'bg-yellow-500' : 'bg-green-500'\n            }`}>\n            {data.priority === 'high' ? '!' : data.priority === 'medium' ? '•' : '✓'}\n          </div>\n        </div>\n      )}\n\n      <div className=\"flex items-center gap-2 mb-2\">\n        <div className=\"flex items-center gap-1\">\n          <Brain size={16} className=\"drop-shadow-sm\" />\n          {data.tags && data.tags.length > 0 && (\n            <Tag size={12} className=\"opacity-75\" />\n          )}\n        </div>\n        <div className=\"font-semibold text-sm truncate flex-1\">{data.label}</div>\n        {data.onDelete && (\n          <button\n            onClick={(e) => {\n              e.stopPropagation();\n              data.onDelete();\n            }}\n            className=\"ml-auto p-1 hover:bg-white hover:bg-opacity-20 rounded transition-all duration-200 hover:scale-110 opacity-70 hover:opacity-100\"\n          >\n            <X size={12} />\n          </button>\n        )}\n      </div>\n\n      <div className=\"text-xs opacity-90 mb-2\">{data.category}</div>\n\n      {/* Enhanced progress display */}\n      {data.flashcard_count > 0 && (\n        <div className=\"text-xs mt-2 space-y-1\">\n          <div className=\"flex justify-between items-center\">\n            <span className=\"opacity-90\">{data.completed_flashcards}/{data.flashcard_count} flashcards</span>\n            <span className=\"font-semibold\">{Math.round(completionPercentage)}%</span>\n          </div>\n          <div className=\"w-full bg-white bg-opacity-20 rounded-full h-2 overflow-hidden\">\n            <div\n              className=\"h-full bg-white rounded-full transition-all duration-1000 ease-out\"\n              style={{ width: `${completionPercentage}%` }}\n            />\n          </div>\n        </div>\n      )}\n\n      {/* Tags display */}\n      {data.tags && data.tags.length > 0 && (\n        <div className=\"flex flex-wrap gap-1 mt-2\">\n          {data.tags.slice(0, 3).map((tag, index) => (\n            <span\n              key={index}\n              className=\"px-2 py-1 bg-white bg-opacity-20 rounded-full text-xs\"\n            >\n              {tag}\n            </span>\n          ))}\n          {data.tags.length > 3 && (\n            <span className=\"px-2 py-1 bg-white bg-opacity-20 rounded-full text-xs\">\n              +{data.tags.length - 3}\n            </span>\n          )}\n        </div>\n      )}\n\n      {/* Last updated indicator */}\n      {data.updated_at && (\n        <div className=\"absolute bottom-1 right-1 opacity-50\">\n          <Clock size={10} />\n        </div>\n      )}\n    </div>\n  );\n};\n\nconst CaseNode = ({ data, selected }) => {\n  const [isVisible, setIsVisible] = useState(data.skipAnimation || false);\n  \n  // Entry animation with slight delay for staggered effect - only if not skipping animations\n  useEffect(() => {\n    if (!data.skipAnimation) {\n      const timer = setTimeout(() => setIsVisible(true), 150);\n      return () => clearTimeout(timer);\n    }\n  }, [data.skipAnimation]);\n\n  const getStatusColor = (status) => {\n    switch (status) {\n      case 'active': return 'bg-green-100 text-green-800 border-green-200';\n      case 'archived': return 'bg-gray-100 text-gray-800 border-gray-200';\n      case 'follow_up': return 'bg-yellow-100 text-yellow-800 border-yellow-200';\n      default: return 'bg-blue-100 text-blue-800 border-blue-200';\n    }\n  };\n\n  const getUrgencyLevel = (data) => {\n    // Simple urgency calculation based on keywords\n    const urgentKeywords = ['emergency', 'urgent', 'crisis', 'acute', 'severe'];\n    const complaint = data.chief_complaint?.toLowerCase() || '';\n    const diagnosis = data.diagnosis?.toLowerCase() || '';\n\n    if (urgentKeywords.some(keyword => complaint.includes(keyword) || diagnosis.includes(keyword))) {\n      return 'high';\n    }\n    return 'normal';\n  };\n\n  const urgency = getUrgencyLevel(data);\n\n  return (\n    <div\n      className={`group px-4 py-3 rounded-xl shadow-lg border-2 transition-all duration-600 min-w-[220px] bg-white relative hover:shadow-2xl transform hover:scale-105 ${selected\n          ? 'border-blue-400 shadow-xl scale-105 ring-4 ring-blue-200'\n          : 'border-gray-200 hover:border-blue-300 hover:ring-2 hover:ring-blue-100'\n        } ${urgency === 'high' ? 'ring-2 ring-red-300' : ''} ${isVisible ? 'opacity-100 scale-100 translate-y-0 rotate-0' : 'opacity-0 scale-90 translate-y-6 rotate-1'}`}\n      style={{\n        transition: 'all 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94), transform 0.3s ease'\n      }}\n    >\n      {/* Connection Hotspots - Stacked source and target handles for all four sides */}\n      {/* Top handles */}\n      <Handle\n        id=\"top\"\n        type=\"source\"\n        position={Position.Top}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          left: '50%',\n          transform: 'translateX(-50%)',\n          zIndex: 2\n        }}\n        isConnectable={true}\n      />\n      <Handle\n        id=\"top\"\n        type=\"target\"\n        position={Position.Top}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          left: '50%',\n          transform: 'translateX(-50%)',\n          zIndex: 1\n        }}\n        isConnectable={true}\n      />\n\n      {/* Right handles */}\n      <Handle\n        id=\"right\"\n        type=\"source\"\n        position={Position.Right}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          top: '50%',\n          transform: 'translateY(-50%)',\n          zIndex: 2\n        }}\n        isConnectable={true}\n      />\n      <Handle\n        id=\"right\"\n        type=\"target\"\n        position={Position.Right}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          top: '50%',\n          transform: 'translateY(-50%)',\n          zIndex: 1\n        }}\n        isConnectable={true}\n      />\n\n      {/* Bottom handles */}\n      <Handle\n        id=\"bottom\"\n        type=\"source\"\n        position={Position.Bottom}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          left: '50%',\n          transform: 'translateX(-50%)',\n          zIndex: 2\n        }}\n        isConnectable={true}\n      />\n      <Handle\n        id=\"bottom\"\n        type=\"target\"\n        position={Position.Bottom}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          left: '50%',\n          transform: 'translateX(-50%)',\n          zIndex: 1\n        }}\n        isConnectable={true}\n      />\n\n      {/* Left handles */}\n      <Handle\n        id=\"left\"\n        type=\"source\"\n        position={Position.Left}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          top: '50%',\n          transform: 'translateY(-50%)',\n          zIndex: 2\n        }}\n        isConnectable={true}\n      />\n      <Handle\n        id=\"left\"\n        type=\"target\"\n        position={Position.Left}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          top: '50%',\n          transform: 'translateY(-50%)',\n          zIndex: 1\n        }}\n        isConnectable={true}\n      />\n\n      {/* Urgency indicator */}\n      {urgency === 'high' && (\n        <div className=\"absolute -top-2 -right-2\">\n          <div className=\"w-6 h-6 bg-red-500 rounded-full flex items-center justify-center border-2 border-white animate-pulse\">\n            <AlertCircle size={14} className=\"text-white\" />\n          </div>\n        </div>\n      )}\n\n      <div className=\"flex items-center gap-2 mb-2\">\n        <div className=\"flex items-center gap-1\">\n          <Users size={16} className=\"text-blue-600\" />\n          {data.linked_topics && data.linked_topics.length > 0 && (\n            <div className=\"text-xs bg-blue-100 text-blue-600 px-1 rounded\">\n              {data.linked_topics.length}\n            </div>\n          )}\n        </div>\n        <div className=\"font-semibold text-sm text-gray-800 truncate flex-1\">{data.label}</div>\n        {data.onDelete && (\n          <button\n            onClick={(e) => {\n              e.stopPropagation();\n              data.onDelete();\n            }}\n            className=\"ml-auto p-1 hover:bg-gray-200 rounded transition-all duration-200 hover:scale-110 opacity-70 hover:opacity-100\"\n          >\n            <X size={12} />\n          </button>\n        )}\n      </div>\n\n      <div className=\"text-xs text-gray-600 mb-2 truncate\">{data.diagnosis}</div>\n\n      {/* Enhanced patient info */}\n      <div className=\"space-y-1\">\n        {data.age && (\n          <div className=\"text-xs text-blue-600 flex items-center gap-1\">\n            <Calendar size={10} />\n            Age: {data.age}\n          </div>\n        )}\n\n        {/* Status badge */}\n        {data.status && (\n          <span className={`inline-block px-2 py-1 rounded-full text-xs border ${getStatusColor(data.status)}`}>\n            {data.status}\n          </span>\n        )}\n      </div>\n\n      {/* Progress indicators */}\n      {data.tasks_count && data.tasks_count > 0 && (\n        <div className=\"mt-2 text-xs text-gray-500 flex items-center gap-1\">\n          <CheckSquare size={10} />\n          {data.completed_tasks || 0}/{data.tasks_count} tasks\n        </div>\n      )}\n\n      {/* Last updated indicator */}\n      {data.updated_at && (\n        <div className=\"absolute bottom-1 right-1 opacity-30\">\n          <Clock size={10} />\n        </div>\n      )}\n    </div>\n  );\n};\n\nconst TaskNode = ({ data, selected }) => {\n  const [isVisible, setIsVisible] = useState(data.skipAnimation || false);\n  \n  // Entry animation with different timing for variety - only if not skipping animations\n  useEffect(() => {\n    if (!data.skipAnimation) {\n      const timer = setTimeout(() => setIsVisible(true), 200);\n      return () => clearTimeout(timer);\n    }\n  }, [data.skipAnimation]);\n\n  const statusClasses = {\n    pending: 'bg-yellow-500',\n    in_progress: 'bg-blue-600',\n    completed: 'bg-green-700 opacity-60'\n  };\n\n  return (\n    <div\n      className={`group px-4 py-3 rounded-xl shadow-lg border-2 transition-all duration-500 min-w-[200px] text-white relative hover:shadow-2xl transform hover:scale-105 ${selected\n          ? 'border-yellow-400 shadow-xl scale-105 ring-4 ring-yellow-200'\n          : 'border-transparent hover:border-yellow-300 hover:ring-2 hover:ring-yellow-100'\n        } ${statusClasses[data.status] || 'bg-gray-500'} ${isVisible ? 'opacity-100 scale-100 translate-x-0' : 'opacity-0 scale-85 -translate-x-4'}`}\n      style={{\n        transition: 'all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55), transform 0.3s ease'\n      }}\n    >\n      {/* Connection Hotspots - Stacked source and target handles for all four sides */}\n      {/* Top handles */}\n      <Handle\n        id=\"top\"\n        type=\"source\"\n        position={Position.Top}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          left: '50%',\n          transform: 'translateX(-50%)',\n          zIndex: 2\n        }}\n        isConnectable={true}\n      />\n      <Handle\n        id=\"top\"\n        type=\"target\"\n        position={Position.Top}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          left: '50%',\n          transform: 'translateX(-50%)',\n          zIndex: 1\n        }}\n        isConnectable={true}\n      />\n\n      {/* Right handles */}\n      <Handle\n        id=\"right\"\n        type=\"source\"\n        position={Position.Right}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          top: '50%',\n          transform: 'translateY(-50%)',\n          zIndex: 2\n        }}\n        isConnectable={true}\n      />\n      <Handle\n        id=\"right\"\n        type=\"target\"\n        position={Position.Right}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          top: '50%',\n          transform: 'translateY(-50%)',\n          zIndex: 1\n        }}\n        isConnectable={true}\n      />\n\n      {/* Bottom handles */}\n      <Handle\n        id=\"bottom\"\n        type=\"source\"\n        position={Position.Bottom}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          left: '50%',\n          transform: 'translateX(-50%)',\n          zIndex: 2\n        }}\n        isConnectable={true}\n      />\n      <Handle\n        id=\"bottom\"\n        type=\"target\"\n        position={Position.Bottom}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          left: '50%',\n          transform: 'translateX(-50%)',\n          zIndex: 1\n        }}\n        isConnectable={true}\n      />\n\n      {/* Left handles */}\n      <Handle\n        id=\"left\"\n        type=\"source\"\n        position={Position.Left}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          top: '50%',\n          transform: 'translateY(-50%)',\n          zIndex: 2\n        }}\n        isConnectable={true}\n      />\n      <Handle\n        id=\"left\"\n        type=\"target\"\n        position={Position.Left}\n        className=\"w-3 h-3 !bg-blue-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          top: '50%',\n          transform: 'translateY(-50%)',\n          zIndex: 1\n        }}\n        isConnectable={true}\n      />\n\n      <div className=\"flex items-center gap-2 mb-1\">\n        <CheckSquare size={16} />\n        <div className=\"font-semibold text-sm\">{data.label}</div>\n        {data.onDelete && (\n          <button\n            onClick={(e) => {\n              e.stopPropagation();\n              data.onDelete();\n            }}\n            className=\"ml-auto p-1 hover:bg-white hover:bg-opacity-20 rounded transition-all duration-200 hover:scale-110 opacity-70 hover:opacity-100\"\n          >\n            <X size={12} />\n          </button>\n        )}\n      </div>\n      <div className=\"text-xs opacity-90\">Priority: {data.priority}</div>\n      {data.due_date && (\n        <div className=\"text-xs mt-1 opacity-90\">Due: {new Date(data.due_date).toLocaleDateString()}</div>\n      )}\n    </div>\n  );\n};\n\nconst LiteratureNode = ({ data, selected }) => {\n  const [isVisible, setIsVisible] = useState(data.skipAnimation || false);\n  \n  // Entry animation with the longest delay for final polish - only if not skipping animations\n  useEffect(() => {\n    if (!data.skipAnimation) {\n      const timer = setTimeout(() => setIsVisible(true), 250);\n      return () => clearTimeout(timer);\n    }\n  }, [data.skipAnimation]);\n\n  return (\n    <div\n      className={`group px-4 py-3 rounded-xl shadow-lg border-2 transition-all duration-650 min-w-[200px] bg-purple-50 relative hover:shadow-2xl transform hover:scale-105 ${selected\n          ? 'border-purple-400 shadow-xl scale-105 ring-4 ring-purple-200'\n          : 'border-purple-200 hover:border-purple-300 hover:ring-2 hover:ring-purple-100'\n        } ${isVisible ? 'opacity-100 scale-100 translate-x-0 rotate-0' : 'opacity-0 scale-95 translate-x-4 -rotate-1'}`}\n      style={{\n        transition: 'all 0.65s cubic-bezier(0.175, 0.885, 0.32, 1.275), transform 0.3s ease'\n      }}\n    >\n      {/* Connection Hotspots - Stacked source and target handles for all four sides */}\n      {/* Top handles */}\n      <Handle\n        id=\"top\"\n        type=\"source\"\n        position={Position.Top}\n        className=\"w-3 h-3 !bg-purple-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          left: '50%',\n          transform: 'translateX(-50%)',\n          zIndex: 2\n        }}\n        isConnectable={true}\n      />\n      <Handle\n        id=\"top\"\n        type=\"target\"\n        position={Position.Top}\n        className=\"w-3 h-3 !bg-purple-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          left: '50%',\n          transform: 'translateX(-50%)',\n          zIndex: 1\n        }}\n        isConnectable={true}\n      />\n\n      {/* Right handles */}\n      <Handle\n        id=\"right\"\n        type=\"source\"\n        position={Position.Right}\n        className=\"w-3 h-3 !bg-purple-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          top: '50%',\n          transform: 'translateY(-50%)',\n          zIndex: 2\n        }}\n        isConnectable={true}\n      />\n      <Handle\n        id=\"right\"\n        type=\"target\"\n        position={Position.Right}\n        className=\"w-3 h-3 !bg-purple-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          top: '50%',\n          transform: 'translateY(-50%)',\n          zIndex: 1\n        }}\n        isConnectable={true}\n      />\n\n      {/* Bottom handles */}\n      <Handle\n        id=\"bottom\"\n        type=\"source\"\n        position={Position.Bottom}\n        className=\"w-3 h-3 !bg-purple-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          left: '50%',\n          transform: 'translateX(-50%)',\n          zIndex: 2\n        }}\n        isConnectable={true}\n      />\n      <Handle\n        id=\"bottom\"\n        type=\"target\"\n        position={Position.Bottom}\n        className=\"w-3 h-3 !bg-purple-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          left: '50%',\n          transform: 'translateX(-50%)',\n          zIndex: 1\n        }}\n        isConnectable={true}\n      />\n\n      {/* Left handles */}\n      <Handle\n        id=\"left\"\n        type=\"source\"\n        position={Position.Left}\n        className=\"w-3 h-3 !bg-purple-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          top: '50%',\n          transform: 'translateY(-50%)',\n          zIndex: 2\n        }}\n        isConnectable={true}\n      />\n      <Handle\n        id=\"left\"\n        type=\"target\"\n        position={Position.Left}\n        className=\"w-3 h-3 !bg-purple-500 transition-all duration-300 hover:scale-150 cursor-pointer opacity-0 group-hover:opacity-100\"\n        style={{\n          top: '50%',\n          transform: 'translateY(-50%)',\n          zIndex: 1\n        }}\n        isConnectable={true}\n      />\n\n      <div \n        className=\"flex items-center gap-2 mb-1 cursor-pointer\"\n        onClick={(e) => {\n          e.stopPropagation();\n          if (data.onLiteratureClick) {\n            data.onLiteratureClick(data);\n          }\n        }}\n      >\n        <BookOpen size={16} className=\"text-purple-600\" />\n        <div className=\"font-semibold text-sm text-gray-800\">{data.label}</div>\n        {data.onDelete && (\n          <button\n            onClick={(e) => {\n              e.stopPropagation();\n              data.onDelete();\n            }}\n            className=\"ml-auto p-1 hover:bg-purple-200 rounded transition-all duration-200 hover:scale-110 opacity-70 hover:opacity-100\"\n          >\n            <X size={12} />\n          </button>\n        )}\n      </div>\n      <div className=\"text-xs text-gray-600\">{data.authors}</div>\n      <div className=\"text-xs text-purple-600 mt-1\">{data.year}</div>\n    </div>\n  );\n};\n\nconst nodeTypes = {\n  topic: TopicNode,\n  case: CaseNode,\n  task: TaskNode,\n  literature: LiteratureNode,\n};\n\n\n\n// Enhanced Dedicated Editing Form Component\nconst EnhancedEditingForm = ({ type, data, onClose, onSave, onDelete }) => {\n  // Initialize formData with proper field structure based on node type\n  const getInitialFormData = (type, data) => {\n    const baseData = data || {};\n    \n    switch (type) {\n      case 'case':\n        return {\n          case_id: '',\n          age: '',\n          primary_diagnosis: '',\n          gender: '',\n          chiefComplaint: '',\n          initialPresentation: '',\n          currentPresentation: '',\n          medicationHistory: '',\n          therapyProgress: '',\n          defensePatterns: '',\n          clinicalReflection: '',\n          ...baseData // Existing data takes precedence\n        };\n      case 'topic':\n        return {\n          title: '',\n          category: '',\n          color: '#3B82F6',\n          description: '',\n          notes: '',\n          tags: [],\n          ...baseData\n        };\n      case 'task':\n        return {\n          title: '',\n          description: '',\n          status: 'pending',\n          priority: 'medium',\n          due_date: '',\n          ...baseData\n        };\n      case 'literature':\n        return {\n          title: '',\n          authors: '',\n          year: '',\n          doi: '',\n          abstract: '',\n          notes: '',\n          tags: [],\n          ...baseData\n        };\n      default:\n        return baseData;\n    }\n  };\n\n  const [formData, setFormData] = useState(() => getInitialFormData(type, data));\n  const [activeTab, setActiveTab] = useState('basic');\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [errors, setErrors] = useState({});\n\n  // Update formData when data prop changes\n  useEffect(() => {\n    setFormData(getInitialFormData(type, data));\n  }, [type, data]);\n\n  const tabs = {\n    basic: 'Basic Info',\n    details: 'Details',\n    notes: 'Notes & Tags',\n    history: 'History'\n  };\n\n  const validateForm = () => {\n    const newErrors = {};\n\n    switch (type) {\n      case 'topic':\n        if (!formData.title?.trim()) newErrors.title = 'Title is required';\n        if (!formData.category?.trim()) newErrors.category = 'Category is required';\n        break;\n      case 'case':\n        if (!formData.case_id?.trim()) newErrors.case_id = 'Case ID is required';\n        if (!formData.primary_diagnosis?.trim()) newErrors.primary_diagnosis = 'Primary diagnosis is required';\n        break;\n      case 'task':\n        if (!formData.title?.trim()) newErrors.title = 'Title is required';\n        break;\n      case 'literature':\n        if (!formData.title?.trim()) newErrors.title = 'Title is required';\n        if (!formData.authors?.trim()) newErrors.authors = 'Authors are required';\n        break;\n    }\n\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = async () => {\n    if (!validateForm()) return;\n\n    setIsSubmitting(true);\n    try {\n      await onSave(formData);\n    } catch (error) {\n      console.error('Error saving:', error);\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  const updateFormData = (field, value) => {\n    setFormData(prev => ({ ...prev, [field]: value }));\n    if (errors[field]) {\n      setErrors(prev => ({ ...prev, [field]: null }));\n    }\n  };\n\n  const renderBasicTab = () => {\n    switch (type) {\n      case 'topic':\n        return (\n          <div className=\"space-y-4\">\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">Title *</label>\n              <input\n                type=\"text\"\n                value={formData.title || ''}\n                onChange={(e) => updateFormData('title', e.target.value)}\n                className={`w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500 ${errors.title ? 'border-red-500' : 'border-gray-300'\n                  }`}\n                placeholder=\"Enter topic title\"\n              />\n              {errors.title && <p className=\"text-red-500 text-xs mt-1\">{errors.title}</p>}\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">Category *</label>\n              <select\n                value={formData.category || ''}\n                onChange={(e) => updateFormData('category', e.target.value)}\n                className={`w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500 ${errors.category ? 'border-red-500' : 'border-gray-300'\n                  }`}\n              >\n                <option value=\"\">Select category</option>\n                <option value=\"Mood Disorders\">Mood Disorders</option>\n                <option value=\"Anxiety Disorders\">Anxiety Disorders</option>\n                <option value=\"Psychotic Disorders\">Psychotic Disorders</option>\n                <option value=\"Personality Disorders\">Personality Disorders</option>\n                <option value=\"Substance Use Disorders\">Substance Use Disorders</option>\n                <option value=\"Other\">Other</option>\n              </select>\n              {errors.category && <p className=\"text-red-500 text-xs mt-1\">{errors.category}</p>}\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">Color Theme</label>\n              <div className=\"flex gap-2\">\n                {['#3B82F6', '#EF4444', '#10B981', '#F59E0B', '#8B5CF6', '#EC4899'].map(color => (\n                  <button\n                    key={color}\n                    onClick={() => updateFormData('color', color)}\n                    className={`w-8 h-8 rounded-full border-2 ${formData.color === color ? 'border-gray-800' : 'border-gray-300'\n                      }`}\n                    style={{ backgroundColor: color }}\n                  />\n                ))}\n              </div>\n            </div>\n          </div>\n        );\n\n      case 'case':\n        return (\n          <div className=\"space-y-4\">\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">Case ID *</label>\n                <input\n                  type=\"text\"\n                  value={formData.case_id || ''}\n                  onChange={(e) => updateFormData('case_id', e.target.value)}\n                  className={`w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500 ${errors.case_id ? 'border-red-500' : 'border-gray-300'\n                    }`}\n                  placeholder=\"CASE-001\"\n                />\n                {errors.case_id && <p className=\"text-red-500 text-xs mt-1\">{errors.case_id}</p>}\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">Age</label>\n                <input\n                  type=\"number\"\n                  value={formData.age || ''}\n                  onChange={(e) => updateFormData('age', e.target.value)}\n                  className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\n                  min=\"0\"\n                  max=\"120\"\n                />\n              </div>\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">Primary Diagnosis *</label>\n              <input\n                type=\"text\"\n                value={formData.primary_diagnosis || ''}\n                onChange={(e) => updateFormData('primary_diagnosis', e.target.value)}\n                className={`w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500 ${errors.primary_diagnosis ? 'border-red-500' : 'border-gray-300'\n                  }`}\n                placeholder=\"Enter primary diagnosis\"\n              />\n              {errors.primary_diagnosis && <p className=\"text-red-500 text-xs mt-1\">{errors.primary_diagnosis}</p>}\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">Gender</label>\n              <select\n                value={formData.gender || ''}\n                onChange={(e) => updateFormData('gender', e.target.value)}\n                className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\n              >\n                <option value=\"\">Select gender</option>\n                <option value=\"Male\">Male</option>\n                <option value=\"Female\">Female</option>\n                <option value=\"Non-binary\">Non-binary</option>\n                <option value=\"Other\">Other</option>\n              </select>\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">Chief Complaint</label>\n              <textarea\n                value={formData.chiefComplaint || ''}\n                onChange={(e) => updateFormData('chiefComplaint', e.target.value)}\n                className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\n                rows={2}\n                placeholder=\"Describe the primary concern\"\n              />\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">Initial Presentation</label>\n              <textarea\n                value={formData.initialPresentation || ''}\n                onChange={(e) => updateFormData('initialPresentation', e.target.value)}\n                className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\n                rows={3}\n                placeholder=\"Symptoms and context at first visit\"\n              />\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">Current Presentation</label>\n              <textarea\n                value={formData.currentPresentation || ''}\n                onChange={(e) => updateFormData('currentPresentation', e.target.value)}\n                className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\n                rows={3}\n                placeholder=\"Describe how the case looks now\"\n              />\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">Medication History</label>\n              <textarea\n                value={formData.medicationHistory || ''}\n                onChange={(e) => updateFormData('medicationHistory', e.target.value)}\n                className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\n                rows={2}\n                placeholder=\"e.g. SSRI trials, mood stabilizers, etc.\"\n              />\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">Therapy Progress</label>\n              <textarea\n                value={formData.therapyProgress || ''}\n                onChange={(e) => updateFormData('therapyProgress', e.target.value)}\n                className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\n                rows={2}\n                placeholder=\"How the patient has responded to therapy\"\n              />\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">Defense Patterns</label>\n              <textarea\n                value={formData.defensePatterns || ''}\n                onChange={(e) => updateFormData('defensePatterns', e.target.value)}\n                className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\n                rows={2}\n                placeholder=\"e.g. projection, denial, rationalization\"\n              />\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">Clinical Reflection</label>\n              <textarea\n                value={formData.clinicalReflection || ''}\n                onChange={(e) => updateFormData('clinicalReflection', e.target.value)}\n                className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\n                rows={3}\n                placeholder=\"Your thoughts or questions about the case\"\n              />\n            </div>\n          </div>\n        );\n\n      default:\n        return <div>Basic form for {type}</div>;\n    }\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 backdrop-blur-sm\">\n      <div className=\"bg-white rounded-xl shadow-2xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-hidden\">\n        {/* Header */}\n        <div className=\"bg-gradient-to-r from-blue-600 to-purple-600 text-white p-6\">\n          <div className=\"flex items-center justify-between\">\n            <h2 className=\"text-xl font-semibold capitalize flex items-center gap-2\">\n              <Sparkles size={20} />\n              Enhanced {type} Editor\n            </h2>\n            <button\n              onClick={onClose}\n              className=\"text-white hover:text-gray-200 transition-colors\"\n            >\n              <X size={24} />\n            </button>\n          </div>\n        </div>\n\n        {/* Tabs */}\n        <div className=\"border-b border-gray-200\">\n          <div className=\"flex\">\n            {Object.entries(tabs).map(([key, label]) => (\n              <button\n                key={key}\n                onClick={() => setActiveTab(key)}\n                className={`px-6 py-3 text-sm font-medium transition-colors ${activeTab === key\n                    ? 'border-b-2 border-blue-500 text-blue-600 bg-blue-50'\n                    : 'text-gray-500 hover:text-gray-700'\n                  }`}\n              >\n                {label}\n              </button>\n            ))}\n          </div>\n        </div>\n\n        {/* Content */}\n        <div className=\"p-6 overflow-y-auto max-h-[calc(90vh-200px)]\">\n          {activeTab === 'basic' && renderBasicTab()}\n          {activeTab === 'details' && <div>Details content for {type}</div>}\n          {activeTab === 'notes' && <div>Notes and tags content</div>}\n          {activeTab === 'history' && <div>History content</div>}\n        </div>\n\n        {/* Footer */}\n        <div className=\"bg-gray-50 px-6 py-4 flex items-center justify-between border-t\">\n          <div className=\"flex gap-2\">\n            {onDelete && (\n              <LoadingButton\n                onClick={onDelete}\n                icon={Trash2}\n                className=\"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg\"\n              >\n                Delete\n              </LoadingButton>\n            )}\n          </div>\n\n          <div className=\"flex gap-2\">\n            <button\n              onClick={onClose}\n              className=\"px-4 py-2 text-gray-600 hover:text-gray-800 border border-gray-300 rounded-lg hover:bg-gray-100 transition-colors\"\n            >\n              Cancel\n            </button>\n            <LoadingButton\n              onClick={handleSubmit}\n              loading={isSubmitting}\n              icon={isSubmitting ? Loader2 : Save}\n              className=\"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg\"\n            >\n              {isSubmitting ? 'Saving...' : 'Save Changes'}\n            </LoadingButton>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\nconst NodeSelector = ({ isOpen, onClose, onSelect, templates }) => {\n  const [selectedNodeType, setSelectedNodeType] = useState(null);\n\n  // When the modal is closed, reset the internal state\n  useEffect(() => {\n    if (!isOpen) {\n      // Add a small delay to allow the closing animation to finish before state reset\n      const timer = setTimeout(() => setSelectedNodeType(null), 300);\n      return () => clearTimeout(timer);\n    }\n  }, [isOpen]);\n\n  if (!isOpen) return null;\n\n  const nodeTypes = [\n    { type: 'topic', label: 'Psychiatric Topic', icon: Brain, color: 'bg-blue-600', description: 'Add a new psychiatric topic or disorder' },\n    { type: 'literature', label: 'Literature', icon: BookOpen, color: 'bg-purple-600', description: 'Add research papers, articles, or references' },\n    { type: 'case', label: 'Patient Case', icon: Users, color: 'bg-indigo-600', description: 'Add a new patient case study' },\n    { type: 'task', label: 'Task', icon: CheckSquare, color: 'bg-amber-600', description: 'Add a task or to-do item' }\n  ];\n\n  const handleNodeTypeSelect = (nodeType) => {\n    setSelectedNodeType(nodeType);\n  };\n\n  const handleFinalSelect = (templateId = null) => {\n    onSelect(selectedNodeType, templateId);\n    onClose();\n  };\n\n  const filteredTemplates = selectedNodeType ? (templates || []).filter(t => t.nodeType === selectedNodeType) : [];\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 backdrop-blur-sm animate-in fade-in-25 duration-300\">\n      <div className=\"bg-white rounded-xl shadow-2xl p-6 max-w-md w-full mx-4 transform transition-all duration-300 ease-out\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between mb-6\">\n          <div className=\"flex items-center gap-3\">\n            {selectedNodeType && (\n              <button\n                onClick={() => setSelectedNodeType(null)}\n                className=\"text-gray-400 hover:text-gray-600 p-1 rounded-full hover:bg-gray-100 transition-colors\"\n              >\n                <ArrowLeft size={20} />\n              </button>\n            )}\n            <h3 className=\"text-xl font-semibold text-gray-800\">\n              {selectedNodeType ? `Select a ${selectedNodeType} template` : 'Add New Node'}\n            </h3>\n          </div>\n          <button\n            onClick={onClose}\n            className=\"text-gray-400 hover:text-gray-600 p-1\"\n          >\n            <X size={20} />\n          </button>\n        </div>\n\n        <div className=\"relative overflow-hidden\" style={{ minHeight: '200px' }}>\n          {/* View 1: Node Type Selection */}\n          <div className={`transition-transform duration-300 ease-in-out ${selectedNodeType ? '-translate-x-full opacity-0' : 'translate-x-0 opacity-100'}`}>\n            <div className=\"space-y-3\">\n              {nodeTypes.map(({ type, label, icon: Icon, color, description }) => (\n                <button\n                  key={type}\n                  onClick={() => handleNodeTypeSelect(type)}\n                  className=\"w-full flex items-center gap-4 p-4 rounded-lg border-2 border-gray-200 hover:border-blue-400 hover:bg-blue-50 transition-all text-left\"\n                >\n                  <div className={`${color} p-2 rounded-lg text-white`}>\n                    <Icon size={20} />\n                  </div>\n                  <div>\n                    <div className=\"font-medium text-gray-800\">{label}</div>\n                    <div className=\"text-sm text-gray-500\">{description}</div>\n                  </div>\n                </button>\n              ))}\n            </div>\n          </div>\n\n          {/* View 2: Template Selection */}\n          <div className={`absolute top-0 left-0 w-full transition-transform duration-300 ease-in-out ${selectedNodeType ? 'translate-x-0 opacity-100' : 'translate-x-full opacity-0'}`}>\n            {selectedNodeType && (\n              <div className=\"space-y-3\">\n                {/* Create Blank Option */}\n                <button\n                  onClick={() => handleFinalSelect(null)}\n                  className=\"w-full flex items-center gap-4 p-4 rounded-lg border-2 border-dashed border-gray-300 hover:border-blue-400 hover:bg-blue-50 transition-all text-left\"\n                >\n                  <div className=\"bg-gray-200 p-2 rounded-lg text-gray-600\">\n                    <Plus size={20} />\n                  </div>\n                  <div>\n                    <div className=\"font-medium text-gray-800\">Create Blank {selectedNodeType}</div>\n                    <div className=\"text-sm text-gray-500\">Start with an empty node.</div>\n                  </div>\n                </button>\n\n                {/* Filtered Templates */}\n                {filteredTemplates.map((template) => (\n                  <button\n                    key={template.id}\n                    onClick={() => handleFinalSelect(template.id)}\n                    className=\"w-full flex items-center gap-4 p-4 rounded-lg border-2 border-gray-200 hover:border-blue-400 hover:bg-blue-50 transition-all text-left\"\n                  >\n                    <div className=\"bg-indigo-100 p-2 rounded-lg text-indigo-600\">\n                      <FileText size={20} />\n                    </div>\n                    <div>\n                      <div className=\"font-medium text-gray-800\">{template.name}</div>\n                      <div className=\"text-sm text-gray-500 truncate\">{template.data?.description || template.data?.abstract || template.data?.assessment_plan || 'No description'}</div>\n\n                    </div>\n                  </button>\n                ))}\n\n                {filteredTemplates.length === 0 && (\n                  <div className=\"text-center text-sm text-gray-500 py-4\">\n                    No templates found for this node type.\n                  </div>\n                )}\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\n// Edge Label Modal Component\nconst EdgeLabelModal = ({ edge, isOpen, onClose, onSave }) => {\n  const [label, setLabel] = useState(edge?.label || '');\n\n  // Update label when edge changes\n  useEffect(() => {\n    setLabel(edge?.label || '');\n  }, [edge]);\n\n  const handleSave = () => {\n    onSave(edge.id, label);\n    onClose();\n  };\n\n  const handleKeyPress = (e) => {\n    if (e.key === 'Enter') {\n      handleSave();\n    } else if (e.key === 'Escape') {\n      onClose();\n    }\n  };\n\n  if (!isOpen || !edge) return null;\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 backdrop-blur-sm\">\n      <div className=\"bg-white rounded-xl shadow-2xl p-6 max-w-md w-full mx-4 transform transition-all\">\n        <div className=\"flex items-center justify-between mb-6\">\n          <h3 className=\"text-xl font-semibold text-gray-800\">Edit Connection Label</h3>\n          <button\n            onClick={onClose}\n            className=\"text-gray-400 hover:text-gray-600 p-1 transition-colors\"\n          >\n            <X size={20} />\n          </button>\n        </div>\n\n        <div className=\"mb-6\">\n          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n            Connection Label\n          </label>\n          <input\n            type=\"text\"\n            value={label}\n            onChange={(e) => setLabel(e.target.value)}\n            onKeyPress={handleKeyPress}\n            placeholder=\"Enter a label for this connection...\"\n            className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all\"\n            autoFocus\n          />\n          <p className=\"text-xs text-gray-500 mt-1\">\n            Press Enter to save, Escape to cancel\n          </p>\n        </div>\n\n        <div className=\"flex items-center justify-end gap-3\">\n          <button\n            onClick={onClose}\n            className=\"px-4 py-2 text-gray-600 hover:text-gray-800 border border-gray-300 rounded-lg hover:bg-gray-100 transition-colors\"\n          >\n            Cancel\n          </button>\n          <button\n            onClick={handleSave}\n            className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2\"\n          >\n            <Save size={16} />\n            Save Label\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\n// Enhanced Main Dashboard Component with improved visual effects\nconst DashboardComponent = () => {\n  const { fitView, setCenter, zoomTo, getViewport } = useReactFlow();\n\n  const [nodes, setNodes, onNodesChange] = useNodesState([]);\n  const [edges, setEdges, onEdgesChange] = useEdgesState([]);\n\n  const [mindMapData, setMindMapData] = useState({\n    topics: [],\n    cases: [],\n    tasks: [],\n    literature: [],\n    connections: []\n  });\n\n  const [isEditing, setIsEditing] = useState(false);\n  const [selectedNode, setSelectedNode] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [loadingProgress, setLoadingProgress] = useState(0);\n  const [loadingMessage, setLoadingMessage] = useState('Initializing...');\n  const [isInitialLoad, setIsInitialLoad] = useState(true);\n  const [focusedCategory, setFocusedCategory] = useState(null);\n  const [showNodeSelector, setShowNodeSelector] = useState(false);\n  // Specialized modal state for each node type with stable data references\n  const [caseModal, setCaseModal] = useState({ isOpen: false, data: null });\n  const [topicModal, setTopicModal] = useState({ isOpen: false, data: null });\n  const [taskModal, setTaskModal] = useState({ isOpen: false, data: null });\n  const caseModalStableData = useRef(null);\n  const topicModalStableData = useRef(null);\n  const taskModalStableData = useRef(null);\n  const [isReactFlowReady, setIsReactFlowReady] = useState(false);\n  const [hasAppliedInitialLayout, setHasAppliedInitialLayout] = useState(false);\n  const [isExportingCSV, setIsExportingCSV] = useState(false);\n  const [lastSaved, setLastSaved] = useState(null);\n  const [isSaving, setIsSaving] = useState(false);\n  const [edgeModal, setEdgeModal] = useState({ isOpen: false, edge: null });\n  const [templates, setTemplates] = useState([]);\n  const [exportProgress, setExportProgress] = useState({ show: false, progress: 0, message: '' });\n\n  const [toasts, setToasts] = useState([]);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [searchResultsCount, setSearchResultsCount] = useState(0);\n  const [isTemplateManagerOpen, setIsTemplateManagerOpen] = useState(false);\n  const [literatureModal, setLiteratureModal] = useState({ isOpen: false, data: null });\n  const [isAnimating, setIsAnimating] = useState(false); // Track animation state\n  const [modalAnimationStates, setModalAnimationStates] = useState({\n    case: false,\n    topic: false,\n    task: false,\n    literature: false\n  });\n  // Separate nodeVisibility state to track node visibility without modifying node data\n  const [nodeVisibility, setNodeVisibility] = useState({});\n  // Use a ref to store the current visibility state for comparison\n  const visibilityRef = useRef({});\n  \n  // Initialize the ref\n  useEffect(() => {\n    // Only initialize once if empty\n    if (Object.keys(visibilityRef.current).length === 0) {\n      visibilityRef.current = {};\n    }\n  }, []);\n\n  const addToast = useCallback((message, type = 'success', duration = 3000) => {\n    const id = Date.now();\n    const newToast = { id, message, type, duration };\n    setToasts(prev => [...prev, newToast]);\n  }, []);\n\n  const removeToast = useCallback((id) => {\n    setToasts(prev => prev.filter(toast => toast.id !== id));\n  }, []);\n\n  const autoSaveMindMapData = useCallback((data) => {\n    // Enhanced animation and modal state checking\n    const anyModalOpen = caseModal.isOpen || topicModal.isOpen || taskModal.isOpen || literatureModal.isOpen;\n    const anyModalAnimating = Object.values(modalAnimationStates).some(state => state);\n    const anyModalTransitioning = (caseModal.isOpen && caseModal.data?.isTabTransitioning) || \n                                  (topicModal.isOpen && topicModal.data?.isTabTransitioning) ||\n                                  (taskModal.isOpen && taskModal.data?.isTabTransitioning);\n    \n    if (isAnimating || anyModalOpen || anyModalTransitioning || anyModalAnimating) {\n      console.log('Deferring auto-save during animation, modal interaction, or tab transition');\n      // Use a longer delay and exponential backoff for persistent animation states\n      const delay = anyModalTransitioning || anyModalAnimating ? 2000 : 1000;\n      setTimeout(() => autoSaveMindMapData(data), delay);\n      return;\n    }\n\n    const onSaveStart = () => setIsSaving(true);\n    const onSaveComplete = (success, error) => {\n      setIsSaving(false);\n      if (success) {\n        setLastSaved(new Date());\n        // Reduce toast frequency during auto-save to prevent UI distractions\n        // addToast('Data auto-saved', 'saving', 1000);\n      } else {\n        addToast('Auto-save failed', 'error', 4000);\n        console.error('Auto-save error:', error);\n      }\n    };\n\n    localStorageUtils.save(data, onSaveStart, onSaveComplete, isAnimating);\n    // Use requestIdleCallback for backend saves to avoid blocking animations\n    if (window.requestIdleCallback) {\n      window.requestIdleCallback(() => {\n        // Double-check animation state before backend save\n        const stillAnimating = isAnimating || Object.values(modalAnimationStates).some(state => state);\n        if (!stillAnimating) {\n          saveToBackend(data);\n        }\n      }, { timeout: 5000 });\n    } else {\n      setTimeout(() => {\n        const stillAnimating = isAnimating || Object.values(modalAnimationStates).some(state => state);\n        if (!stillAnimating) {\n          saveToBackend(data);\n        }\n      }, 100); // Longer delay fallback\n    }\n  }, [addToast, isAnimating, modalAnimationStates, caseModal.isOpen, topicModal.isOpen, taskModal.isOpen, literatureModal.isOpen]);\n\n  // Separate function for position-only updates (more frequent, less critical)\n  const autoSavePositionData = useCallback((data) => {\n    // Enhanced checks for animation states\n    const anyModalOpen = caseModal.isOpen || topicModal.isOpen || taskModal.isOpen || literatureModal.isOpen;\n    const anyModalAnimating = Object.values(modalAnimationStates).some(state => state);\n    if (isAnimating || anyModalOpen || anyModalAnimating) return;\n    \n    // Save to localStorage immediately\n    localStorageUtils.save(data, null, null, isAnimating);\n    \n    // Also save to backend with a small delay to batch updates\n    clearTimeout(window.positionBackendSaveTimeout);\n    window.positionBackendSaveTimeout = setTimeout(() => {\n      // Call saveToBackend indirectly to avoid initialization issues\n      autoSaveMindMapData(data);\n    }, 800); // 800ms delay to batch multiple position changes\n  }, [isAnimating, modalAnimationStates, caseModal.isOpen, topicModal.isOpen, taskModal.isOpen, literatureModal.isOpen, autoSaveMindMapData]);\n\n  // Stable data effects to prevent modal re-renders during auto-save\n  useEffect(() => {\n    if (caseModal.isOpen && caseModal.data) {\n      // Store stable reference when modal opens\n      caseModalStableData.current = { ...caseModal.data };\n    } else if (!caseModal.isOpen) {\n      // Clear reference when modal closes\n      caseModalStableData.current = null;\n    }\n  }, [caseModal.isOpen, caseModal.data?.id]);\n\n  useEffect(() => {\n    if (topicModal.isOpen && topicModal.data) {\n      topicModalStableData.current = { ...topicModal.data };\n    } else if (!topicModal.isOpen) {\n      topicModalStableData.current = null;\n    }\n  }, [topicModal.isOpen, topicModal.data?.id]);\n\n  useEffect(() => {\n    if (taskModal.isOpen && taskModal.data) {\n      taskModalStableData.current = { ...taskModal.data };\n    } else if (!taskModal.isOpen) {\n      taskModalStableData.current = null;\n    }\n  }, [taskModal.isOpen, taskModal.data?.id]);\n\nconst handleDeleteNode = useCallback((fullNodeId) => {\n  // fullNodeId is always in the format `${nodeType}-${id}`\n  console.log(`Deleting node with full ID:`, fullNodeId);\n\n  // Extract nodeType and id from fullNodeId\n  const [nodeType, ...idParts] = fullNodeId.split('-');\n  const nodeId = idParts.join('-');\n  const collectionKey = nodeType === 'literature' ? 'literature' : `${nodeType}s`;\n\n  setMindMapData(prevData => {\n    // Remove the node from its collection\n    const updatedCollection = (prevData[collectionKey] || []).filter(item => String(item.id) !== nodeId);\n    // Remove any connections that are attached to the deleted node\n    const updatedConnections = (prevData.connections || []).filter(\n      conn => conn.source !== fullNodeId && conn.target !== fullNodeId\n    );\n    const newData = {\n      ...prevData,\n      [collectionKey]: updatedCollection,\n      connections: updatedConnections,\n    };\n    autoSaveMindMapData(newData);\n    addToast(`${nodeType.charAt(0).toUpperCase() + nodeType.slice(1)} deleted.`, 'success');\n    return newData;\n  });\n  // Remove the node from the visual state\n  setNodes((nds) => nds.filter((node) => node.id !== fullNodeId));\n  // Remove edges referencing this node\n  setEdges((eds) => eds.filter((edge) => edge.source !== fullNodeId && edge.target !== fullNodeId));\n}, [setMindMapData, autoSaveMindMapData, addToast, setNodes, setEdges]);\n\n// Handle literature node click to open modal\nconst handleLiteratureClick = useCallback((literatureData) => {\n  setIsAnimating(true); // Set animation state\n  setLiteratureModal({ isOpen: true, data: literatureData });\n  // Clear animation state after modal animation completes\n  setTimeout(() => setIsAnimating(false), 700); // 600ms modal animation + 100ms buffer\n}, []);\n\n// Auto-sync node titles with modal form data\nconst syncNodeTitles = useCallback(() => {\n  setNodes(currentNodes => {\n    return currentNodes.map(node => {\n      const nodeType = node.id.split('-')[0];\n      const nodeId = node.id.split('-')[1];\n      \n      let newLabel = node.data.label;\n      \n      // Find the corresponding data item and sync title\n      if (nodeType === 'case') {\n        const caseData = mindMapData.cases?.find(c => c.id === nodeId);\n        if (caseData) {\n          newLabel = caseData.primaryDiagnosis || caseData.primary_diagnosis || caseData.title || 'Untitled Case';\n        }\n      } else if (nodeType === 'topic') {\n        const topicData = mindMapData.topics?.find(t => t.id === nodeId);\n        if (topicData) {\n          newLabel = topicData.title || 'Untitled Topic';\n        }\n      } else if (nodeType === 'task') {\n        const taskData = mindMapData.tasks?.find(t => t.id === nodeId);\n        if (taskData) {\n          newLabel = taskData.title || 'Untitled Task';\n        }\n      } else if (nodeType === 'literature') {\n        const literatureData = mindMapData.literature?.find(l => l.id === nodeId);\n        if (literatureData) {\n          newLabel = literatureData.title || 'Untitled Literature';\n        }\n      }\n      \n      // Only update if the label actually changed\n      if (newLabel !== node.data.label) {\n        return {\n          ...node,\n          data: {\n            ...node.data,\n            label: newLabel\n          }\n        };\n      }\n      \n      return node;\n    });\n  });\n}, [mindMapData, setNodes]);\n\n// Trigger auto-sync when mindMapData changes\nuseEffect(() => {\n  const hasData = mindMapData && (mindMapData.cases?.length > 0 || mindMapData.topics?.length > 0 || \n                                 mindMapData.tasks?.length > 0 || mindMapData.literature?.length > 0);\n  \n  if (hasData) {\n    syncNodeTitles();\n    \n    // If we don't have nodes but we have data, convert data to React Flow\n    if (nodes.length === 0) {\n      console.log('Converting data to React Flow nodes due to data change');\n      // Use a timeout to avoid dependency issues and ensure state is stable\n      setTimeout(() => {\n        convertDataToReactFlow(mindMapData, false); // CHANGED: Don't apply force layout automatically\n      }, 100);\n    }\n  }\n}, [mindMapData, syncNodeTitles, nodes.length]); // Removed convertDataToReactFlow from dependencies\n\n  const convertDataToReactFlow = useCallback(async (data, applyLayoutImmediately = false) => {\n    // Use optimized quick layout for initial load\n    const allItems = [\n      ...data.topics.map(item => ({ ...item, type: 'topic' })),\n      ...data.cases.map(item => ({ ...item, type: 'case' })),\n      ...data.tasks.map(item => ({ ...item, type: 'task' })),\n      ...data.literature.map(item => ({ ...item, type: 'literature' }))\n    ];\n\n    // If we have data and need immediate layout, apply force layout to positions\n    let layoutNodes;\n    \n    // Check if nodes already have positions - if they do, don't override with force layout\n    const hasExistingPositions = allItems.some(item => \n      item.position && typeof item.position.x === 'number' && typeof item.position.y === 'number'\n    );\n    \n    if (allItems.length > 0 && applyLayoutImmediately && !hasExistingPositions) {\n      try {\n        // Lazy load D3 force simulation for initial positioning\n        const { \n          forceSimulation, \n          forceManyBody, \n          forceLink, \n          forceCenter, \n          forceCollide \n        } = await loadD3Force();\n\n        // Create nodes for simulation\n        const simulationNodes = allItems.map((item, index) => ({\n          id: `${item.type}-${item.id}`,\n          x: item.position?.x || (Math.random() - 0.5) * 200,\n          y: item.position?.y || (Math.random() - 0.5) * 200,\n          type: item.type\n        }));\n\n        // Create D3-compatible edge objects\n        const d3Edges = (data.connections || []).map(edge => ({\n          source: edge.source,\n          target: edge.target,\n          id: edge.id\n        })).filter(edge => {\n          const nodeIds = new Set(simulationNodes.map(n => n.id));\n          return nodeIds.has(edge.source) && nodeIds.has(edge.target);\n        });\n\n        // Run simulation synchronously for initial layout\n        const simulation = forceSimulation(simulationNodes)\n          .force('link', forceLink(d3Edges).id(d => d.id).distance(200).strength(0.5))\n          .force('charge', forceManyBody().strength(-800).distanceMax(400))\n          .force('center', forceCenter(window.innerWidth / 3, window.innerHeight / 2))\n          .force('collision', forceCollide().radius(80))\n          .stop();\n\n        // Run enough ticks to get a good layout\n        for (let i = 0; i < 300; i++) {\n          simulation.tick();\n        }\n\n        // Create a map of positioned nodes\n        const positionMap = new Map();\n        simulationNodes.forEach(node => {\n          positionMap.set(node.id, { x: node.x, y: node.y });\n        });\n\n        layoutNodes = allItems.map(item => {\n          const nodeId = `${item.type}-${item.id}`;\n          const position = positionMap.get(nodeId) || { x: 0, y: 0 };\n          return { ...item, position };\n        });\n      } catch (error) {\n        console.warn('Failed to apply initial layout, using fallback positioning:', error);\n        layoutNodes = allItems;\n      }\n    } else {\n      layoutNodes = allItems;\n    }\n\n    // Quick layout without expensive calculations - ensure all nodes get proper positions\n    const quickNodes = (layoutNodes || allItems).map((item, index) => {\n      const nodeId = `${item.type}-${item.id}`;\n      \n      // Convert case fields efficiently\n      const nodeData = item.type === 'case' ? {\n        ...item,\n        chiefComplaint: item.chiefComplaint || item.chief_complaint || '',\n        initialPresentation: item.initialPresentation || item.initial_presentation || '',\n        currentPresentation: item.currentPresentation || item.current_presentation || '',\n        medicationHistory: item.medicationHistory || item.medication_history || '',\n        therapyProgress: item.therapyProgress || item.therapy_progress || '',\n        defensePatterns: item.defensePatterns || item.defense_patterns || '',\n        clinicalReflection: item.clinicalReflection || item.clinical_reflection || ''\n      } : item;\n\n      // Ensure proper positioning: use existing position, or create grid-based position\n      let position;\n      if (item.position && typeof item.position.x === 'number' && typeof item.position.y === 'number') {\n        position = item.position;\n      } else {\n        // Create grid-based layout for nodes without positions\n        const gridSize = Math.ceil(Math.sqrt(allItems.length));\n        const nodeSpacing = 250;\n        const offsetX = 300; // Offset from left sidebar\n        const offsetY = 150; // Offset from top\n        \n        position = {\n          x: (index % gridSize) * nodeSpacing + offsetX,\n          y: Math.floor(index / gridSize) * nodeSpacing + offsetY\n        };\n      }\n\n      return {\n        id: nodeId,\n        type: item.type,\n        position: position,\n        data: { \n          ...nodeData, \n          onDelete: () => handleDeleteNode(nodeId),\n          onLiteratureClick: item.type === 'literature' ? handleLiteratureClick : undefined,\n          skipAnimation: isInitialLoad // Use the isInitialLoad state\n        },\n      };\n    });\n\n    // Create optimized edges\n    const optimizedEdges = createOptimizedEdges(\n      data.connections || [], \n      quickNodes.map(n => n.id)\n    );\n\n    // Set nodes and edges immediately for fast UI response\n    setNodes(quickNodes);\n    setEdges(optimizedEdges);\n  }, [setNodes, setEdges, handleDeleteNode, handleLiteratureClick, isInitialLoad]);\n\n  const saveToBackend = useCallback(async (data) => {\n    // Deep clone the data to avoid modifying the original\n    const cleanData = {\n      topics: JSON.parse(JSON.stringify(data.topics || [])),\n      cases: JSON.parse(JSON.stringify(data.cases || [])),\n      tasks: JSON.parse(JSON.stringify(data.tasks || [])),\n      literature: JSON.parse(JSON.stringify(data.literature || [])),\n      connections: JSON.parse(JSON.stringify(data.connections || []))\n    };\n    \n    try {\n      \n      // Current timestamp for created_at/updated_at fields\n      const now = new Date().toISOString();\n      \n      // Clean and validate topics\n      cleanData.topics = cleanData.topics.map((topic, index) => {\n        // Ensure all required fields exist\n        return {\n          id: String(topic.id || `${Date.now()}-${index}-topic`),\n          title: topic.title || \"Untitled Topic\",\n          description: topic.description || \"\",\n          category: topic.category || \"Uncategorized\",\n          color: topic.color || \"#3B82F6\",\n          position: {\n            x: Number(topic.position?.x) || 0,\n            y: Number(topic.position?.y) || 0\n          },\n          flashcard_count: Number(topic.flashcard_count) || 0,\n          completed_flashcards: Number(topic.completed_flashcards) || 0,\n          resources: Array.isArray(topic.resources) ? topic.resources : [],\n          created_at: topic.created_at || now,\n          updated_at: now\n        };\n      });\n      \n      // Clean and validate cases\n      cleanData.cases = cleanData.cases.map((caseItem, index) => {\n        // Ensure all required fields exist, handle both camelCase and snake_case\n        return {\n          id: String(caseItem.id || `${Date.now()}-${index}-case`),\n          case_id: caseItem.case_id || `CASE-${Date.now()}-${index}`,\n          encounter_date: caseItem.encounter_date || now,\n          primary_diagnosis: caseItem.primary_diagnosis || \"Unspecified\",\n          secondary_diagnoses: Array.isArray(caseItem.secondary_diagnoses) ? caseItem.secondary_diagnoses : [],\n          age: caseItem.age !== undefined ? Number(caseItem.age) : null,\n          gender: caseItem.gender || null,\n          // Handle both camelCase (frontend) and snake_case (backend) field names\n          chief_complaint: caseItem.chiefComplaint || caseItem.chief_complaint || \"\",\n          initial_presentation: caseItem.initialPresentation || caseItem.initial_presentation || \"\",\n          current_presentation: caseItem.currentPresentation || caseItem.current_presentation || \"\",\n          medication_history: caseItem.medicationHistory || caseItem.medication_history || \"\",\n          therapy_progress: caseItem.therapyProgress || caseItem.therapy_progress || \"\",\n          defense_patterns: caseItem.defensePatterns || caseItem.defense_patterns || \"\",\n          clinical_reflection: caseItem.clinicalReflection || caseItem.clinical_reflection || \"\",\n          history_present_illness: caseItem.history_present_illness || null,\n          medical_history: caseItem.medical_history || null,\n          medications: Array.isArray(caseItem.medications) ? caseItem.medications : [],\n          mental_status_exam: caseItem.mental_status_exam || null,\n          assessment_plan: caseItem.assessment_plan || null,\n          notes: caseItem.notes || null,\n          status: caseItem.status || \"active\",\n          linked_topics: Array.isArray(caseItem.linked_topics) ? caseItem.linked_topics : [],\n          position: {\n            x: Number(caseItem.position?.x) || 0,\n            y: Number(caseItem.position?.y) || 0\n          },\n          created_at: caseItem.created_at || now,\n          updated_at: now\n        };\n      });\n      \n      // Clean and validate tasks\n      cleanData.tasks = cleanData.tasks.map((task, index) => {\n        // Ensure all required fields exist\n        return {\n          id: String(task.id || `${Date.now()}-${index}-task`),\n          title: task.title || \"Untitled Task\",\n          description: task.description || null,\n          status: task.status || \"pending\",\n          priority: task.priority || \"medium\",\n          due_date: task.due_date || null,\n          linked_case_id: task.linked_case_id || null,\n          linked_topic_id: task.linked_topic_id || null,\n          position: {\n            x: Number(task.position?.x) || 0,\n            y: Number(task.position?.y) || 0\n          },\n          created_at: task.created_at || now,\n          updated_at: now\n        };\n      });\n      \n      // Clean and validate literature\n      cleanData.literature = cleanData.literature.map((lit, index) => {\n        // Ensure all required fields exist\n        return {\n          id: String(lit.id || `${Date.now()}-${index}-lit`),\n          title: lit.title || \"Untitled Literature\",\n          authors: lit.authors || null,\n          publication: lit.publication || null,\n          year: lit.year !== undefined ? Number(lit.year) : null,\n          doi: lit.doi || null,\n          abstract: lit.abstract || null,\n          notes: lit.notes || null,\n          pdf_path: lit.pdf_path || null,\n          linked_topics: Array.isArray(lit.linked_topics) ? lit.linked_topics : [],\n          position: {\n            x: Number(lit.position?.x) || 0,\n            y: Number(lit.position?.y) || 0\n          },\n          created_at: lit.created_at || now,\n          updated_at: now\n        };\n      });\n      \n      // Clean and validate connections\n      cleanData.connections = cleanData.connections.map((conn, index) => {\n        // For connections, we only need these basic properties\n        return {\n          id: String(conn.id || `${Date.now()}-${index}-conn`),\n          source: conn.source || \"\",\n          target: conn.target || \"\",\n          label: conn.label || \"\"\n        };\n      });\n      \n      // Filter out any items with empty or invalid source/target\n      cleanData.connections = cleanData.connections.filter(conn => \n        conn.source && conn.target && \n        typeof conn.source === 'string' && \n        typeof conn.target === 'string' && \n        conn.source.length > 0 && \n        conn.target.length > 0\n      );\n      \n      console.log('Sending cleaned data to backend:', cleanData);\n      \n      const response = await axios.put(`${API}/mindmap-data`, cleanData, {\n        headers: { 'Content-Type': 'application/json' }\n      });\n      \n      console.log('Backend save successful:', response.data);\n    } catch (err) {\n      console.error('Failed to save to backend:', err.response?.data || err.message);\n      \n      // Log detailed validation errors\n      if (err.response?.status === 422 && err.response?.data?.detail) {\n        console.error('Validation errors:');\n        console.error(JSON.stringify(err.response.data.detail, null, 2));\n        \n        // Log the request data that caused the error\n        console.error('Request data that caused validation error:');\n        console.error(JSON.stringify(cleanData, null, 2));\n      }\n      \n      // Don't throw the error to prevent breaking the app\n    }\n  }, []);\n\n  const onConnect = useCallback((params) => {\n    const edgeId = `conn-${Date.now()}`;\n    const newEdge = { \n      ...params, \n      id: edgeId,\n      type: 'floating', // Use our high-performance floating edge type\n      style: { \n        strokeWidth: 2, \n        stroke: '#64748b',\n        opacity: 0.85,\n        transition: 'none' // Critical: disable transitions for immediate updates\n      },\n      // Add a unique timestamp to force React to re-render this edge when source or target nodes move\n      data: { __forceUpdate: Date.now() },\n      interactionWidth: 20 // Wider area for interaction\n    };\n    setEdges((eds) => addEdge(newEdge, eds));\n    setMindMapData(prev => {\n      const newConnections = [...prev.connections, { \n        id: newEdge.id, \n        source: params.source, \n        target: params.target, \n        label: '' \n      }];\n      const newData = { ...prev, connections: newConnections };\n      autoSaveMindMapData(newData);\n      return newData;\n    });\n  }, [setEdges, setMindMapData, autoSaveMindMapData]);\n\n  const onNodeClick = useCallback((event, node) => {\n    setSelectedNode(node);\n    // Visual feedback - highlight selected node\n    setNodes(currentNodes => currentNodes.map(n => ({\n      ...n,\n      selected: n.id === node.id\n    })));\n  }, [setNodes]);\n\n  const onNodeDoubleClick = useCallback((event, node) => {\n    const [type, id] = node.id.split('-');\n    \n    // Prevent multiple rapid clicks by checking if modal is already open\n    if (type === 'case' && caseModal.isOpen) return;\n    if (type === 'topic' && topicModal.isOpen) return;\n    if (type === 'task' && taskModal.isOpen) return;\n    if (type === 'literature' && literatureModal.isOpen) return;\n    \n    // Route to appropriate specialized modal based on node type\n    if (type === 'literature') {\n      const dataItem = mindMapData.literature.find(item => String(item.id) === id);\n      if (dataItem) {\n        setLiteratureModal({ isOpen: true, data: dataItem });\n      }\n      return;\n    }\n    \n    if (type === 'case') {\n      const dataItem = mindMapData.cases.find(item => String(item.id) === id);\n      if (dataItem) {\n        setModalAnimationStates(prev => ({ ...prev, case: true }));\n        setCaseModal({ isOpen: true, data: dataItem });\n        // Clear animation state after modal animation completes\n        setTimeout(() => {\n          setModalAnimationStates(prev => ({ ...prev, case: false }));\n        }, 800);\n      }\n      return;\n    }\n    \n    if (type === 'topic') {\n      const dataItem = mindMapData.topics.find(item => String(item.id) === id);\n      if (dataItem) {\n        setModalAnimationStates(prev => ({ ...prev, topic: true }));\n        setTopicModal({ isOpen: true, data: dataItem });\n        // Clear animation state after modal animation completes\n        setTimeout(() => {\n          setModalAnimationStates(prev => ({ ...prev, topic: false }));\n        }, 800);\n      }\n      return;\n    }\n    \n    if (type === 'task') {\n      const dataItem = mindMapData.tasks.find(item => String(item.id) === id);\n      if (dataItem) {\n        setModalAnimationStates(prev => ({ ...prev, task: true }));\n        setTaskModal({ isOpen: true, data: dataItem });\n        // Clear animation state after modal animation completes\n        setTimeout(() => {\n          setModalAnimationStates(prev => ({ ...prev, task: false }));\n        }, 800);\n      }\n      return;\n    }\n  }, [mindMapData, caseModal.isOpen, topicModal.isOpen, taskModal.isOpen, literatureModal.isOpen]);\n\n  const onEdgeDoubleClick = useCallback((event, edge) => {\n    // Double-click to delete edge immediately\n    setEdges(eds => eds.filter(e => e.id !== edge.id));\n    setMindMapData(prev => {\n      const newConnections = prev.connections.filter(conn => conn.id !== edge.id);\n      const newData = { ...prev, connections: newConnections };\n      autoSaveMindMapData(newData);\n      addToast('Connection deleted', 'success');\n      return newData;\n    });\n  }, [setEdges, setMindMapData, autoSaveMindMapData, addToast]);\n\n  const onEdgeContextMenu = useCallback((event, edge) => {\n    // Right-click to edit edge label\n    event.preventDefault();\n    setEdgeModal({ isOpen: true, edge: edge });\n  }, []);\n\n  const handleSaveEdgeLabel = useCallback((edgeId, label) => {\n    setEdges(eds =>\n      eds.map(edge =>\n        edge.id === edgeId ? { ...edge, label: label } : edge\n      )\n    );\n    setMindMapData(prev => {\n      const newConnections = prev.connections.map(conn =>\n        conn.id === edgeId ? { ...conn, label: label } : conn\n      );\n      const newData = { ...prev, connections: newConnections };\n      autoSaveMindMapData(newData);\n      return newData;\n    });\n  }, [setEdges, setMindMapData, autoSaveMindMapData]);\n\n  // Edge hover handlers for highlighting\n  const onEdgeMouseEnter = useCallback((event, edge) => {\n    setEdges(eds =>\n      eds.map(e =>\n        e.id === edge.id ? { ...e, className: 'highlighted' } : e\n      )\n    );\n  }, [setEdges]);\n\n  const onEdgeMouseLeave = useCallback((event, edge) => {\n    setEdges(eds =>\n      eds.map(e =>\n        e.id === edge.id ? { ...e, className: '' } : e\n      )\n    );\n  }, [setEdges]);\n\n  // Lazy-loaded force-directed layout for better performance\n  const forceLayout = useCallback(async () => {\n    if (nodes.length === 0) return;\n\n    try {\n      // Lazy load D3 force simulation\n      const { \n        forceSimulation, \n        forceManyBody, \n        forceLink, \n        forceCenter, \n        forceCollide \n      } = await loadD3Force();\n\n      // Preserve the current edges before layout\n      const currentEdges = [...edges];\n      \n      // Create a set of valid node IDs for fast lookup\n      const nodeIdSet = new Set(nodes.map(node => node.id));\n      \n      // Filter edges to only include those with both source and target nodes present\n      const validEdges = currentEdges.filter(edge => \n        nodeIdSet.has(edge.source) && nodeIdSet.has(edge.target)\n      );\n\n      // Create D3-compatible edge objects for the force simulation\n      const d3Edges = validEdges.map(edge => ({\n        source: edge.source,\n        target: edge.target,\n        id: edge.id\n      }));\n\n      // Create a copy of nodes for simulation (D3 mutates the objects)\n      const simulationNodes = nodes.map(node => ({ \n        id: node.id,\n        x: node.position.x, \n        y: node.position.y,\n        fx: null, // Remove any fixed positions\n        fy: null\n      }));\n\n      // Create simulation with optimized forces for mind map layout\n      const simulation = forceSimulation(simulationNodes)\n        .force('link', forceLink(d3Edges).id(d => d.id).distance(200).strength(0.5))\n        .force('charge', forceManyBody().strength(-800).distanceMax(400))\n        .force('center', forceCenter(window.innerWidth / 3, window.innerHeight / 2))\n        .force('collision', forceCollide().radius(80))\n        .stop();\n\n      // Run simulation in chunks to prevent blocking\n      const ticksPerFrame = 50;\n      const totalTicks = 400;\n      let currentTick = 0;\n\n      const runSimulationChunk = () => {\n        const remainingTicks = Math.min(ticksPerFrame, totalTicks - currentTick);\n        for (let i = 0; i < remainingTicks; i++) {\n          simulation.tick();\n        }\n        currentTick += remainingTicks;\n\n        if (currentTick < totalTicks) {\n          requestAnimationFrame(runSimulationChunk);\n        } else {\n          // Simulation complete, update nodes\n          const updatedNodes = simulationNodes.map(simNode => {\n            const originalNode = nodes.find(n => n.id === simNode.id);\n            return {\n              ...originalNode,\n              position: { x: simNode.x, y: simNode.y },\n            };\n          });\n          \n          // Update both nodes and edges in a single batch\n          setNodes(updatedNodes);\n          setEdges(validEdges);\n\n          // Update mindMapData with new positions\n          setMindMapData(currentData => {\n            const updatedData = { ...currentData };\n            \n            updatedNodes.forEach(node => {\n              const [type, id] = node.id.split('-');\n              const key = type === 'literature' ? 'literature' : `${type}s`;\n              const item = updatedData[key]?.find(i => String(i.id) === id);\n              if (item) {\n                item.position = node.position;\n              }\n            });\n            \n            return updatedData;\n          });\n\n          // Smooth camera transition to fit the new layout\n          setTimeout(() => {\n            fitView({ duration: 800, padding: 0.2 });\n          }, 200);\n        }\n      };\n\n      // Start simulation in next frame\n      requestAnimationFrame(runSimulationChunk);\n    } catch (error) {\n      console.error('Force layout failed:', error);\n      addToast('Layout calculation failed', 'error');\n    }\n  }, [nodes, edges, setNodes, setEdges, setMindMapData, fitView, addToast]);\n\n  // applyForceLayout wrapper function (defined after forceLayout)\n  const applyForceLayout = useCallback(() => {\n    try {\n      forceLayout();\n      addToast('Nodes realigned successfully', 'success');\n    } catch (error) {\n      console.error('Force layout error:', error);\n      addToast('Failed to realign nodes', 'error');\n    }\n  }, [forceLayout, addToast]);\n\n  const handleClearMap = useCallback(() => {\n    if (!window.confirm('Are you sure you want to clear the entire mind map?')) return;\n\n    const empty = { topics: [], cases: [], tasks: [], literature: [], connections: [] };\n    setMindMapData(empty);\n    setNodes([]);\n    setEdges([]);\n    setSelectedNode(null);\n    // Clear all modal states\n    setCaseModal({ isOpen: false, data: null });\n    setTopicModal({ isOpen: false, data: null });\n    setTaskModal({ isOpen: false, data: null });\n    setLiteratureModal({ isOpen: false, data: null });\n    setFocusedCategory(null);\n    autoSaveMindMapData(empty);\n    addToast('Mind map cleared successfully', 'success');\n  }, [setNodes, setEdges, autoSaveMindMapData, addToast]);\n\n  const handleNodesChange = useCallback((changes) => {\n    // Apply the node changes to React Flow state immediately - this is critical!\n    onNodesChange(changes);\n    \n    // Skip heavy operations during animations to prevent interference\n    if (isAnimating) {\n      console.log('Skipping position updates during animation');\n      return;\n    }\n\n    // Check for node removals and update nodeVisibility state\n    const removedNodes = changes.filter(change => change.type === 'remove');\n    if (removedNodes.length > 0) {\n      setNodeVisibility(prevVisibility => {\n        const newVisibility = { ...prevVisibility };\n        removedNodes.forEach(change => {\n          delete newVisibility[change.id];\n        });\n        return newVisibility;\n      });\n    }\n    \n    // Process position changes for data persistence - SIMPLIFIED\n    const positionChanges = changes.filter(change => \n      change.type === 'position' && change.position\n    );\n    \n    if (positionChanges.length > 0) {\n      console.log('Processing position changes:', positionChanges);\n      \n      // Update mindMapData immediately without complex debouncing\n      setMindMapData(currentData => {\n        const updatedData = { ...currentData };\n        \n        positionChanges.forEach(change => {\n          if (change.position) {\n            const [type, id] = change.id.split('-');\n            const key = type === 'literature' ? 'literature' : `${type}s`;\n            const item = updatedData[key]?.find(i => String(i.id) === id);\n            \n            if (item) {\n              item.position = { ...change.position };\n              console.log(`Updated ${type} ${id} position to:`, change.position);\n            }\n          }\n        });\n        \n        // Save to localStorage immediately\n        localStorageUtils.save(updatedData, null, null, false);\n        \n        return updatedData;\n      });\n      \n      // Simple auto-save without complex timeouts\n      setTimeout(() => {\n        autoSaveMindMapData(mindMapData);\n      }, 500);\n    }\n  }, [onNodesChange, setMindMapData, isAnimating, setNodeVisibility, autoSaveMindMapData, mindMapData]);\n\n  const handleNodeDragStop = useCallback((event, node) => {\n    // Debounce the auto-save to prevent excessive backend calls\n    // Position updates are already handled in handleNodesChange during dragging\n    clearTimeout(window.dragSaveTimeout);\n    window.dragSaveTimeout = setTimeout(() => {\n      setMindMapData(currentData => {\n        autoSaveMindMapData(currentData);\n        return currentData;\n      });\n    }, 500);\n  }, [autoSaveMindMapData]);\n\n  const loadMindMapData = useCallback(async () => {\n    setLoading(true);\n    setLoadingProgress(10);\n    setLoadingMessage('Checking local data...');\n    \n    try {\n      // First, try loading from localStorage for instant startup\n      const local = localStorageUtils.load();\n      if (local) {\n        setLoadingProgress(30);\n        setLoadingMessage('Loading from cache...');\n        \n        if (!local.connections) local.connections = [];\n        setMindMapData(local);\n        \n        setLoadingProgress(60);\n        setLoadingMessage('Applying layout...');\n        \n        await convertDataToReactFlow(local, true); // Apply layout immediately\n        \n        setLoadingProgress(90);\n        setLoadingMessage('Finalizing...');\n        \n        setLoading(false);\n        setIsInitialLoad(false);\n        setLoadingProgress(100);\n        \n        // Background sync with backend without blocking UI\n        setTimeout(async () => {\n          try {\n            const response = await axios.get(`${API}/mindmap-data`);\n            if (JSON.stringify(response.data) !== JSON.stringify(local)) {\n              // Only update if data has changed\n              if (!response.data.connections) response.data.connections = [];\n              setMindMapData(response.data);\n              await convertDataToReactFlow(response.data);\n              autoSaveMindMapData(response.data);\n              addToast('Data synchronized with server', 'info');\n            }\n          } catch (err) {\n            console.warn('Background sync failed:', err);\n          }\n        }, 500);\n        \n        return;\n      }\n\n      // If no local data, load from backend\n      setLoadingProgress(20);\n      setLoadingMessage('Loading from server...');\n      \n      try {\n        const response = await axios.get(`${API}/mindmap-data`);\n        if (!response.data.connections) response.data.connections = [];\n        \n        setLoadingProgress(50);\n        setLoadingMessage('Processing data...');\n        \n        setMindMapData(response.data);\n        \n        setLoadingProgress(80);\n        setLoadingMessage('Applying layout...');\n        \n        await convertDataToReactFlow(response.data, true); // Apply layout immediately\n        autoSaveMindMapData(response.data);\n        \n        setLoadingProgress(100);\n        setLoading(false);\n        setIsInitialLoad(false);\n      } catch (backendError) {\n        console.warn('Backend loading failed, populating with sample data:', backendError);\n        \n        // If backend fails, populate with sample data for better UX\n        setLoadingProgress(60);\n        setLoadingMessage('Loading sample data...');\n        \n        // Populate sample data\n        const emptyData = { topics: [], cases: [], tasks: [], literature: [], connections: [] };\n        \n        setMindMapData(emptyData);\n        \n        // Populate sample data\n        setTimeout(() => {\n          populateSampleLiteratureData(setMindMapData, autoSaveMindMapData, addToast);\n        }, 100);\n        \n        setLoadingProgress(100);\n        setLoading(false);\n        setIsInitialLoad(false);\n      }\n    } catch (err) {\n      console.error('Error loading mind map:', err);\n      addToast('Failed to load mind map', 'error');\n      setLoading(false);\n      setIsInitialLoad(false);\n    }\n  }, [addToast, autoSaveMindMapData, convertDataToReactFlow]);\n\n  useEffect(() => {\n    // Load initial mind map data\n    loadMindMapData();\n    \n    // Load templates from a source (e.g., API or localStorage)\n    // For now, using mock data\n    setTemplates([\n      { id: 'template1', name: 'Schizophrenia Workup', nodeType: 'case', data: { primary_diagnosis: 'Schizophrenia', chief_complaint: 'Auditory hallucinations' } },\n      { id: 'template2', name: 'MDD Follow-up', nodeType: 'case', data: { primary_diagnosis: 'Major Depressive Disorder', status: 'follow_up' } },\n      { id: 'template3', name: 'CBT for Anxiety', nodeType: 'topic', data: { title: 'CBT for Anxiety', category: 'Anxiety Disorders' } }\n    ]);\n  }, []); // Run only once on mount\n\n  // Helper function to check if a node matches the search query\n  const nodeMatchesSearch = useCallback((node, query) => {\n    // Guard against null/undefined node\n    if (!node || !node.id || !node.data) return false;\n    \n    // Return early if no query\n    if (!query) return true;\n    \n    // Normalize and trim query\n    const searchTerm = query.toLowerCase().trim();\n    if (!searchTerm) return true;\n    \n    try {\n      // Safely extract node type and ID\n      const parts = node.id.split('-');\n      const nodeType = parts.length > 0 ? parts[0] : '';\n      const nodeId = parts.length > 1 ? parts[1] : '';\n      \n      // Start with no match\n      let hasMatch = false;\n      \n      // 1. Basic title/label matching - most common searches\n      if (!hasMatch && node.data.label) {\n        const label = node.data.label.toLowerCase();\n        hasMatch = label.includes(searchTerm);\n      }\n      \n      // 2. Node type matching\n      if (!hasMatch && nodeType) {\n        hasMatch = nodeType.includes(searchTerm);\n      }\n      \n      // 3. Case ID pattern matching for case nodes\n      if (!hasMatch && nodeType === 'case' && nodeId) {\n        hasMatch = (`case-${nodeId}`).toLowerCase().includes(searchTerm);\n      }\n      \n      // 4. Type-specific content matching\n      if (!hasMatch) {\n        if (nodeType === 'case') {\n          const diagnosis = (node.data.primary_diagnosis || node.data.primaryDiagnosis || '').toLowerCase();\n          hasMatch = diagnosis.includes(searchTerm);\n        } else if (nodeType === 'topic') {\n          const title = (node.data.title || '').toLowerCase();\n          hasMatch = title.includes(searchTerm);\n        } else if (nodeType === 'literature') {\n          const title = (node.data.title || '').toLowerCase();\n          const authors = (node.data.authors || '').toLowerCase();\n          hasMatch = title.includes(searchTerm) || authors.includes(searchTerm);\n        }\n      }\n      \n      // 5. Psychiatric category matching for all node types\n      if (!hasMatch && node.data.category) {\n        const category = node.data.category.toLowerCase();\n        hasMatch = category.includes(searchTerm);\n      }\n      \n      return hasMatch;\n    } catch (error) {\n      console.error('Error in nodeMatchesSearch for node:', node.id, error);\n      return false;\n    }\n  }, []);\n\n  // Reset search and filters\n  const clearSearch = useCallback(() => {\n    console.log(\"Clearing search and resetting visibility\");\n    \n    // First update the simpler states\n    setSearchQuery('');\n    setFocusedCategory(null);\n    \n    // Then reset node visibility (more complex operation)\n    if (nodes.length > 0) {\n      const resetVisibility = {};\n      \n      // Set all nodes to visible\n      for (let i = 0; i < nodes.length; i++) {\n        resetVisibility[nodes[i].id] = true;\n      }\n      \n      // Update ref first to avoid circular updates\n      visibilityRef.current = {...resetVisibility};\n      // Then update state\n      setNodeVisibility(resetVisibility);\n    }\n  }, [nodes]);\n\n  // Keyboard shortcuts\n  useEffect(() => {\n    const handleKeyDown = (event) => {\n      // Only trigger shortcuts when not typing in input fields\n      if (event.target.tagName === 'INPUT' || event.target.tagName === 'TEXTAREA') return;\n      \n      if (event.ctrlKey || event.metaKey) {\n        switch (event.key) {\n          case 'n':\n            event.preventDefault();\n            setShowNodeSelector(true);\n            break;\n          case 'e':\n            event.preventDefault();\n            setIsEditing(!isEditing);\n            break;\n          case 'r':\n            event.preventDefault();\n            applyForceLayout();\n            break;\n          case 'f':\n            event.preventDefault();\n            // Focus the search box\n            document.querySelector('input[type=\"text\"][placeholder*=\"Search\"]')?.focus();\n            break;\n          default:\n            break;\n        }\n      }\n      \n      if (event.key === 'Escape') {\n        setSelectedNode(null);\n        // Close all modals\n        setCaseModal({ isOpen: false, data: null });\n        setTopicModal({ isOpen: false, data: null });\n        setTaskModal({ isOpen: false, data: null });\n        setLiteratureModal({ isOpen: false, data: null });\n        setShowNodeSelector(false);\n        setIsTemplateManagerOpen(false);\n        \n        // Clear search if no modals are open\n        if (!caseModal.isOpen && !topicModal.isOpen && !taskModal.isOpen && \n            !literatureModal.isOpen && !showNodeSelector && !isTemplateManagerOpen) {\n          clearSearch();\n        }\n      }\n    };\n\n    window.addEventListener('keydown', handleKeyDown);\n    return () => window.removeEventListener('keydown', handleKeyDown);\n  }, [isEditing, applyForceLayout, clearSearch, caseModal, topicModal, taskModal, literatureModal, showNodeSelector, isTemplateManagerOpen]);\n\n  useEffect(() => {\n    // DISABLED automatic force layout to prevent overriding individual node positions\n    // Force layout should only be applied manually via \"Realign Nodes\" button\n    if (isReactFlowReady && !hasAppliedInitialLayout && nodes.length > 0) {\n      // Just mark as applied without applying force layout \n      setHasAppliedInitialLayout(true);\n    } else if (isInitialLoad && nodes.length > 0) {\n      // For initial load, just mark as applied since layout was already done in convertDataToReactFlow\n      setHasAppliedInitialLayout(true);\n    }\n  }, [isReactFlowReady, hasAppliedInitialLayout, nodes, isInitialLoad]); // Removed forceLayout from dependencies\n\n  // Simplified search and category filtering - no style interference\n  useEffect(() => {\n    if (nodes.length === 0) return;\n    \n    // Skip during animations to prevent interference\n    const anyModalAnimating = Object.values(modalAnimationStates).some(state => state);\n    if (isAnimating || anyModalAnimating) return;\n    \n    const newVisibility = {};\n    let visibleCount = 0;\n    \n    // Calculate visibility without competing with React Flow\n    nodes.forEach(node => {\n      let shouldShow = true;\n      \n      // Category filter\n      if (focusedCategory && !node.id.startsWith(focusedCategory)) {\n        shouldShow = false;\n      }\n      \n      // Search filter\n      if (shouldShow && searchQuery.trim()) {\n        shouldShow = nodeMatchesSearch(node, searchQuery);\n      }\n      \n      if (shouldShow) visibleCount++;\n      newVisibility[node.id] = shouldShow;\n    });\n    \n    // Update visibility state - no setTimeout needed\n    setNodeVisibility(newVisibility);\n    setSearchResultsCount(visibleCount);\n    \n    // Update ref for other components\n    visibilityRef.current = newVisibility;\n    \n  }, [focusedCategory, searchQuery, nodes, nodeMatchesSearch, isAnimating, modalAnimationStates]);\n  \n  // CSS-based search filtering - no direct style manipulation\n  useEffect(() => {\n    if (!isReactFlowReady) return;\n    \n    // Apply CSS classes instead of direct style manipulation\n    const styleSheet = document.getElementById('search-filter-styles') || document.createElement('style');\n    styleSheet.id = 'search-filter-styles';\n    \n    if (!document.getElementById('search-filter-styles')) {\n      document.head.appendChild(styleSheet);\n    }\n    \n    // Generate CSS for search filtering\n    let css = `\n      /* Default node styling */\n      .react-flow__node {\n        transition: opacity 0.3s ease, transform 0.3s ease, filter 0.3s ease !important;\n      }\n      \n      /* Search dimmed nodes */\n      .react-flow__node.search-dimmed {\n        opacity: 0.15 !important;\n        filter: grayscale(0.7) !important;\n        transform: scale(0.9) !important;\n      }\n      \n      /* Selected node highlighting */\n      .react-flow__node.search-selected {\n        box-shadow: 0 0 0 2px #10b981, 0 0 20px rgba(16, 185, 129, 0.6) !important;\n        z-index: 1000 !important;\n      }\n      \n      /* Ensure dragging still works */\n      .react-flow__node.search-dimmed {\n        pointer-events: auto !important;\n      }\n    `;\n    \n    styleSheet.textContent = css;\n    \n  }, [isReactFlowReady]);\n\n  // Apply CSS classes to nodes based on search and selection\n  useEffect(() => {\n    if (!isReactFlowReady) return;\n    \n    const currentVisibility = visibilityRef.current;\n    const currentSelectedId = selectedNode?.id;\n    \n    setNodes(prevNodes => {\n      return prevNodes.map(node => {\n        const isVisible = currentVisibility[node.id] !== false;\n        const isSelected = currentSelectedId === node.id;\n        \n        // Build className instead of modifying styles\n        let className = node.className || '';\n        \n        // Remove existing search classes\n        className = className.replace(/\\s*(search-dimmed|search-selected)\\s*/g, ' ').trim();\n        \n        // Add appropriate classes\n        if (!isVisible) {\n          className += ' search-dimmed';\n        }\n        if (isSelected) {\n          className += ' search-selected';\n        }\n        \n        // Only update if className changed\n        if (node.className !== className.trim()) {\n          return {\n            ...node,\n            className: className.trim(),\n            // Explicitly preserve position and other React Flow properties\n            position: node.position,\n            type: node.type,\n            data: node.data\n          };\n        }\n        \n        return node;\n      });\n    });\n  }, [selectedNode, nodeVisibility, isReactFlowReady]);\n\n  // Initialize nodeVisibility when nodes change\n  useEffect(() => {\n    // Skip if no nodes\n    if (nodes.length === 0) return;\n    \n    // Use a timeout to break potential render cycles\n    const updateVisibility = () => {\n      // Create stable references to avoid memory issues\n      const currentVisibility = {...visibilityRef.current};\n      const currentNodeIds = new Set(nodes.map(node => node.id));\n      const existingIds = new Set(Object.keys(currentVisibility));\n      \n      // Quick checks to avoid unnecessary work\n      const hasNewNodes = nodes.some(node => !existingIds.has(node.id));\n      const hasRemovedNodes = Array.from(existingIds).some(id => !currentNodeIds.has(id));\n      \n      // Only update if there are new nodes or removed nodes\n      if (hasNewNodes || hasRemovedNodes) {\n        console.log(\"Initializing node visibility - nodes added or removed\");\n        \n        // Create new visibility state with defaults\n        const initialVisibility = {};\n        \n        // Process each node\n        for (let i = 0; i < nodes.length; i++) {\n          const nodeId = nodes[i].id;\n          \n          // Determine visibility status (preserve existing or default to true)\n          initialVisibility[nodeId] = existingIds.has(nodeId) \n            ? currentVisibility[nodeId] \n            : true;\n        }\n        \n        // Update ref first to avoid circular updates\n        visibilityRef.current = {...initialVisibility};\n        \n        // Use another timeout to break the update cycle\n        setTimeout(() => {\n          setNodeVisibility(initialVisibility);\n        }, 0);\n      }\n    };\n    \n    const timeoutId = setTimeout(updateVisibility, 0);\n    return () => clearTimeout(timeoutId);\n  }, [nodes]); // Only depend on nodes changes\n\n  // Optionally: handle layout setup on first render if needed\n\n  // Show optimized loading screen during initial load\n  if (loading) {\n    return <OptimizedLoadingScreen message={loadingMessage} progress={loadingProgress} />;\n  }\n\n  // Sophisticated Animation Variants (matching Literature modal quality)\n  const modalVariants = {\n    hidden: {\n      opacity: 0,\n      scale: 0.3,\n      y: 50,\n      rotate: -5,\n    },\n    visible: {\n      opacity: 1,\n      scale: 1,\n      y: 0,\n      rotate: 0,\n      transition: {\n        type: \"spring\",\n        damping: 25,\n        stiffness: 300,\n        duration: 0.6,\n      }\n    },\n    exit: {\n      opacity: 0,\n      scale: 0.7,\n      y: 30,\n      rotate: -3,\n      transition: {\n        type: \"easeInOut\",\n        duration: 0.4,\n      }\n    }\n  };\n\n  const backdropVariants = {\n    hidden: { opacity: 0 },\n    visible: { \n      opacity: 1,\n      transition: { duration: 0.3 }\n    },\n    exit: { \n      opacity: 0,\n      transition: { duration: 0.4 }\n    }\n  };\n\n  const contentVariants = {\n    hidden: {\n      opacity: 0,\n      y: 20,\n      scale: 0.95,\n    },\n    visible: {\n      opacity: 1,\n      y: 0,\n      scale: 1,\n      transition: {\n        type: \"easeOut\",\n        duration: 0.3,\n        delay: 0.1,\n      }\n    },\n    exit: {\n      opacity: 0,\n      y: -10,\n      scale: 1.02,\n      transition: {\n        type: \"easeIn\",\n        duration: 0.2,\n      }\n    }\n  };\n\n  const buttonVariants = {\n    inactive: {\n      scale: 1,\n    },\n    active: {\n      scale: 1.05,\n      transition: {\n        type: \"spring\",\n        damping: 20,\n        stiffness: 300,\n      }\n    },\n    hover: {\n      scale: 1.03,\n      transition: {\n        type: \"easeOut\",\n        duration: 0.2,\n      }\n    }\n  };\n\n  // All modal components are now imported from separate files\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 flex\">\n      {/* --- Left Sidebar --- */}\n      <div className=\"w-80 bg-gradient-to-b from-slate-800 to-slate-900 text-white p-6 shadow-2xl flex flex-col\">\n        <div className=\"mb-8\">\n          <div className=\"text-3xl font-bold tracking-wide text-white\">PGY-3 HQ</div>\n          <div className=\"text-sm text-slate-300 mt-2\">Psychiatry Resident Dashboard</div>\n        </div>\n\n        {/* --- Enhanced Search --- */}\n        <div className=\"mb-6\">\n          <div className=\"relative\">\n            <Search size={18} className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400\" />\n            <input\n              type=\"text\"\n              placeholder=\"Search by title, diagnosis, case ID, category...\"\n              value={searchQuery}\n              onChange={(e) => setSearchQuery(e.target.value)}\n              onKeyDown={(e) => {\n                if (e.key === 'Escape') {\n                  clearSearch();\n                }\n              }}\n              className=\"w-full pl-10 pr-12 py-2 bg-slate-700 bg-opacity-50 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-teal-400 focus:border-teal-400 transition-all duration-200\"\n            />\n            {searchQuery && (\n              <button\n                onClick={clearSearch}\n                className=\"absolute right-3 top-1/2 transform -translate-y-1/2 text-slate-400 hover:text-white transition-colors\"\n                title=\"Clear search\"\n              >\n                <X size={16} />\n              </button>\n            )}\n          </div>\n          {searchQuery && (\n            <div className=\"mt-2 text-xs text-slate-400\">\n              <div className=\"space-y-1\">\n                <div className=\"flex items-center justify-between\">\n                  <span>✓ Searching: titles, diagnoses, case IDs, categories</span>\n                  <span className=\"bg-slate-600 px-2 py-1 rounded text-xs\">\n                    {searchResultsCount} {searchResultsCount === 1 ? 'result' : 'results'}\n                  </span>\n                </div>\n                <div>✓ Try: \"mood disorders\", \"case-123\", \"anxiety\", \"bipolar\"</div>\n                <div className=\"text-slate-500\">Press Esc to clear search</div>\n              </div>\n            </div>\n          )}\n          {!searchQuery && (\n            <div className=\"mt-2 space-y-2\">\n              <div className=\"text-xs text-slate-500\">\n                Search examples: \"depression\", \"CASE-101\", \"mood disorders\"\n              </div>\n              <div className=\"flex flex-wrap gap-1\">\n                {['depression', 'anxiety', 'bipolar', 'psychosis', 'mood disorders', 'case'].map((term) => (\n                  <button\n                    key={term}\n                    onClick={() => setSearchQuery(term)}\n                    className=\"px-2 py-1 bg-slate-700 hover:bg-slate-600 text-xs text-slate-300 rounded transition-colors\"\n                  >\n                    {term}\n                  </button>\n                ))}\n              </div>\n            </div>\n          )}\n        </div>\n\n        {/* --- Category Filters --- */}\n        <div className=\"mb-6\">\n          <h3 className=\"text-sm font-semibold text-slate-300 mb-3\">Filter by Category</h3>\n          <div className=\"grid grid-cols-2 gap-2\">\n            <button\n              onClick={() => setFocusedCategory(null)}\n              className={`px-3 py-2 rounded-lg text-xs transition-all ${\n                focusedCategory === null\n                  ? 'bg-teal-600 text-white'\n                  : 'bg-slate-700 text-slate-300 hover:bg-slate-600'\n              }`}\n            >\n              All\n            </button>\n            <button\n              onClick={() => setFocusedCategory('topic')}\n              className={`px-3 py-2 rounded-lg text-xs transition-all flex items-center gap-1 ${\n                focusedCategory === 'topic'\n                  ? 'bg-blue-600 text-white'\n                  : 'bg-slate-700 text-slate-300 hover:bg-slate-600'\n              }`}\n            >\n              <Brain size={12} />\n              Topics\n            </button>\n            <button\n              onClick={() => setFocusedCategory('case')}\n              className={`px-3 py-2 rounded-lg text-xs transition-all flex items-center gap-1 ${\n                focusedCategory === 'case'\n                  ? 'bg-indigo-600 text-white'\n                  : 'bg-slate-700 text-slate-300 hover:bg-slate-600'\n              }`}\n            >\n              <Users size={12} />\n              Cases\n            </button>\n            <button\n              onClick={() => setFocusedCategory('task')}\n              className={`px-3 py-2 rounded-lg text-xs transition-all flex items-center gap-1 ${\n                focusedCategory === 'task'\n                  ? 'bg-amber-600 text-white'\n                  : 'bg-slate-700 text-slate-300 hover:bg-slate-600'\n              }`}\n            >\n              <CheckSquare size={12} />\n              Tasks\n            </button>\n            <button\n              onClick={() => setFocusedCategory('literature')}\n              className={`px-3 py-2 rounded-lg text-xs transition-all flex items-center gap-1 ${\n                focusedCategory === 'literature'\n                  ? 'bg-purple-600 text-white'\n                  : 'bg-slate-700 text-slate-300 hover:bg-slate-600'\n              }`}\n            >\n              <BookOpen size={12} />\n              Literature\n            </button>\n          </div>\n        </div>\n\n        {/* --- Auto-save Status --- */}\n        <div className=\"mb-4 p-3 bg-slate-700 bg-opacity-50 rounded-lg\">\n          <div className=\"flex items-center gap-2 text-xs\">\n            {isSaving ? (\n              <>\n                <Loader2 size={12} className=\"animate-spin\" />\n                <span className=\"text-amber-300\">Saving...</span>\n              </>\n            ) : lastSaved ? (\n              <>\n                <CheckCircle size={12} className=\"text-green-400\" />\n                <span className=\"text-slate-300\">\n                  Last saved: {lastSaved.toLocaleTimeString()}\n                </span>\n              </>\n            ) : (\n              <>\n                <Cloud size={12} className=\"text-slate-400\" />\n                <span className=\"text-slate-400\">Auto-save enabled</span>\n              </>\n            )}\n          </div>\n        </div>\n\n        {/* --- Controls --- */}\n        <div className=\"space-y-3 mb-6\">\n          <LoadingButton onClick={applyForceLayout} icon={Shuffle} className=\"w-full bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-md text-sm\">\n            Realign Nodes\n          </LoadingButton>\n          <LoadingButton onClick={() => setIsTemplateManagerOpen(true)} icon={Bookmark} className=\"w-full bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-md text-sm\">\n            Manage Templates\n          </LoadingButton>\n          <LoadingButton \n            onClick={() => populateSampleLiteratureData(setMindMapData, autoSaveMindMapData, addToast)} \n            icon={BookOpen} \n            className=\"w-full bg-emerald-600 hover:bg-emerald-700 text-white px-4 py-2 rounded-md text-sm\"\n          >\n            Add Sample Literature\n          </LoadingButton>\n          <LoadingButton onClick={() => setIsEditing(!isEditing)} icon={isEditing ? Save : Edit3} className={`w-full px-4 py-2 rounded-md text-sm ${isEditing ? 'bg-teal-600' : 'bg-slate-600'}`}>\n            {isEditing ? 'Exit Edit Mode' : 'Edit Mind Map'}\n          </LoadingButton>\n          <LoadingButton onClick={() => setShowNodeSelector(true)} icon={Plus} className=\"w-full bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md text-sm\">\n            Add New Node\n          </LoadingButton>\n          <LoadingButton onClick={handleClearMap} icon={Trash2} className=\"w-full bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-md text-sm\">\n            Clear All Data\n          </LoadingButton>\n        </div>\n\n        {/* --- Selected Node Panel --- */}\n        {selectedNode && (\n          <div className=\"mt-auto p-4 bg-slate-700 bg-opacity-50 rounded-lg\">\n            <h3 className=\"text-sm font-semibold text-slate-300 mb-2\">Selected Node</h3>\n            <div className=\"space-y-2\">\n              <div className=\"flex items-center gap-2\">\n                {selectedNode.type === 'topic' && <Brain size={14} className=\"text-blue-400\" />}\n                {selectedNode.type === 'case' && <Users size={14} className=\"text-indigo-400\" />}\n                {selectedNode.type === 'task' && <CheckSquare size={14} className=\"text-amber-400\" />}\n                {selectedNode.type === 'literature' && <BookOpen size={14} className=\"text-purple-400\" />}\n                <span className=\"text-sm text-white font-medium truncate\">\n                  {selectedNode.data.label}\n                </span>\n              </div>\n              {selectedNode.data.category && (\n                <div className=\"text-xs text-slate-400\">\n                  Category: {selectedNode.data.category}\n                </div>\n              )}\n              {selectedNode.data.status && (\n                <div className=\"text-xs text-slate-400\">\n                  Status: {selectedNode.data.status}\n                </div>\n              )}\n              <button\n                onClick={() => {\n                  const [type, id] = selectedNode.id.split('-');\n                  const key = type === 'literature' ? 'literature' : `${type}s`;\n                  const dataItem = mindMapData[key].find(item => String(item.id) === id);\n                  if (dataItem) {\n                    // Route to appropriate specialized modal\n                    if (type === 'case') {\n                      setCaseModal({ isOpen: true, data: dataItem });\n                    } else if (type === 'topic') {\n                      setTopicModal({ isOpen: true, data: dataItem });\n                    } else if (type === 'task') {\n                      setTaskModal({ isOpen: true, data: dataItem });\n                    } else if (type === 'literature') {\n                      handleLiteratureClick(dataItem);\n                    }\n                  }\n                }}\n                className=\"w-full mt-2 px-3 py-2 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded-lg transition-colors flex items-center gap-2\"\n              >\n                <Eye size={12} />\n                View Details\n              </button>\n            </div>\n          </div>\n        )}\n\n        {/* --- Keyboard Shortcuts Help --- */}\n        {!selectedNode && (\n          <div className=\"mt-auto p-3 bg-slate-700 bg-opacity-30 rounded-lg\">\n            <h4 className=\"text-xs font-semibold text-slate-300 mb-2\">Keyboard Shortcuts</h4>\n            <div className=\"space-y-1 text-xs text-slate-400\">\n              <div>Ctrl+N - Add Node</div>\n              <div>Ctrl+E - Toggle Edit Mode</div>\n              <div>Ctrl+R - Realign Nodes</div>\n              <div>Esc - Clear Selection</div>\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* --- Main Mind Map Workspace --- */}\n      <div className=\"flex-1 relative\">\n        <ReactFlowErrorBoundary>\n          <ReactFlow\n            nodes={nodes}\n            edges={edges}\n            onNodesChange={handleNodesChange}\n            onEdgesChange={onEdgesChange}\n            onConnect={onConnect}\n            onNodeClick={onNodeClick}\n            onNodeDoubleClick={onNodeDoubleClick}\n            onNodeDragStop={handleNodeDragStop}\n            onEdgeDoubleClick={onEdgeDoubleClick}\n            onEdgeContextMenu={onEdgeContextMenu}\n            onEdgeMouseEnter={onEdgeMouseEnter}\n            onEdgeMouseLeave={onEdgeMouseLeave}\n            nodeTypes={nodeTypes}\n            edgeTypes={{ floating: FloatingEdge, enhanced: EnhancedEdge }}\n            nodesDraggable={true}\n            nodesConnectable={isEditing}\n            elementsSelectable={true}\n            onInit={(reactFlowInstance) => {\n              setIsReactFlowReady(true);\n              // Store reference for error recovery\n              window.reactFlowInstance = reactFlowInstance;\n            }}\n            onError={(id, message) => {\n              console.warn('React Flow Error:', id, message);\n              // Ignore dimension-related errors during animations\n              if (isAnimating && message.includes('dimensions')) {\n                return;\n              }\n            }}\n            fitView\n            snapToGrid={false}\n            snapGrid={[15, 15]}\n            elevateEdgesOnSelect={false}\n            connectionLineComponent={ConnectionLine}\n          connectionLineStyle={{\n            stroke: '#3b82f6', // Use a bright blue color for better visibility during connection\n            strokeWidth: 3.5, // Slightly thicker than regular edges\n            opacity: 0.9,\n            strokeLinecap: 'round',\n            strokeDasharray: '5,3', // Shorter dash pattern for more modern look\n            filter: 'drop-shadow(0 0 6px rgba(59, 130, 246, 0.6))', // Softer glow\n            animation: 'flowingDash 1s linear infinite' // Add flowing animation\n          }}\n          defaultEdgeOptions={{\n            type: 'enhanced', // Use our enhanced edge with proper prop handling\n            style: { \n              strokeWidth: 2.5, \n              stroke: '#64748b',\n              opacity: 0.9,\n              strokeLinecap: 'round',\n              transition: 'none'\n            }\n            // Remove pathOptions - this is not a standard React Flow prop\n          }}\n          className=\"bg-gradient-to-br from-blue-50 to-indigo-100\"\n        >\n          <Background color=\"#aaa\" gap={16} />\n          <Controls />\n          <MiniMap />\n        </ReactFlow>\n        </ReactFlowErrorBoundary>\n      </div>\n      \n      {/* --- Modals --- */}\n      {isTemplateManagerOpen && (\n        <TemplateManager\n          isOpen={isTemplateManagerOpen}\n          onClose={() => setIsTemplateManagerOpen(false)}\n          templates={templates}\n          setTemplates={setTemplates}\n        />\n      )}\n      \n      {/* Literature Modal */}\n      {literatureModal.isOpen && (\n        <LiteratureModal\n          isOpen={literatureModal.isOpen}\n          onClose={() => {\n            setIsAnimating(true); // Set animation state for closing\n            setLiteratureModal({ isOpen: false, data: null });\n            // Clear animation state after modal close animation completes\n            setTimeout(() => setIsAnimating(false), 500); // 400ms close animation + 100ms buffer\n          }}\n          onAnimationStart={() => setIsAnimating(true)}\n          onAnimationEnd={() => setIsAnimating(false)}\n          literatureData={literatureModal.data}\n          allNodes={nodes}\n          connections={mindMapData.connections || []}\n          setMindMapData={setMindMapData}\n          autoSaveMindMapData={autoSaveMindMapData}\n          addToast={addToast}\n        />\n      )}\n      {showNodeSelector && (\n        <NodeSelector\n          isOpen={showNodeSelector}\n          onClose={() => setShowNodeSelector(false)}\n          onSelect={(nodeType, templateId) => {\n            setShowNodeSelector(false);\n            const dataId = Date.now();\n            const id = `${nodeType}-${dataId}`;\n            \n            // Create node data object with appropriate fields based on type\n            let nodeData = { id: dataId, label: `New ${nodeType}` };\n            \n            // For case nodes, add structured fields\n            if (nodeType === 'case') {\n              nodeData = {\n                ...nodeData,\n                chiefComplaint: '',\n                initialPresentation: '',\n                currentPresentation: '',\n                medicationHistory: '',\n                therapyProgress: '',\n                defensePatterns: '',\n                clinicalReflection: ''\n              };\n            }\n            \n            // Calculate grid-based position for new nodes to avoid clustering\n            // Use current data count instead of nodes.length for more accurate positioning\n            const currentDataCount = (mindMapData.topics?.length || 0) + \n                                   (mindMapData.cases?.length || 0) + \n                                   (mindMapData.tasks?.length || 0) + \n                                   (mindMapData.literature?.length || 0);\n            \n            const gridSize = Math.ceil(Math.sqrt(currentDataCount + 1));\n            const nodeSpacing = 280;\n            const offsetX = 400; // Offset from left sidebar\n            const offsetY = 150; // Offset from top\n            \n            const gridPosition = {\n              x: (currentDataCount % gridSize) * nodeSpacing + offsetX,\n              y: Math.floor(currentDataCount / gridSize) * nodeSpacing + offsetY\n            };\n            \n            const newNode = {\n              id,\n              type: nodeType,\n              position: gridPosition,\n              data: { ...nodeData, onDelete: () => handleDeleteNode(id) }\n            };\n\n            setMindMapData(d => {\n              const key = nodeType === 'literature' ? 'literature' : `${nodeType}s`;\n              const dataToAdd = { ...newNode.data, position: newNode.position };\n              delete dataToAdd.onDelete;\n              const updatedData = {\n                ...d,\n                [key]: [...(d[key] || []), dataToAdd]\n              };\n              autoSaveMindMapData(updatedData);\n              return updatedData;\n            });\n\n            setNodes(n => n.concat(newNode));\n          }}\n          templates={templates}\n        />\n      )}\n\n      {/* Specialized Modals with optimized rendering */}\n      <AnimatePresence mode=\"wait\">\n        {caseModal.isOpen && (\n          <CaseModal \n            key={`case-modal-${caseModal.data?.id || 'default'}`}\n            isOpen={caseModal.isOpen} \n            data={caseModalStableData.current || caseModal.data} \n            onClose={() => {\n              setModalAnimationStates(prev => ({ ...prev, case: true }));\n              setCaseModal({ isOpen: false, data: null });\n            }}\n            onAnimationStart={() => {\n              setIsAnimating(true);\n              setModalAnimationStates(prev => ({ ...prev, case: true }));\n            }}\n            onAnimationEnd={() => {\n              setIsAnimating(false);\n              setModalAnimationStates(prev => ({ ...prev, case: false }));\n            }}\n            setMindMapData={setMindMapData}\n            autoSaveMindMapData={autoSaveMindMapData}\n            addToast={addToast}\n          />\n        )}\n      </AnimatePresence>\n      \n      <AnimatePresence mode=\"wait\">\n        {topicModal.isOpen && (\n          <TopicModal \n            key={`topic-modal-${topicModal.data?.id || 'default'}`}\n            isOpen={topicModal.isOpen} \n            data={topicModalStableData.current || topicModal.data} \n            onClose={() => {\n              setModalAnimationStates(prev => ({ ...prev, topic: true }));\n              setTopicModal({ isOpen: false, data: null });\n            }}\n            onAnimationStart={() => {\n              setIsAnimating(true);\n              setModalAnimationStates(prev => ({ ...prev, topic: true }));\n            }}\n            onAnimationEnd={() => {\n              setIsAnimating(false);\n              setModalAnimationStates(prev => ({ ...prev, topic: false }));\n            }}\n            setMindMapData={setMindMapData}\n            autoSaveMindMapData={autoSaveMindMapData}\n            addToast={addToast}\n          />\n        )}\n      </AnimatePresence>\n      \n      <AnimatePresence mode=\"wait\">\n        {taskModal.isOpen && (\n          <TaskModal \n            key={`task-modal-${taskModal.data?.id || 'default'}`}\n            isOpen={taskModal.isOpen} \n            data={taskModalStableData.current || taskModal.data} \n            onClose={() => {\n              setModalAnimationStates(prev => ({ ...prev, task: true }));\n              setTaskModal({ isOpen: false, data: null });\n            }}\n            onAnimationStart={() => {\n              setIsAnimating(true);\n              setModalAnimationStates(prev => ({ ...prev, task: true }));\n            }}\n            onAnimationEnd={() => {\n              setIsAnimating(false);\n              setModalAnimationStates(prev => ({ ...prev, task: false }));\n            }}\n            setMindMapData={setMindMapData}\n            autoSaveMindMapData={autoSaveMindMapData}\n            addToast={addToast}\n          />\n        )}\n      </AnimatePresence>\n\n      <EdgeLabelModal \n        isOpen={edgeModal.isOpen} \n        edge={edgeModal.edge} \n        onClose={() => setEdgeModal({ isOpen: false, edge: null })} \n        onSave={handleSaveEdgeLabel} \n      />\n\n      {loading && (\n        <div className=\"absolute inset-0 bg-white bg-opacity-80 flex items-center justify-center z-50\">\n          <Loader2 size={48} className=\"animate-spin text-blue-600\" />\n        </div>\n      )}\n      \n      {toasts.map(toast => (\n        <Toast\n          key={toast.id}\n          message={toast.message}\n          type={toast.type}\n          duration={toast.duration}\n          onClose={() => removeToast(toast.id)}\n        />\n      ))}\n    </div>\n  );\n};\n\n// Error Boundary for React Flow\nclass ReactFlowErrorBoundary extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { hasError: false };\n  }\n\n  static getDerivedStateFromError(error) {\n    // Check if it's a React Flow dimension error\n    if (error.message && error.message.includes('dimensions')) {\n      console.warn('React Flow dimension error caught, recovering...');\n      return { hasError: false }; // Don't show error, just recover\n    }\n    return { hasError: true };\n  }\n\n  componentDidCatch(error, errorInfo) {\n    if (error.message && error.message.includes('dimensions')) {\n      // For dimension errors, try to recover\n      setTimeout(() => {\n        if (window.reactFlowInstance) {\n          window.reactFlowInstance.fitView();\n        }\n      }, 100);\n      return;\n    }\n    console.error('React Flow Error:', error, errorInfo);\n  }\n\n  render() {\n    if (this.state.hasError) {\n      return (\n        <div className=\"flex-1 flex items-center justify-center\">\n          <div className=\"text-center\">\n            <h3 className=\"text-lg font-medium text-gray-900 mb-2\">Mind Map Temporarily Unavailable</h3>\n            <p className=\"text-gray-600 mb-4\">There was an issue with the mind map. Please refresh the page.</p>\n            <button \n              onClick={() => window.location.reload()} \n              className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700\"\n            >\n              Refresh Page\n            </button>\n          </div>\n        </div>\n      );\n    }\n\n    return this.props.children;\n  }\n}\n\nconst Dashboard = () => (\n  <ReactFlowProvider>\n    <DashboardComponent />\n  </ReactFlowProvider>\n);\n\nfunction App() {\n  return <Dashboard />;\n}\n\nexport default App;","import React from \"react\";\nimport ReactDOM from \"react-dom/client\";\nimport \"./index.css\";\nimport App from \"./App\";\n\nconst root = ReactDOM.createRoot(document.getElementById(\"root\"));\nroot.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n);\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","var getProto = Object.getPrototypeOf ? (obj) => (Object.getPrototypeOf(obj)) : (obj) => (obj.__proto__);\nvar leafPrototypes;\n// create a fake namespace object\n// mode & 1: value is a module id, require it\n// mode & 2: merge all properties of value into the ns\n// mode & 4: return value when already ns object\n// mode & 16: return value when it's Promise-like\n// mode & 8|1: behave like require\n__webpack_require__.t = function(value, mode) {\n\tif(mode & 1) value = this(value);\n\tif(mode & 8) return value;\n\tif(typeof value === 'object' && value) {\n\t\tif((mode & 4) && value.__esModule) return value;\n\t\tif((mode & 16) && typeof value.then === 'function') return value;\n\t}\n\tvar ns = Object.create(null);\n\t__webpack_require__.r(ns);\n\tvar def = {};\n\tleafPrototypes = leafPrototypes || [null, getProto({}), getProto([]), getProto(getProto)];\n\tfor(var current = mode & 2 && value; (typeof current == 'object' || typeof current == 'function') && !~leafPrototypes.indexOf(current); current = getProto(current)) {\n\t\tObject.getOwnPropertyNames(current).forEach((key) => (def[key] = () => (value[key])));\n\t}\n\tdef['default'] = () => (value);\n\t__webpack_require__.d(ns, def);\n\treturn ns;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = (chunkId) => {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce((promises, key) => {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"static/js/\" + chunkId + \".\" + {\"213\":\"c0413f75\",\"261\":\"de3004f3\",\"524\":\"c4c81a9f\"}[chunkId] + \".chunk.js\";\n};","// This function allow to reference async chunks\n__webpack_require__.miniCssF = (chunkId) => {\n\t// return url for filenames based on template\n\treturn undefined;\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","var inProgress = {};\nvar dataWebpackPrefix = \"frontend:\";\n// loadScript function to load a script via script tag\n__webpack_require__.l = (url, done, key, chunkId) => {\n\tif(inProgress[url]) { inProgress[url].push(done); return; }\n\tvar script, needAttach;\n\tif(key !== undefined) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tfor(var i = 0; i < scripts.length; i++) {\n\t\t\tvar s = scripts[i];\n\t\t\tif(s.getAttribute(\"src\") == url || s.getAttribute(\"data-webpack\") == dataWebpackPrefix + key) { script = s; break; }\n\t\t}\n\t}\n\tif(!script) {\n\t\tneedAttach = true;\n\t\tscript = document.createElement('script');\n\n\t\tscript.charset = 'utf-8';\n\t\tscript.timeout = 120;\n\t\tif (__webpack_require__.nc) {\n\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\t\tscript.setAttribute(\"data-webpack\", dataWebpackPrefix + key);\n\n\t\tscript.src = url;\n\t}\n\tinProgress[url] = [done];\n\tvar onScriptComplete = (prev, event) => {\n\t\t// avoid mem leaks in IE.\n\t\tscript.onerror = script.onload = null;\n\t\tclearTimeout(timeout);\n\t\tvar doneFns = inProgress[url];\n\t\tdelete inProgress[url];\n\t\tscript.parentNode && script.parentNode.removeChild(script);\n\t\tdoneFns && doneFns.forEach((fn) => (fn(event)));\n\t\tif(prev) return prev(event);\n\t}\n\tvar timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000);\n\tscript.onerror = onScriptComplete.bind(null, script.onerror);\n\tscript.onload = onScriptComplete.bind(null, script.onload);\n\tneedAttach && document.head.appendChild(script);\n};","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.nmd = (module) => {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","__webpack_require__.p = \"/\";","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t792: 0\n};\n\n__webpack_require__.f.j = (chunkId, promises) => {\n\t\t// JSONP chunk loading for javascript\n\t\tvar installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n\t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n\t\t\t// a Promise means \"currently loading\".\n\t\t\tif(installedChunkData) {\n\t\t\t\tpromises.push(installedChunkData[2]);\n\t\t\t} else {\n\t\t\t\tif(true) { // all chunks have JS\n\t\t\t\t\t// setup Promise in chunk cache\n\t\t\t\t\tvar promise = new Promise((resolve, reject) => (installedChunkData = installedChunks[chunkId] = [resolve, reject]));\n\t\t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n\t\t\t\t\t// start chunk loading\n\t\t\t\t\tvar url = __webpack_require__.p + __webpack_require__.u(chunkId);\n\t\t\t\t\t// create error before stack unwound to get useful stacktrace later\n\t\t\t\t\tvar error = new Error();\n\t\t\t\t\tvar loadingEnded = (event) => {\n\t\t\t\t\t\tif(__webpack_require__.o(installedChunks, chunkId)) {\n\t\t\t\t\t\t\tinstalledChunkData = installedChunks[chunkId];\n\t\t\t\t\t\t\tif(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n\t\t\t\t\t\t\tif(installedChunkData) {\n\t\t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n\t\t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n\t\t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n\t\t\t\t\t\t\t\terror.type = errorType;\n\t\t\t\t\t\t\t\terror.request = realSrc;\n\t\t\t\t\t\t\t\tinstalledChunkData[1](error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t__webpack_require__.l(url, loadingEnded, \"chunk-\" + chunkId, chunkId);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n};\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = (chunkId) => (installedChunks[chunkId] === 0);\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkfrontend\"] = self[\"webpackChunkfrontend\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [967,497,96], () => (__webpack_require__(8806)))\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["LoadingSpinner","_ref","message","_jsx","className","children","_jsxs","Loader2","LazyRichTextEditor","lazy","LazyTemplateManager","LazyLiteratureModal","withLazyLoading","LazyComponent","fallbackMessage","props","Suspense","fallback","TemplateManager","LiteratureModal","modalVariants","hidden","opacity","scale","y","rotate","visible","transition","type","damping","stiffness","duration","exit","backdropVariants","backdropFilter","ease","contentVariants","delay","CaseModal","isOpen","data","onClose","onAnimationStart","onAnimationEnd","setMindMapData","autoSaveMindMapData","addToast","isAnimating","setIsAnimating","useState","isVisible","setIsVisible","isClosing","setIsClosing","isEditing","setIsEditing","editData","setEditData","isLoading","setIsLoading","hasInitialized","setHasInitialized","activeTab","setActiveTab","isTabTransitioning","setIsTabTransitioning","expandedTimelineEntry","setExpandedTimelineEntry","timelineScrollRef","useRef","useEffect","setTimeout","id","timelineEntries","useMemo","date","time","title","summary","details","author","isNew","scrollToLatest","useCallback","current","scrollTop","scrollHeight","toggleTimelineEntry","entryId","prev","handleClose","handleSave","async","prevData","updatedCases","cases","map","caseItem","String","newData","error","console","handleDelete","window","confirm","filter","updateField","field","value","renderField","label","arguments","length","undefined","options","onChange","e","target","rows","placeholder","toLowerCase","choices","choice","Number","AnimatePresence","mode","onExitComplete","motion","div","initial","animate","variants","style","willChange","backfaceVisibility","transform","onClick","currentTarget","stopPropagation","onAnimationComplete","Users","size","_Fragment","Edit3","Trash2","X","key","icon","FileText","Clipboard","Heart","Clock","Sparkles","Target","_ref2","Icon","button","whileHover","whileTap","boxShadow","some","entry","layoutId","bounce","layout","layoutRoot","height","x","AlertCircle","ArrowDown","ref","scrollbarWidth","scrollbarColor","index","Brain","Calendar","span","repeat","Infinity","ChevronDown","disabled","Save","React","prevProps","nextProps","_prevProps$data","_nextProps$data","_prevProps$data2","_nextProps$data2","updated_at","TopicModal","newResource","setNewResource","showResourceForm","setShowResourceForm","resources","flashcard_count","completed_flashcards","progressPercentage","total","completed","Math","round","updatedTopics","topics","topic","addResource","trim","updatedResources","removeResource","_","i","BookOpen","TrendingUp","Lightbulb","Link2","width","Check","max","Award","Plus","onKeyPress","resource","Layers","TaskModal","_priorityConfig$editD","status","priority","priorityConfig","low","color","Flag","medium","high","urgent","AlertTriangle","statusConfig","pending","in_progress","Play","CheckSquare","paused","Pause","isOverdue","due_date","Date","updatedTasks","tasks","task","handleStatusChange","newStatus","toLocaleDateString","Object","entries","_ref3","config","isActive","created_at","toLocaleString","getIntersectionPoint","rect","center","point","rectX","rectY","centerX","centerY","pointX","pointY","left","right","top","bottom","dx","dy","abs","side","slope","yIntercept","intersections","leftY","push","distance","hypot","rightY","topX","bottomX","validIntersections","intersection","intersectionDx","intersectionDy","sort","a","b","FloatingEdge","memo","_sourceNode","_targetNode","_sourceNode2","_sourceNode3","_targetNode2","_targetNode3","source","sourceX","sourceY","targetX","targetY","sourcePosition","targetPosition","markerEnd","markerStart","getNode","useReactFlow","sourceNode","targetNode","edgePath","labelX","labelY","__isAnimating","__forceUpdate","_sourceNode$dimension","_sourceNode$data","_sourceNode$style","_targetNode$dimension","_targetNode$data","_targetNode$style","_sourceNode$positionA","_sourceNode$positionA2","_targetNode$positionA","_targetNode$positionA2","sourceHasDimensions","Boolean","dimensions","targetHasDimensions","getNodeDimensions","node","_node$dimensions","_node$data","_node$dimensions2","_node$data2","defaultWidth","defaultHeight","sourceDims","targetDims","floatingEdgeData","sourceWidth","sourceHeight","targetWidth","targetHeight","offset","sourceSide","targetSide","sourceCenter","targetCenter","sourceRect","targetRect","sourceIntersection","targetIntersection","sqrt","unitX","unitY","extensionAmount","debug","log","getFloatingEdgePath","positionAbsolute","position","sx","sy","tx","ty","warn","BaseEdge","path","stroke","strokeWidth","strokeLinecap","strokeOpacity","EnhancedEdge","sourceHandleId","targetHandleId","selected","animated","getBezierPath","EdgeLabelRenderer","fontSize","pointerEvents","displayName","fromX","fromY","toX","toY","connectionLineStyle","strokeDasharray","animation","d","fill","progress","min","sampleLiteratureData","authors","year","journal","volume","pages","doi","abstract","keywords","notes","pdf_url","sampleConnections","populateSampleLiteratureData","existingIds","Set","literature","item","newLiterature","has","existingCaseIds","existingTopicIds","newCases","primary_diagnosis","chief_complaint","secondary_diagnoses","newTopics","category","tags","existingConnectionIds","connections","conn","newConnections","updatedData","loadD3Force","API","process","replace","originalError","_len2","args","Array","_key2","includes","Toast","timer","clearTimeout","success","info","saving","getIcon","CheckCircle2","Info","LoadingButton","loading","STORAGE_KEY","localStorageUtils","save","timeoutId","onSaveStart","onSaveComplete","storageData","version","timestamp","toISOString","localStorage","setItem","JSON","stringify","name","removeItem","clearError","load","stored","getItem","parse","clear","getStorageInfo","Blob","nodeTypes","skipAnimation","completionPercentage","backgroundColor","Handle","Position","Top","zIndex","isConnectable","Right","Bottom","Left","Tag","onDelete","slice","tag","case","_ref4","urgency","_data$chief_complaint","_data$diagnosis","complaint","diagnosis","keyword","getUrgencyLevel","linked_topics","age","getStatusColor","tasks_count","completed_tasks","_ref5","_ref6","onLiteratureClick","NodeSelector","_ref9","onSelect","templates","selectedNodeType","setSelectedNodeType","description","handleFinalSelect","filteredTemplates","t","nodeType","ArrowLeft","minHeight","_ref0","template","_template$data","_template$data2","_template$data3","assessment_plan","EdgeLabelModal","_ref1","edge","onSave","setLabel","autoFocus","DashboardComponent","_caseModal$data2","_topicModal$data2","_taskModal$data2","_caseModal$data3","_topicModal$data3","_taskModal$data3","fitView","setCenter","zoomTo","getViewport","nodes","setNodes","onNodesChange","useNodesState","edges","setEdges","onEdgesChange","useEdgesState","mindMapData","selectedNode","setSelectedNode","setLoading","loadingProgress","setLoadingProgress","loadingMessage","setLoadingMessage","isInitialLoad","setIsInitialLoad","focusedCategory","setFocusedCategory","showNodeSelector","setShowNodeSelector","caseModal","setCaseModal","topicModal","setTopicModal","taskModal","setTaskModal","caseModalStableData","topicModalStableData","taskModalStableData","isReactFlowReady","setIsReactFlowReady","hasAppliedInitialLayout","setHasAppliedInitialLayout","isExportingCSV","setIsExportingCSV","lastSaved","setLastSaved","isSaving","setIsSaving","edgeModal","setEdgeModal","setTemplates","exportProgress","setExportProgress","show","toasts","setToasts","searchQuery","setSearchQuery","searchResultsCount","setSearchResultsCount","isTemplateManagerOpen","setIsTemplateManagerOpen","literatureModal","setLiteratureModal","modalAnimationStates","setModalAnimationStates","nodeVisibility","setNodeVisibility","visibilityRef","keys","newToast","now","removeToast","toast","_caseModal$data","_topicModal$data","_taskModal$data","anyModalOpen","anyModalAnimating","values","state","anyModalTransitioning","requestIdleCallback","saveToBackend","timeout","positionBackendSaveTimeout","handleDeleteNode","fullNodeId","idParts","split","nodeId","join","collectionKey","updatedCollection","updatedConnections","charAt","toUpperCase","nds","eds","handleLiteratureClick","literatureData","syncNodeTitles","currentNodes","newLabel","_mindMapData$cases","caseData","find","c","primaryDiagnosis","_mindMapData$topics","topicData","_mindMapData$tasks","taskData","_mindMapData$literatu","l","_mindMapData$cases2","_mindMapData$topics2","_mindMapData$tasks2","_mindMapData$literatu2","convertDataToReactFlow","applyLayoutImmediately","allItems","layoutNodes","hasExistingPositions","forceSimulation","forceManyBody","forceLink","forceCenter","forceCollide","simulationNodes","_item$position","_item$position2","random","d3Edges","nodeIds","n","simulation","force","strength","distanceMax","innerWidth","innerHeight","radius","stop","tick","positionMap","Map","forEach","set","get","quickNodes","nodeData","chiefComplaint","initialPresentation","initial_presentation","currentPresentation","current_presentation","medicationHistory","medication_history","therapyProgress","therapy_progress","defensePatterns","defense_patterns","clinicalReflection","clinical_reflection","gridSize","ceil","nodeSpacing","offsetY","floor","optimizedEdges","createOptimizedEdges","nodeIdSet","updatable","cleanData","_topic$position","_topic$position2","isArray","_caseItem$position","_caseItem$position2","case_id","encounter_date","gender","history_present_illness","medical_history","medications","mental_status_exam","_task$position","_task$position2","linked_case_id","linked_topic_id","lit","_lit$position","_lit$position2","publication","pdf_path","response","axios","put","headers","err","_err$response","_err$response2","_err$response3","_err$response3$data","detail","onConnect","params","edgeId","newEdge","interactionWidth","addEdge","onNodeClick","event","onNodeDoubleClick","dataItem","onEdgeDoubleClick","onEdgeContextMenu","preventDefault","handleSaveEdgeLabel","onEdgeMouseEnter","onEdgeMouseLeave","forceLayout","currentEdges","validEdges","fx","fy","ticksPerFrame","totalTicks","currentTick","runSimulationChunk","remainingTicks","requestAnimationFrame","updatedNodes","simNode","currentData","_updatedData$key","padding","applyForceLayout","handleClearMap","empty","handleNodesChange","changes","removedNodes","change","prevVisibility","newVisibility","positionChanges","_updatedData$key2","handleNodeDragStop","dragSaveTimeout","loadMindMapData","local","backendError","nodeMatchesSearch","query","searchTerm","parts","hasMatch","clearSearch","resetVisibility","handleKeyDown","_document$querySelect","tagName","ctrlKey","metaKey","document","querySelector","focus","addEventListener","removeEventListener","visibleCount","shouldShow","startsWith","styleSheet","getElementById","createElement","head","appendChild","textContent","currentVisibility","currentSelectedId","prevNodes","isSelected","updateVisibility","currentNodeIds","hasNewNodes","hasRemovedNodes","from","initialVisibility","OptimizedLoadingScreen","Search","onKeyDown","term","CheckCircle","toLocaleTimeString","Cloud","Shuffle","Bookmark","Eye","ReactFlowErrorBoundary","ReactFlow","onNodeDragStop","edgeTypes","floating","enhanced","nodesDraggable","nodesConnectable","elementsSelectable","onInit","reactFlowInstance","onError","snapToGrid","snapGrid","elevateEdgesOnSelect","connectionLineComponent","ConnectionLine","defaultEdgeOptions","Background","gap","Controls","MiniMap","allNodes","templateId","_mindMapData$topics3","_mindMapData$cases3","_mindMapData$tasks3","_mindMapData$literatu3","dataId","currentDataCount","gridPosition","newNode","dataToAdd","concat","constructor","super","this","hasError","getDerivedStateFromError","componentDidCatch","errorInfo","render","location","reload","Dashboard","ReactFlowProvider","ReactDOM","App","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","loaded","__webpack_modules__","m","deferred","O","result","chunkIds","fn","notFulfilled","fulfilled","j","every","splice","r","leafPrototypes","getProto","getPrototypeOf","obj","__esModule","then","ns","create","def","indexOf","getOwnPropertyNames","definition","o","defineProperty","enumerable","f","chunkId","Promise","all","reduce","promises","u","miniCssF","g","globalThis","Function","prop","prototype","hasOwnProperty","call","inProgress","dataWebpackPrefix","url","done","script","needAttach","scripts","getElementsByTagName","s","getAttribute","charset","nc","setAttribute","src","onScriptComplete","onerror","onload","doneFns","parentNode","removeChild","bind","Symbol","toStringTag","nmd","paths","p","installedChunks","installedChunkData","promise","resolve","reject","Error","errorType","realSrc","request","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","chunkLoadingGlobal","self","__webpack_exports__"],"sourceRoot":""}